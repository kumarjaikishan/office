import{h as je,i as ve,r as c,k as be,l as es,m as ss,j as e,n as X,o as ue,p as we,q as ae,t as de,b as me,v as De,y as Q,G as Me,w as ts,x as Te,z as $e,g as ye,B as Fe,D as Be,E as as,H as ns,M as rs,I as is,J as os,u as ls,f as ds,a as cs,K as We,T as us,A as Ge,L as ms,C as qe,O as xs,P as ps,Q as Ue,R as _e}from"./index-Yr5TVBX8.js";import{I as Le}from"./index-BtacAYSp.js";import{M as Se}from"./Modalbox-DFzdZFVl.js";import{X as hs}from"./index.es-BNEnLlPq.js";import{I as gs,a as fs}from"./index-C1JdotOL.js";import{H as js}from"./index-BHdDmil-.js";import{B as vs,P as bs,L as ws}from"./index-BtZemEXp.js";import{A as Ns}from"./index-DPLLIyaO.js";import{u as Cs}from"./imageresizer-D4I-KFLq.js";import{C as Ae}from"./CheckPermission-DEijDNSt.js";import{u as ys}from"./attandencehelper-Dy0nLLzv.js";import{B as J}from"./Box-CAslWZV8.js";import{T as ce}from"./Typography-wzkP9v2k.js";import{T as N}from"./TextField-BZQlsKpZ.js";import{I as Ee}from"./InputAdornment-XZdrXKpE.js";import{T as Ss,g as Oe,u as As,P as Es,F as re,I as ie,S as oe,O as He}from"./Select-BzO5C_ZD.js";import{M as G}from"./MenuItem-DUYgeWuo.js";import{B as ee}from"./Button-DbYv_FMR.js";import{u as Is}from"./useSlotProps-BKaa53Ma.js";import{u as Ds,B as Ps}from"./ButtonBase-BPEedJVC.js";import"./createSimplePaletteValueFilter-B57QjJRu.js";function zs(a){return je("MuiCollapse",a)}ve("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Rs=a=>{const{orientation:i,classes:l}=a,t={root:["root",`${i}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${i}`],wrapperInner:["wrapperInner",`${i}`]};return we(t,zs,l)},ks=X("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(a,i)=>{const{ownerState:l}=a;return[i.root,i[l.orientation],l.state==="entered"&&i.entered,l.state==="exited"&&!l.in&&l.collapsedSize==="0px"&&i.hidden]}})(ae(({theme:a})=>({height:0,overflow:"hidden",transition:a.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:a.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:i})=>i.state==="exited"&&!i.in&&i.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Ms=X("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ts=X("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ie=c.forwardRef(function(i,l){const t=be({props:i,name:"MuiCollapse"}),{addEndListener:u,children:x,className:g,collapsedSize:f="0px",component:m,easing:W,in:M,onEnter:P,onEntered:y,onEntering:T,onExit:b,onExited:z,onExiting:j,orientation:v="vertical",style:$,timeout:S=es.standard,TransitionComponent:q=Ss,...H}=t,E={...t,orientation:v,collapsedSize:f},w=Rs(E),A=Is(),ne=Ds(),h=c.useRef(null),R=c.useRef(),p=typeof f=="number"?`${f}px`:f,U=v==="horizontal",_=U?"width":"height",K=c.useRef(null),Y=ss(l,K),o=d=>F=>{if(d){const B=K.current;F===void 0?d(B):d(B,F)}},I=()=>h.current?h.current[U?"clientWidth":"clientHeight"]:0,Z=o((d,F)=>{h.current&&U&&(h.current.style.position="absolute"),d.style[_]=p,P&&P(d,F)}),xe=o((d,F)=>{const B=I();h.current&&U&&(h.current.style.position="");const{duration:se,easing:V}=Oe({style:$,timeout:S,easing:W},{mode:"enter"});if(S==="auto"){const ge=A.transitions.getAutoHeightDuration(B);d.style.transitionDuration=`${ge}ms`,R.current=ge}else d.style.transitionDuration=typeof se=="string"?se:`${se}ms`;d.style[_]=`${B}px`,d.style.transitionTimingFunction=V,T&&T(d,F)}),pe=o((d,F)=>{d.style[_]="auto",y&&y(d,F)}),Ne=o(d=>{d.style[_]=`${I()}px`,b&&b(d)}),he=o(z),Ce=o(d=>{const F=I(),{duration:B,easing:se}=Oe({style:$,timeout:S,easing:W},{mode:"exit"});if(S==="auto"){const V=A.transitions.getAutoHeightDuration(F);d.style.transitionDuration=`${V}ms`,R.current=V}else d.style.transitionDuration=typeof B=="string"?B:`${B}ms`;d.style[_]=p,d.style.transitionTimingFunction=se,j&&j(d)}),C=d=>{S==="auto"&&ne.start(R.current||0,d),u&&u(K.current,d)};return e.jsx(q,{in:M,onEnter:Z,onEntered:pe,onEntering:xe,onExit:Ne,onExited:he,onExiting:Ce,addEndListener:C,nodeRef:K,timeout:S==="auto"?null:S,...H,children:(d,{ownerState:F,...B})=>e.jsx(ks,{as:m,className:ue(w.root,g,{entered:w.entered,exited:!M&&p==="0px"&&w.hidden}[d]),style:{[U?"minWidth":"minHeight"]:p,...$},ref:Y,ownerState:{...E,state:d},...B,children:e.jsx(Ms,{ownerState:{...E,state:d},className:w.wrapper,ref:h,children:e.jsx(Ts,{ownerState:{...E,state:d},className:w.wrapperInner,children:x})})})})});Ie&&(Ie.muiSupportAuto=!0);const Qe=c.createContext({});function $s(a){return je("MuiAccordion",a)}const fe=ve("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Fs=a=>{const{classes:i,square:l,expanded:t,disabled:u,disableGutters:x}=a;return we({root:["root",!l&&"rounded",t&&"expanded",u&&"disabled",!x&&"gutters"],heading:["heading"],region:["region"]},$s,i)},Bs=X(Es,{name:"MuiAccordion",slot:"Root",overridesResolver:(a,i)=>{const{ownerState:l}=a;return[{[`& .${fe.region}`]:i.region},i.root,!l.square&&i.rounded,!l.disableGutters&&i.gutters]}})(ae(({theme:a})=>{const i={duration:a.transitions.duration.shortest};return{position:"relative",transition:a.transitions.create(["margin"],i),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(a.vars||a).palette.divider,transition:a.transitions.create(["opacity","background-color"],i)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${fe.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${fe.disabled}`]:{backgroundColor:(a.vars||a).palette.action.disabledBackground}}}),ae(({theme:a})=>({variants:[{props:i=>!i.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(a.vars||a).shape.borderRadius,borderBottomRightRadius:(a.vars||a).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:i=>!i.disableGutters,style:{[`&.${fe.expanded}`]:{margin:"16px 0"}}}]}))),Ws=X("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),Ye=c.forwardRef(function(i,l){const t=be({props:i,name:"MuiAccordion"}),{children:u,className:x,defaultExpanded:g=!1,disabled:f=!1,disableGutters:m=!1,expanded:W,onChange:M,square:P=!1,slots:y={},slotProps:T={},TransitionComponent:b,TransitionProps:z,...j}=t,[v,$]=As({controlled:W,default:g,name:"Accordion",state:"expanded"}),S=c.useCallback(I=>{$(!v),M&&M(I,!v)},[v,M,$]),[q,...H]=c.Children.toArray(u),E=c.useMemo(()=>({expanded:v,disabled:f,disableGutters:m,toggle:S}),[v,f,m,S]),w={...t,square:P,disabled:f,disableGutters:m,expanded:v},A=Fs(w),ne={transition:b,...y},h={transition:z,...T},R={slots:ne,slotProps:h},[p,U]=de("root",{elementType:Bs,externalForwardedProps:{...R,...j},className:ue(A.root,x),shouldForwardComponentProp:!0,ownerState:w,ref:l,additionalProps:{square:P}}),[_,K]=de("heading",{elementType:Ws,externalForwardedProps:R,className:A.heading,ownerState:w}),[Y,o]=de("transition",{elementType:Ie,externalForwardedProps:R,ownerState:w});return e.jsxs(p,{...U,children:[e.jsx(_,{...K,children:e.jsx(Qe.Provider,{value:E,children:q})}),e.jsx(Y,{in:v,timeout:"auto",...o,children:e.jsx("div",{"aria-labelledby":q.props.id,id:q.props["aria-controls"],role:"region",className:A.region,children:H})})]})});function Gs(a){return je("MuiAccordionDetails",a)}ve("MuiAccordionDetails",["root"]);const qs=a=>{const{classes:i}=a;return we({root:["root"]},Gs,i)},Us=X("div",{name:"MuiAccordionDetails",slot:"Root"})(ae(({theme:a})=>({padding:a.spacing(1,2,2)}))),Ve=c.forwardRef(function(i,l){const t=be({props:i,name:"MuiAccordionDetails"}),{className:u,...x}=t,g=t,f=qs(g);return e.jsx(Us,{className:ue(f.root,u),ref:l,ownerState:g,...x})});function _s(a){return je("MuiAccordionSummary",a)}const le=ve("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Ls=a=>{const{classes:i,expanded:l,disabled:t,disableGutters:u}=a;return we({root:["root",l&&"expanded",t&&"disabled",!u&&"gutters"],focusVisible:["focusVisible"],content:["content",l&&"expanded",!u&&"contentGutters"],expandIconWrapper:["expandIconWrapper",l&&"expanded"]},_s,i)},Os=X(Ps,{name:"MuiAccordionSummary",slot:"Root"})(ae(({theme:a})=>{const i={duration:a.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:a.spacing(0,2),transition:a.transitions.create(["min-height","background-color"],i),[`&.${le.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${le.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`&:hover:not(.${le.disabled})`]:{cursor:"pointer"},variants:[{props:l=>!l.disableGutters,style:{[`&.${le.expanded}`]:{minHeight:64}}}]}})),Hs=X("span",{name:"MuiAccordionSummary",slot:"Content"})(ae(({theme:a})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:i=>!i.disableGutters,style:{transition:a.transitions.create(["margin"],{duration:a.transitions.duration.shortest}),[`&.${le.expanded}`]:{margin:"20px 0"}}}]}))),Ys=X("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(ae(({theme:a})=>({display:"flex",color:(a.vars||a).palette.action.active,transform:"rotate(0deg)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shortest}),[`&.${le.expanded}`]:{transform:"rotate(180deg)"}}))),Je=c.forwardRef(function(i,l){const t=be({props:i,name:"MuiAccordionSummary"}),{children:u,className:x,expandIcon:g,focusVisibleClassName:f,onClick:m,slots:W,slotProps:M,...P}=t,{disabled:y=!1,disableGutters:T,expanded:b,toggle:z}=c.useContext(Qe),j=h=>{z&&z(h),m&&m(h)},v={...t,expanded:b,disabled:y,disableGutters:T},$=Ls(v),S={slots:W,slotProps:M},[q,H]=de("root",{ref:l,shouldForwardComponentProp:!0,className:ue($.root,x),elementType:Os,externalForwardedProps:{...S,...P},ownerState:v,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:y,"aria-expanded":b,focusVisibleClassName:ue($.focusVisible,f)},getSlotProps:h=>({...h,onClick:R=>{var p;(p=h.onClick)==null||p.call(h,R),j(R)}})}),[E,w]=de("content",{className:$.content,elementType:Hs,externalForwardedProps:S,ownerState:v}),[A,ne]=de("expandIconWrapper",{className:$.expandIconWrapper,elementType:Ys,externalForwardedProps:S,ownerState:v});return e.jsxs(q,{...H,children:[e.jsx(E,{...w,children:u}),g&&e.jsx(A,{...ne,children:g})]})}),Vs=[{name:"S.no",selector:a=>a.sno,width:"40px"},{name:"Name",selector:a=>a.name},{name:"Email",selector:a=>a.email},{name:"Department",selector:a=>a.department},{name:"Action",selector:a=>a.action,width:"160px"}],Js=async({formData:a,dispatch:i,setisload:l,setInp:t,setopenmodal:u,init:x,resetPhoto:g})=>{const f=localStorage.getItem("emstoken");l(!0);try{const m=await me.post("/api/addemployee",a,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"multipart/form-data"}});Q.success(m.data.message,{autoClose:1200}),t(x),g(),u(!1),i(De())}catch(m){console.log(m),m.response?Q.warn(m.response.data.message,{autoClose:1200}):console.error("Error:",m.message)}finally{l(!1)}},Qs=async({formData:a,dispatch:i,setEmployeePhoto:l,setisload:t,setInp:u,setopenmodal:x,init:g})=>{const f=localStorage.getItem("emstoken");t(!0);try{const m=await me.post("/api/updateemployee",a,{headers:{Authorization:`Bearer ${f}`}});Q.success(m.data.message,{autoClose:1200}),l(null),u(g),x(!1),i(De())}catch(m){console.log(m),m.response?Q.warn(m.response.data.message,{autoClose:1200}):m.request?console.error("No response from server:",m.request):console.error("Error:",m.message)}finally{t(!1)}},Xs=async({employeeId:a,setisload:i,dispatch:l})=>{if(!a){alert("All fileds are Required");return}const t=localStorage.getItem("emstoken");i(!0);try{const u=await me.post("/api/deleteemployee",{employeeId:a},{headers:{Authorization:`Bearer ${t}`}});l(De()),Q.success(u.data.message,{autoClose:1200})}catch(u){console.log(u),u.response?Q.warn(u.response.data.message,{autoClose:1200}):u.request?console.error("No response from server:",u.request):console.error("Error:",u.message)}finally{i(!1)}},Ks=({viewEmployee:a})=>{var f,m,W,M,P,y,T;const[i,l]=c.useState(!1),[t,u]=c.useState(null),[x,g]=c.useState(1);return c.useEffect(()=>{(async()=>{const z=localStorage.getItem("emstoken");l(!0);try{const j=await me.get(`/api/getemployee?empid=${a}`,{headers:{Authorization:`Bearer ${z}`}});u(j.data)}catch(j){console.log(j),j.response?Q.warn(j.response.data.message,{autoClose:1200}):j.request?console.error("No response from server:",j.request):console.error("Error:",j.message)}finally{l(!1)}})()},[]),e.jsx(e.Fragment,{children:i?e.jsxs("div",{className:"w-full h-[300px] flex gap-5 flex-col justify-center items-center bg-white",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"animate-spin",style:{animationDuration:"2.5s"},size:50,color:"teal"}),e.jsx(Me,{className:"absolute -bottom-4 left-0 animate-spin",style:{animationDuration:"3s"},size:20,color:"teal"})]}),e.jsx("p",{className:"text-teal-600",children:"loading..."})]}):e.jsxs("div",{className:"max-w-3xl mx-auto bg-white flex flex-col shadow rounded-lg p-2 md:p-4 ",children:[e.jsx("h2",{className:"text-xl mx-auto font-semibold text-gray-700 mb-4",children:"Employee Details"}),e.jsxs("div",{className:"flex gap-4  pb-2 md:items-start",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full border-2 border-teal-500 border-dashed p-[2px] flex items-center justify-center overflow-hidden",children:t!=null&&t.profileimage?e.jsx("img",{src:t.profileimage,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):e.jsx(ts,{className:"text-3xl text-gray-500"})}),e.jsxs("div",{className:"md:flex-1 w-auto",children:[e.jsx("h3",{className:"text-l md:text-xl capitalize font-bold text-gray-800",children:(f=t==null?void 0:t.userid)==null?void 0:f.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(m=t==null?void 0:t.userid)==null?void 0:m.role}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded",children:t==null?void 0:t.department.department}),e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded",children:"active"})]}),e.jsxs("div",{className:"hidden md:flex mt-3 justify-start flex-wrap text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500 lowercase"})," ",(W=t==null?void 0:t.userid)==null?void 0:W.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Fe,{className:"text-gray-500"})," ",ye((M=t==null?void 0:t.userid)==null?void 0:M.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Be,{className:"text-gray-500"})," ID: emp0002"]})]})]})]}),e.jsxs("div",{className:"md:hidden mt-3 justify-start flex flex-wrap text-[12px] md:text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500 lowercase"})," ",(P=t==null?void 0:t.userid)==null?void 0:P.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Fe,{className:"text-gray-500"})," ",ye((y=t==null?void 0:t.userid)==null?void 0:y.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Be,{className:"text-gray-500"})," ID: emp0002"]})]}),e.jsxs("div",{className:"pt-1 capitalize",children:[e.jsxs("div",{className:"flex gap-2 md:gap-6 bg-slate-200 p-1 mt-2 text-[12px] md:text-sm font-medium text-gray-700",children:[e.jsx("div",{onClick:()=>g(1),className:`${x==1?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Personal Info"}),e.jsx("div",{onClick:()=>g(2),className:`${x==2?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Employment"}),e.jsx("div",{onClick:()=>g(3),className:`${x==3?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Documents & Skills"})]}),x==1&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(as,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Date of Birth"}),e.jsx("div",{children:t!=null&&t.dob?ye(t==null?void 0:t.dob).format("DD MMM,YYYY"):"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ns,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Address"}),e.jsx("div",{children:(t==null?void 0:t.address)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(rs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Emergency Contact"}),e.jsx("div",{children:(t==null?void 0:t.Emergencyphone)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(vs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Blood Group"}),e.jsx("div",{children:(t==null?void 0:t.bloodGroup)||"N/A"})]})]})]}),x==2&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(bs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Position"}),e.jsx("div",{children:(t==null?void 0:t.designation)||"Accounts"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Department"}),e.jsx("div",{children:((T=t==null?void 0:t.department)==null?void 0:T.department)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(os,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Salary"}),e.jsx("div",{children:(t==null?void 0:t.salary)||"N/A"})]})]})]}),x==3&&e.jsxs("div",{className:"mt-2 p-2 grid grid-cols-1 max-h-[300px] overflow-y-auto sm:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Education"}),t.education.length>0?t.education.map(b=>e.jsxs("div",{className:"relative my-1 pl-2 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:b.degree}),e.jsx("p",{className:"text-gray-700",children:b.institution}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:b.date}),e.jsx("span",{className:"absolute w-0.5 h-full bg-amber-800 top-0 left-0"})]})):e.jsx("div",{children:"No Data found"})]}),e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Achievement"}),t.achievements.length>0?t.achievements.map(b=>e.jsxs("div",{className:"relative my-1 pl-5 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:b.title}),e.jsx("p",{className:"text-gray-700",children:b.description}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:b.date}),e.jsxs("span",{className:"absolute top-1 -left-0",children:[" ",e.jsx(ws,{size:18,color:"orange"})," "]}),e.jsx("span",{className:"absolute w-0.5 h-full bg-blue-500 top-0 right-0"})]})):e.jsx("div",{children:"No Achievement found"})]})]})]})]})})},bt=()=>{var Re,ke;const[a,i]=c.useState(!1),[l,t]=c.useState(!1),[u,x]=c.useState([]),[g,f]=c.useState([]),[m,W]=c.useState(!1),[M,P]=c.useState(!1),[y,T]=c.useState(!1),[b,z]=c.useState(null),[j,v]=c.useState(null),[$,S]=c.useState(null),{handleImage:q}=Cs(),H=ls(),{department:E,branch:w,employee:A,profile:ne}=ds(s=>s.user),[h,R]=c.useState({userid:"",pass:""}),[p,U]=c.useState({searchText:"",branch:"all",department:"all"}),_="https://res.cloudinary.com/dusxlxlvm/image/upload/v1753113610/ems/assets/employee_fi3g5p.webp";c.useEffect(()=>{U(s=>({...s,department:"all"}))},[p.branch]);let K=cs();const Y={employeeId:"",branchId:"",department:"",employeeName:"",email:"",username:"",designation:"",password:"",phone:"",address:"",gender:"male",bloodGroup:"",dob:"",Emergencyphone:"",skills:[],maritalStatus:!0,salary:0,achievements:[],education:[]},[o,I]=c.useState(Y);c.useEffect(()=>{E.length>0&&f(E.filter(s=>{var r;return((r=s==null?void 0:s.branchId)==null?void 0:r._id)==p.branch}))},[p.branch]);const Z=(s,r,n,k)=>{const D=[...o[r]];D[n][k]=s.target.value,I(L=>({...L,[r]:D}))},xe=s=>{const r=s==="achievements"?{title:"",description:"",date:""}:{degree:"",institution:"",date:""};I(n=>({...n,[s]:[...n[s],r]}))},pe=(s,r)=>{const n=o[s].filter((k,D)=>D!==r);I(k=>({...k,[s]:n}))},Ne=Ae("employee",2),he=Ae("employee",3),Ce=Ae("employee",4);c.useEffect(()=>{if((A==null?void 0:A.length)<1)return;let s=1;const r=A==null?void 0:A.map(n=>{var k,D,L,O,te;return{id:n._id,sno:s++,rawname:(k=n==null?void 0:n.userid)==null?void 0:k.name,name:e.jsxs("div",{className:"flex items-center capitalize gap-3 ",children:[e.jsx(Ge,{src:n.profileimage||_,alt:n.employeename,children:!n.profileimage&&_}),e.jsxs(J,{children:[e.jsx(ce,{variant:"body2",children:(D=n==null?void 0:n.userid)==null?void 0:D.name}),e.jsxs("p",{className:"t text-[10px] text-gray-600",children:["(",n==null?void 0:n.designation,")"]})]})]}),email:(L=n==null?void 0:n.userid)==null?void 0:L.email,branch:n==null?void 0:n.branchId,department:(O=n==null?void 0:n.department)==null?void 0:O.department,departmentid:(te=n==null?void 0:n.department)==null?void 0:te._id,action:e.jsxs("div",{className:"action flex gap-2.5",children:[e.jsx("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"View Profile",onClick:()=>{S(n._id),W(!0)},children:e.jsx(gs,{})}),e.jsx("span",{className:"eye edit text-[18px] text-amber-500 cursor-pointer",title:"Attandence Report",onClick:()=>K(`/dashboard/performance/${n.userid._id}`),children:e.jsx(js,{})}),he&&e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>Xe(n),children:e.jsx(We,{})}),he&&e.jsxs("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"Reset Password",onClick:()=>{R({...h,userid:n.userid._id}),P(!0)},children:[e.jsx(us,{})," "]}),Ce&&e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>Ke(n._id),children:e.jsx(Ns,{})})]})}});x(r)},[A]);const C=(s,r)=>{I({...o,[r]:s.target.value})},d=(s,r)=>{U(n=>({...n,[s]:r}))},F=s=>{const r=s.target.files[0];if(v(r),r){const n=new FileReader;n.onloadend=()=>{z(n.result)},n.readAsDataURL(r)}else z(null)},B=async s=>{s.preventDefault();const r=new FormData;if(r.append("employeeName",o.employeeName),r.append("branchId",o.branchId),r.append("department",o.department),r.append("username",o.username),r.append("email",o.email),r.append("password",o.password),r.append("designation",o.designation),r.append("salary",o.salary),j){let n=await q(300,j);r.append("photo",n)}await Js({formData:r,dispatch:H,setisload:t,setInp:I,setopenmodal:i,init:Y,resetPhoto:V})},se=async()=>{const s=new FormData;if(Object.keys(o).forEach(r=>{const n=o[r];Array.isArray(n)||typeof n=="object"?s.append(r,JSON.stringify(n)):s.append(r,n)}),j){let r=await q(300,j);s.append("photo",r)}await Qs({formData:s,dispatch:H,setisload:t,setEmployeePhoto:v,setInp:I,setopenmodal:i,init:Y,resetPhoto:V}),z(null),v(null)},V=()=>{z(null),v(null)},ge=async s=>{s.preventDefault();try{const r=localStorage.getItem("emstoken"),n=await me.post("/api/updatepassword",{pass:h},{headers:{Authorization:`Bearer ${r}`}});R({userid:"",pass:""}),P(!1),console.log("Query:",n),Q.success(n.data.message,{autoClose:1200})}catch(r){console.log(r),r.response?Q.warn(r.response.data.message,{autoClose:1200}):r.request?console.error("No response from server:",r.request):console.error("Error:",r.message)}},Xe=s=>{var r,n,k,D;T(!0),I({employeeId:s._id,branchId:s==null?void 0:s.branchId,department:(r=s==null?void 0:s.department)==null?void 0:r._id,employeeName:(n=s==null?void 0:s.userid)==null?void 0:n.name,email:(k=s==null?void 0:s.userid)==null?void 0:k.email,username:(D=s==null?void 0:s.userid)==null?void 0:D.name,dob:s==null?void 0:s.dob,salary:s==null?void 0:s.salary,designation:s==null?void 0:s.designation,phone:s==null?void 0:s.phone,address:(s==null?void 0:s.address)||"",gender:(s==null?void 0:s.gender)||"male",bloodGroup:s==null?void 0:s.bloodGroup,Emergencyphone:s==null?void 0:s.Emergencyphone,skills:s==null?void 0:s.skills,maritalStatus:(s==null?void 0:s.maritalStatus)||!0,achievements:s==null?void 0:s.achievements,education:s==null?void 0:s.education}),s.profileimage&&z(s.profileimage),i(!0)},Ke=s=>{ms({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async r=>{r&&Xs({employeeId:s,setisload:t,dispatch:H})})},Pe=c.useRef(null),ze=u==null?void 0:u.filter(s=>{var te;const r=((te=s.rawname)==null?void 0:te.toLowerCase())||"",n=s.departmentid||"",k=s.branch||"",D=p.searchText.trim()===""||r.includes(p.searchText.toLowerCase()),L=p.department==="all"||n===p.department,O=p.branch==="all"||k===p.branch;return D&&L&&O}),Ze=()=>{const s=["S.No","Name","Email","Department"],r=ze.map((O,te)=>[te+1,O.rawname,O.email,O.department]),n=[s,...r].map(O=>O.join(",")).join(`
`),k=new Blob([n],{type:"text/csv"}),D=URL.createObjectURL(k),L=document.createElement("a");L.href=D,L.download="Employee List.csv",L.click(),URL.revokeObjectURL(D)};return e.jsxs("div",{className:"employee p-1",children:[e.jsxs("div",{className:"flex gap-5 justify-between items-center flex-wrap",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-1 w-full md:w-fit",children:[e.jsx(N,{size:"small",className:"md:col-span-1 md:max-w-[160px] col-span-2",value:p.searchText,onChange:s=>d("searchText",s.target.value),InputProps:{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(fs,{})})},label:"Search Employee"}),e.jsxs(re,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(ie,{children:"Branch"}),e.jsxs(oe,{label:"Branch",value:p.branch,input:e.jsx(He,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(qe,{fontSize:"small"})}),label:"Branch"}),onChange:s=>d("branch",s.target.value),children:[e.jsx(G,{value:"all",children:"All"}),w==null?void 0:w.map(s=>e.jsx(G,{value:s._id,children:s.name},s._id))]})]}),e.jsxs(re,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(ie,{children:"Department"}),e.jsxs(oe,{label:"Department",disabled:p.branch==="all",value:p.department,input:e.jsx(He,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(qe,{fontSize:"small"})}),label:"Department"}),onChange:s=>d("department",s.target.value),children:[e.jsx(G,{value:"all",children:"All"}),g.length>0?g.map(s=>e.jsx(G,{value:s._id,children:s.department},s._id)):e.jsx(G,{disabled:!0,children:"No departments found"})]})]})]}),e.jsxs("div",{className:"flex gap-1 w-full md:w-fit",children:[e.jsx(ee,{variant:"outlined",className:"flex-1 md:w-fit md:flex-none",onClick:Ze,startIcon:e.jsx(xs,{}),children:"Export"}),Ne&&e.jsx(ee,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:e.jsx(ps,{}),onClick:()=>i(!0),children:"Add Employee"})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(hs,{columns:Vs,data:ze,pagination:!0,customStyles:ys(),highlightOnHover:!0})}),e.jsx(Se,{open:a,onClose:()=>{i(!1),T(!1),I(Y),V()},children:e.jsx("div",{className:"membermodal",children:e.jsx("div",{className:"whole",children:e.jsxs("form",{onSubmit:B,children:[e.jsx("div",{className:"modalhead",children:y?"Update Employee":"Add Employee"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsxs(re,{fullWidth:!0,required:!0,size:"small",children:[e.jsx(ie,{children:"Branch"}),e.jsx(oe,{value:o.branchId,label:"branch",onChange:s=>C(s,"branchId"),children:w==null?void 0:w.map(s=>e.jsx(G,{value:s._id,children:s.name},s._id))})]}),e.jsxs(re,{disabled:!o.branchId,fullWidth:!0,required:!0,size:"small",children:[e.jsx(ie,{children:"Department"}),e.jsx(oe,{value:o.department,label:"Department",onChange:s=>C(s,"department"),children:(E==null?void 0:E.filter(s=>{var r;return((r=s.branchId)==null?void 0:r._id)===o.branchId}).length)>0?E.filter(s=>s.branchId._id===o.branchId).map(s=>e.jsx(G,{value:s._id,children:s.department},s._id)):e.jsx(G,{disabled:!0,children:"No departments found"})})]}),e.jsxs(J,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:o.employeeName,onChange:s=>C(s,"employeeName"),label:"Name",size:"small"}),e.jsx(N,{fullWidth:!0,required:!0,value:o.email,onChange:s=>C(s,"email"),label:"email",size:"small"})]}),e.jsxs(J,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:o.username,onChange:s=>C(s,"username"),label:"username",size:"small"}),e.jsx(N,{fullWidth:!0,disabled:y,value:o.password,onChange:s=>C(s,"password"),label:"password",size:"small"})]}),e.jsx(J,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,required:!0,value:o.designation,onChange:s=>C(s,"designation"),label:"Designation",size:"small"})}),e.jsx(J,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,value:o.salary,onChange:s=>C(s,"salary"),label:"salary",size:"small"})}),e.jsxs("div",{className:"mt-1 gap-2 flex items-center relative",children:[e.jsx("input",{style:{display:"none"},type:"file",onChange:F,ref:Pe,accept:"image/*",name:"",id:"fileInput"}),b?e.jsx("img",{src:b,alt:"Preview",className:"mt-2 w-[100px] h-[100px] rounded-full object-cover"}):e.jsx(Ge,{sx:{width:100,height:100},alt:o.employeeName,src:"/static/images/avatar/1.jpg"}),e.jsx("span",{onClick:()=>Pe.current.click(),className:"absolute -bottom-1 -right-1 rounded-full bg-teal-900 text-white p-1",children:e.jsx(We,{size:18})})]}),y&&e.jsxs(Ye,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Je,{expandIcon:e.jsx(Ue,{}),children:e.jsx(ce,{variant:"subtitle1",children:"Personal Details (optional)"})}),e.jsx(Ve,{children:e.jsxs(J,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsx(N,{fullWidth:!0,value:o.phone,onChange:s=>C(s,"phone"),label:"Phone",size:"small"}),e.jsx(N,{fullWidth:!0,value:o.Emergencyphone,onChange:s=>C(s,"Emergencyphone"),label:"Emergencyphone",size:"small"}),e.jsx(N,{fullWidth:!0,value:o.address,onChange:s=>C(s,"address"),label:"Address",size:"small"}),e.jsx(N,{fullWidth:!0,value:o.bloodGroup,onChange:s=>C(s,"bloodGroup"),label:"Blood Group",size:"small"}),e.jsx(N,{fullWidth:!0,value:o.dob,type:"date",onChange:s=>C(s,"dob"),label:"Date of Birth",size:"small"}),e.jsxs(re,{size:"small",children:[e.jsx(ie,{children:"maritalStatus"}),e.jsxs(oe,{label:"maritalStatus",value:o.maritalStatus,onChange:s=>C(s,"maritalStatus"),children:[e.jsx(G,{selected:!0,value:!0,children:"Married"}),e.jsx(G,{selected:!0,value:!1,children:"Unmarried"})]})]}),e.jsxs(re,{size:"small",children:[e.jsx(ie,{children:"Gender"}),e.jsxs(oe,{label:"Gender",value:o.gender,onChange:s=>C(s,"gender"),children:[e.jsx(G,{selected:!0,value:"male",children:"Male"}),e.jsx(G,{selected:!0,value:"female",children:"female"})]})]})]})})]}),y&&e.jsxs(Ye,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Je,{expandIcon:e.jsx(Ue,{}),children:e.jsx(ce,{variant:"subtitle1",children:"Document & Skills (optional)"})}),e.jsxs(Ve,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(J,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2}}),e.jsx(ce,{fontWeight:"bold",children:"Achievements"}),(Re=o==null?void 0:o.achievements)==null?void 0:Re.map((s,r)=>e.jsxs(J,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Title",size:"small",value:s.title,onChange:n=>Z(n,"achievements",r,"title")}),e.jsx(N,{label:"Description",size:"small",value:s.description,onChange:n=>Z(n,"achievements",r,"description")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:n=>Z(n,"achievements",r,"date")}),e.jsx(_e,{size:24,title:"Delete this",onClick:()=>pe("achievements",r)})]},r)),e.jsx(ee,{onClick:()=>xe("achievements"),variant:"outlined",children:"Add Achievement"}),e.jsx(ce,{fontWeight:"bold",children:"Education"}),(ke=o==null?void 0:o.education)==null?void 0:ke.map((s,r)=>e.jsxs(J,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Degree",size:"small",value:s.degree,onChange:n=>Z(n,"education",r,"degree")}),e.jsx(N,{label:"Institution",size:"small",value:s.institution,onChange:n=>Z(n,"education",r,"institution")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:n=>Z(n,"education",r,"date")}),e.jsx(_e,{size:24,title:"Delete this",onClick:()=>pe("education",r)})]},r)),e.jsx(ee,{onClick:()=>xe("education"),variant:"outlined",children:"Add Education"})]})]})]}),e.jsxs("div",{className:"modalfooter",children:[e.jsx(ee,{size:"small",onClick:()=>{i(!1),T(!1),I(Y),V()},variant:"outlined",children:"Cancel"}),y?e.jsx(ee,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(Le,{}),variant:"contained",onClick:se,children:"Update"}):e.jsx(ee,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(Le,{}),variant:"contained",type:"submit",children:"Add"})]})]})})})}),e.jsx(Se,{open:m,onClose:()=>{W(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsx(Ks,{viewEmployee:$})})}),e.jsx(Se,{open:M,onClose:()=>{P(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:ge,children:[e.jsx("h2",{children:"Reset Passowrd"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsx(N,{fullWidth:!0,required:!0,value:h.pass,onChange:s=>R({...h,pass:s.target.value}),label:"Passowrd",size:"small"}),e.jsx(ee,{variant:"contained",sx:{mr:2},type:"submit",children:"Reset Password"})]})]})})})]})};export{bt as default};
