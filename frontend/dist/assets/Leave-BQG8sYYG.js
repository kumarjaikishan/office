import{h as c,j as e,u as C,r,g as F,B as m,$ as Y,a0 as w,a1 as k,F as q,I as A,S as L,M as p,b as N,y as f,c as E,bE as R}from"./index-CPUqwxcV.js";import{u as $}from"./attandencehelper-dG5TxgUT.js";import{A as I}from"./AdapterDateFns-caoPCD8l.js";import{L as P}from"./dateViewRenderers-B5nFcVjP.js";import{D as b}from"./DatePicker-CuNYRblU.js";import"./index-B3Id5rY6.js";import"./index-BHwaJsVN.js";import"./useThemeProps-TYRm9UFN.js";import"./Popper-K0BOCoBe.js";const Q=()=>{const t={type:"",fromDate:null,toDate:null,reason:""},v=C(),[s,l]=r.useState(t),[y,D]=r.useState([]),{leave:d}=F(a=>a.employee),[M,o]=r.useState(!1),[h,x]=r.useState(!1),n=(a,u)=>{l({...s,[u]:a})};r.useEffect(()=>{d&&D(d)},[d]);const S=async a=>{var g,j;if(a.preventDefault(),!s.fromDate)return f.warn("From Date is required");const u=localStorage.getItem("emstoken");x(!0);try{const i=await E.post("/api/addleave",{...s},{headers:{Authorization:`Bearer ${u}`}});o(!1),v(R()),l(t),f.success(i.data.message,{autoClose:2e3})}catch(i){console.error(i),f.warning(((j=(g=i.response)==null?void 0:g.data)==null?void 0:j.message)||"Error",{autoClose:2e3})}finally{x(!1)}};return e.jsxs("div",{className:"employee p-2.5",children:[e.jsx("div",{className:"flex justify-end mb-2",children:e.jsx("div",{className:"flex gap-1",children:e.jsx(m,{variant:"contained",startIcon:e.jsx(Y,{}),onClick:()=>o(!0),children:"Add Leave"})})}),e.jsx(w,{customStyles:$(),columns:z,data:y,pagination:!0,highlightOnHover:!0}),e.jsx(k,{open:M,onClose:()=>{o(!1),l(t)},children:e.jsx("div",{className:"membermodal w-[400px]",children:e.jsxs("form",{onSubmit:S,children:[e.jsx("h2",{children:"Add Leave Request"}),e.jsx("span",{className:"modalcontent ",children:e.jsxs(P,{dateAdapter:I,children:[e.jsxs(q,{required:!0,fullWidth:!0,size:"small",children:[e.jsx(A,{children:"Type"}),e.jsxs(L,{label:"Department",value:s.type,onChange:a=>n(a.target.value,"type"),children:[e.jsx(p,{selected:!0,value:"formal",children:"Formal"}),e.jsx(p,{selected:!0,value:"casual",children:"Casual"}),e.jsx(p,{selected:!0,value:"sick",children:"Sick"})]})]}),e.jsx(b,{label:"From Date",format:"dd/MM/yyyy",required:!0,value:s.fromDate,onChange:a=>n(a,"fromDate"),slotProps:{textField:{fullWidth:!0}}}),e.jsx(b,{format:"dd/MM/yyyy",label:"To Date",value:s.toDate,onChange:a=>n(a,"toDate"),slotProps:{textField:{fullWidth:!0}}}),e.jsx(N,{label:"Reason",required:!0,multiline:!0,minRows:2,maxRows:5,value:s.reason,onChange:a=>n(a.target.value,"reason"),fullWidth:!0}),e.jsxs("div",{className:"flex w-full justify-end gap-3",children:[e.jsx(m,{onClick:()=>{o(!1),l(t)},variant:"outlined",children:"Cancel"}),e.jsx(m,{type:"submit",variant:"contained",disabled:h,children:h?"Submitting...":"Apply"})]})]})})]})})})]})},z=[{name:"Date",selector:t=>c(t.fromDate).format("DD MMM, YYYY")},{name:"From",selector:t=>c(t.fromDate).format("DD MMM, YYYY")},{name:"TO",selector:t=>c(t.toDate).format("DD MMM, YYYY")},{name:"Reason",selector:t=>t.reason},{name:"Status",selector:t=>e.jsx("span",{className:`
                  px-2 py-1 capitalize rounded-l relative overflow-hidden
                  before:absolute before:content-[''] before:w-[2px] before:h-full before:left-0
                  ${t.status==="approved"&&"text-green-700 bg-green-100 before:bg-green-800"}
                  ${t.status==="pending"&&"text-yellow-700 bg-yellow-100 before:bg-yellow-600"}
                  ${t.status==="rejected"&&"text-red-700 bg-red-100 before:bg-red-800"}
               `,children:t.status})}];export{z as columns,Q as default};
