import{bt as j,g as v,j as s,h as a,A,k as C,l as D,a3 as Y,a1 as E,y,c as N,D as I}from"./index-DPcpnn9F.js";import{A as R}from"./index-CmfoG6p7.js";function H(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M435.9 64.9l-367.1 160c-6.5 3.1-6.3 12.4.3 15.3l99.3 56.1c5.9 3.3 13.2 2.6 18.3-1.8l195.8-168.8c1.3-1.1 4.4-3.2 5.6-2 1.3 1.3-.7 4.3-1.8 5.6L216.9 320.1c-4.7 5.3-5.4 13.1-1.6 19.1l64.9 104.1c3.2 6.3 12.3 6.2 15.2-.2L447.2 76c3.3-7.2-4.2-14.5-11.3-11.1z"},child:[]}]})(l)}function z(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M403.002 217.001C388.998 148.002 328.998 96 256 96c-57.998 0-107.998 32.998-132.998 81.001C63.002 183.002 16 233.998 16 296c0 65.996 53.999 120 120 120h260c55 0 100-45 100-100 0-52.998-40.996-96.001-92.998-98.999zM224 268v-76h64v76h68L256 368 156 268h68z"},child:[]}]})(l)}function O(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"g",attr:{fillOpacity:".9"},child:[{tag:"path",attr:{d:"M255.8 48C141 48 48 141.2 48 256s93 208 207.8 208c115 0 208.2-93.2 208.2-208S370.8 48 255.8 48zm.2 374.4c-91.9 0-166.4-74.5-166.4-166.4S164.1 89.6 256 89.6 422.4 164.1 422.4 256 347.9 422.4 256 422.4z"},child:[]},{tag:"path",attr:{d:"M266.4 152h-31.2v124.8l109.2 65.5 15.6-25.6-93.6-55.5V152z"},child:[]}]}]})(l)}const L=async({isPunchIn:l,inp:n,setisload:r,dispatch:d})=>{r(!1);const x={employeeId:n.employeeId,date:a(n.date).toDate()};n.status=="leave"&&(x.reason=n.reason);const i=l?{...x,...n.punchIn?{punchIn:a(n.punchIn).toDate()}:{},status:n.status}:{...x,...n.punchOut?{punchOut:a(n.punchOut).toDate()}:{}},p=l?"/api/checkin":"/api/checkout";try{const o=localStorage.getItem("emstoken"),e=await N.post(p,{...i},{headers:{Authorization:`Bearer ${o}`}});return y.success(e.data.message,{autoClose:1800}),d(I()),!0}catch(o){console.log(o),o.response?y.warn(o.response.data.message,{autoClose:3e3}):o.request?console.error("No response from server:",o.request):console.error("Error:",o.message)}finally{r(!1)}},T=async({attandanceId:l,setselectedRows:n,setisload:r,dispatch:d})=>{if(!l)return y.warning("Attandance Id is needed");const x="/api/deleteattandence";try{const i=localStorage.getItem("emstoken"),p=await N.post(x,{attandanceId:l},{headers:{Authorization:`Bearer ${i}`}});return y.success(p.data.message,{autoClose:1800}),d(I()),n([]),!0}catch(i){console.log(i),i.response?y.warn(i.response.data.message,{autoClose:2700}):i.request?console.error("No response from server:",i.request):console.error("Error:",i.message)}finally{r(!1)}};function M(l,n,r){var x,i,p;const d=n.find(o=>o._id===l.branchId&&o.defaultsetting===!1);return d?{attendanceRules:(x=d==null?void 0:d.setting)==null?void 0:x.attendanceRules,workingMinutes:(i=d==null?void 0:d.setting)==null?void 0:i.workingMinutes,weeklyOffs:(p=d==null?void 0:d.setting)==null?void 0:p.weeklyOffs}:{attendanceRules:r==null?void 0:r.attendanceRules,workingMinutes:r==null?void 0:r.workingMinutes,weeklyOffs:r==null?void 0:r.weeklyOffs}}const W=({branch:l,company:n,holidaydate:r,minutesinhours:d,canEdit:x,canDelete:i,edite:p,deletee:o})=>[{name:"Name",selector:e=>{var t,c;return(c=(t=e==null?void 0:e.employeeId)==null?void 0:t.userid)==null?void 0:c.name},sortable:!0,style:{minWidth:"180px"},cell:e=>{var t,c,h,m,u;return s.jsxs("div",{className:"flex items-center gap-3 ",children:[s.jsx(A,{src:C((t=e==null?void 0:e.employeeId)==null?void 0:t.profileimage,{format:"webp",width:100,height:100}),alt:(c=e==null?void 0:e.employeeId)==null?void 0:c.employeename,children:!((h=e==null?void 0:e.employeeId)!=null&&h.profileimage)&&s.jsx(D,{})}),s.jsx(Y,{children:s.jsx("p",{className:"text-[12px] md:text-[14px] text-gray-700 font-semibold",children:(u=(m=e==null?void 0:e.employeeId)==null?void 0:m.userid)==null?void 0:u.name})})]})}},{name:"Date",selector:e=>e.date,sortable:!0,width:"110px",cell:e=>a(e.date).format("DD MMM, YYYY")},{name:"Punch In",width:"140px",cell:e=>{if(!e.punchIn)return"- : -";const t=M(e,l,n),c=t==null?void 0:t.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY")),[m,u]=t.attendanceRules.considerEarlyEntryBefore.split(":").map(Number),[f,g]=t.attendanceRules.considerLateEntryAfter.split(":").map(Number),k=a(e.punchIn).startOf("day").add(m,"hour").add(u,"minute"),b=a(e.punchIn).startOf("day").add(f,"hour").add(g,"minute");return s.jsxs("div",{className:"flex w-full items-center gap-1",children:[s.jsx(O,{className:"text-[16px] text-blue-700"}),a(e.punchIn).format("hh:mm A"),!c&&!h&&s.jsxs(s.Fragment,{children:[a(e.punchIn).isBefore(k)&&s.jsx("span",{className:"px-2 py-1 rounded bg-sky-100 text-sky-800",children:"Early"}),a(e.punchIn).isAfter(b)&&s.jsx("span",{className:"px-2 py-1 rounded bg-amber-100 text-amber-800",children:"Late"})]})]})}},{name:"Punch Out",width:"140px",cell:e=>{if(!e.punchOut)return"- : -";const t=M(e,l,n),c=t==null?void 0:t.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY")),[m,u]=t.attendanceRules.considerEarlyExitBefore.split(":").map(Number),[f,g]=t.attendanceRules.considerLateExitAfter.split(":").map(Number),k=a(e.punchOut).startOf("day").add(m,"hour").add(u,"minute"),b=a(e.punchOut).startOf("day").add(f,"hour").add(g,"minute");return s.jsxs("div",{className:"flex  items-center gap-1",children:[s.jsx(O,{className:"text-[16px] text-blue-700"}),a(e.punchOut).format("hh:mm A"),!c&&!h&&s.jsxs(s.Fragment,{children:[a(e.punchOut).isBefore(k)&&s.jsx("span",{className:"px-2 py-1 rounded bg-amber-100 text-amber-800",children:"Early"}),a(e.punchOut).isAfter(b)&&s.jsx("span",{className:"px-2 py-1 rounded bg-sky-100 text-sky-800",children:"Late"})]})]})}},{name:"Status",width:"100px",cell:e=>{var u;const t=e.status==="absent",c=e.status==="leave",h=e.status==="holiday",m=e.status==="weekly off";return s.jsx("span",{title:c?(u=e==null?void 0:e.leave)==null?void 0:u.reason:"",className:`px-2 py-1 rounded
             ${t?"bg-red-100 text-red-800":c?"bg-amber-100 text-amber-800":h?"bg-blue-50 text-blue-800":m?"bg-gray-50 text-gray-800":"bg-green-100 text-green-800"}`,children:e.status})}},{name:"Working Hours",width:"210px",cell:e=>{var m,u,f,g;const t=M(e,l,n),c=t==null?void 0:t.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY"));return e.workingMinutes?s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("span",{className:"inline-block w-[50px]",children:d(e==null?void 0:e.workingMinutes)}),c||h?s.jsxs("span",{className:"ml-2 px-1 py-1 rounded bg-green-100 text-green-800",children:["Overtime ",e.workingMinutes," min"]}):s.jsxs(s.Fragment,{children:[e.workingMinutes<((m=t==null?void 0:t.workingMinutes)==null?void 0:m.shortDayThreshold)&&s.jsxs("span",{className:"ml-2 px-1 py-1 rounded bg-amber-100 text-amber-800",children:["Short ",((u=t==null?void 0:t.workingMinutes)==null?void 0:u.shortDayThreshold)-e.workingMinutes," min"]}),e.workingMinutes>((f=t==null?void 0:t.workingMinutes)==null?void 0:f.overtimeAfterMinutes)&&s.jsxs("span",{className:"ml-2 p-1 rounded bg-green-100 text-green-800",children:["Overtime ",e.workingMinutes-((g=t==null?void 0:t.workingMinutes)==null?void 0:g.overtimeAfterMinutes)," min"]})]})]}),s.jsx("p",{className:"text-[12px] mt-1 text-gray-600",children:h?"(Holiday)":c?"(Weekly Off)":""})]}):"-"}},{name:"Action",width:"80px",cell:e=>s.jsxs("div",{className:"flex gap-2.5",children:[x&&s.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>p(e),children:s.jsx(E,{})}),i&&s.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",onClick:()=>o(e._id),children:s.jsx(R,{})})]})}],F=()=>({headCells:{style:{backgroundColor:v(n=>n.user.primaryColor)||"#115e59",fontWeight:"bold",fontSize:"14px",color:"white",justifyContent:"flex-start",paddingLeft:"8px",paddingRight:"0px"}},headRow:{style:{borderBottom:"2px solid #ccc"}},rows:{style:{minHeight:"48px",borderBottom:"1px solid #eee"}},cells:{style:{justifyContent:"flex-start",paddingLeft:"8px",paddingRight:"0px"}}});export{H as I,O as a,z as b,W as c,T as d,L as s,F as u};
