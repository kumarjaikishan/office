import{r as d,b as u,y as n,j as t,W as E,g as $,S as D}from"./index-Bn9gE8Df.js";import{X as M}from"./index.es-BZecx7uc.js";import{u as z}from"./attandencehelper-C1z0bw8z.js";import{a as B}from"./index-On5OAOX7.js";import{A as U}from"./index-BBNnZ70F.js";import{M as I}from"./Modalbox-BiVmHAUV.js";import{B as p}from"./Button-CxBkVLdW.js";import{T as x}from"./TextField-DCGrmm5-.js";import"./Select-D5eREMyP.js";import"./createSimplePaletteValueFilter-B5ZCTa1T.js";import"./useSlotProps-D4oRlUF-.js";import"./ButtonBase-CwA52pCW.js";const J=()=>{d.useEffect(()=>{m()},[]);const h={userid:"",name:"",email:"",password:""},[j,v]=d.useState([]),[y,l]=d.useState(!1),[r,c]=d.useState(h),[g,f]=d.useState(!1),m=async()=>{var e,a;try{const s=localStorage.getItem("emstoken"),o=await u.get("/api/developerfetch",{headers:{Authorization:`Bearer ${s}`}});v(o.data.users)}catch(s){console.log(s),n.warn(((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.message)||"Error",{autoClose:3e3})}},C=async e=>{var a,s;e.preventDefault();try{const o=localStorage.getItem("emstoken"),i=await u.post("/api/User",{...r},{headers:{Authorization:`Bearer ${o}`}});l(!1),m(),n.success(i.data.message,{autoClose:1800})}catch(o){console.log(o),n.warn(((s=(a=o.response)==null?void 0:a.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}finally{}},w=e=>{c({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),f(!0),l(!0)},N=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async a=>{var s,o;if(a)try{const i=localStorage.getItem("emstoken"),A=await u.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${i}`}});m(),n.success(A.data.message,{autoClose:1800})}catch(i){console.log(i),n.warn(((o=(s=i.response)==null?void 0:s.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}})},S=async()=>{var e,a;try{const s=localStorage.getItem("emstoken"),o=await u.put(`/api/User/${r.userid}`,{name:r.name,email:r.email},{headers:{Authorization:`Bearer ${s}`}});l(!1),m(),n.success(o.data.message,{autoClose:1800})}catch(s){console.log(s),n.warn(((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.message)||"Error",{autoClose:3e3})}},b=()=>{l(!1),c(h),f(!1)},k=[{name:"S.No",selector:(e,a)=>a+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??""},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>$(e.createdAt).format("DD MMM, YY")},{name:"Status",selector:e=>e.stat||"-",width:"130px"},{name:"Action",width:"100px",cell:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>w(e),children:t.jsx(D,{})}),t.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>N(e._id),children:t.jsx(U,{})})]})}];return t.jsxs("div",{children:[t.jsx("div",{className:"my-1 flex justify-end",children:t.jsx(p,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:t.jsx(E,{}),onClick:()=>l(!0),children:"Add User"})}),t.jsx(M,{columns:k,data:j,pagination:!0,customStyles:z(),highlightOnHover:!0,noDataComponent:t.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[t.jsx(B,{className:"text-xl"})," No records found matching your criteria."]})}),t.jsx(I,{open:y,onClose:()=>{l(!1)},children:t.jsx("div",{className:"membermodal",children:t.jsxs("form",{onSubmit:C,children:[t.jsx("h2",{children:"Add New User"}),t.jsxs("span",{className:"modalcontent ",children:[t.jsx(x,{fullWidth:!0,required:!0,value:r.name,onChange:e=>c({...r,name:e.target.value}),label:"Name",size:"small"}),t.jsx(x,{fullWidth:!0,required:!0,type:"email",value:r.email,onChange:e=>c({...r,email:e.target.value}),label:"Email",size:"small"}),!g&&t.jsx(x,{fullWidth:!0,required:!0,type:"password",value:r.password,onChange:e=>c({...r,password:e.target.value}),label:"Passowrd",size:"small"}),t.jsxs("div",{children:[g?t.jsx(p,{variant:"contained",sx:{mr:2},onClick:S,children:"Save"}):t.jsx(p,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),t.jsx(p,{variant:"outlined",onClick:b,sx:{mr:2},children:"Cancel"})]})]})]})})})]})};export{J as default};
