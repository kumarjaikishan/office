import{r as u,b as m,j as t,y as c}from"./index-D6eprowh.js";import{B as f}from"./Box-BtzIr_7-.js";import{T as h}from"./Typography-Ckr0zgK-.js";import{G as y,L as p}from"./ListItemText-oZKj0b5j.js";import{T as n}from"./TextField-CqHbrCr8.js";import{F as b,I as x,S as v,O as M}from"./Select-B9XRi5ke.js";import{M as k}from"./MenuItem-BeSv7JL_.js";import{C as j}from"./Checkbox-B2yb7aRi.js";import{B as C}from"./Button-D8pdstAJ.js";import"./useSlotProps-CwI_XqsP.js";import"./createSimplePaletteValueFilter-CCWcIbuk.js";import"./styled-Bc1kg25I.js";import"./useThemeProps-CfxGyLkI.js";import"./ButtonBase-DJxbAmSf.js";const d=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],T={companyName:"Goodnature",officeTime:{in:"10:00",out:"18:00",breakMinutes:30},gracePeriod:{lateEntryMinutes:10,earlyExitMinutes:10},workingMinutes:{fullDay:540,halfDay:270,shortDayThreshold:360,overtimeAfterMinutes:540},weeklyOffs:[0],attendanceRules:{considerEarlyEntryBefore:"10:00",considerLateEntryAfter:"10:40",considerEarlyExitBefore:"18:00",considerLateExitAfter:"18:30"}},G=()=>{const[a,o]=u.useState(T);u.useEffect(()=>{const e=localStorage.getItem("emstoken");m.get("/api/getsetting",{headers:{Authorization:`Bearer ${e}`}}).then(l=>{console.log(l.data);const r=l.data||{};o(s=>({...s,...r,officeTime:{...s.officeTime,...r.officeTime||{}},gracePeriod:{...s.gracePeriod,...r.gracePeriod||{}},workingMinutes:{...s.workingMinutes,...r.workingMinutes||{}},attendanceRules:{...s.attendanceRules,...r.attendanceRules||{}}}))}).catch(()=>{console.warn("Failed to load settings.")})},[]);const i=(e,l,r)=>{o(s=>({...s,[e]:{...s[e],[l]:r}}))},g=async()=>{try{const e=localStorage.getItem("emstoken"),l=await m.post("/api/setsetting",{...a},{headers:{Authorization:`Bearer ${e}`}});console.log("set setting Query:",l),c.success(l.data.message,{autoClose:1800})}catch(e){console.log(e),e.response?c.warn(e.response.data.message,{autoClose:2700}):e.request?console.error("No response from server:",e.request):console.error("Error:",e.message)}};return t.jsxs(f,{sx:{maxWidth:900,mx:"auto",p:4},children:[t.jsx(h,{variant:"h5",gutterBottom:!0,children:"Company Settings"}),t.jsxs(y,{container:!0,spacing:2,children:[t.jsx(n,{fullWidth:!0,label:"Company Name",value:a.companyName,onChange:e=>o({...a,companyName:e.target.value})}),t.jsx(n,{label:"Office Time In",fullWidth:!0,type:"time",value:a.officeTime.in,onChange:e=>i("officeTime","in",e.target.value)}),t.jsx(n,{label:"Office Time Out",fullWidth:!0,type:"time",value:a.officeTime.out,onChange:e=>i("officeTime","out",e.target.value)}),t.jsx(n,{label:"Break Minutes",fullWidth:!0,type:"number",value:a.officeTime.breakMinutes,onChange:e=>i("officeTime","breakMinutes",Number(e.target.value))}),t.jsx(n,{label:"Late Entry Grace (min)",fullWidth:!0,type:"number",value:a.gracePeriod.lateEntryMinutes,onChange:e=>i("gracePeriod","lateEntryMinutes",Number(e.target.value))}),t.jsx(n,{label:"Early Exit Grace (min)",fullWidth:!0,type:"number",value:a.gracePeriod.earlyExitMinutes,onChange:e=>i("gracePeriod","earlyExitMinutes",Number(e.target.value))}),t.jsx(n,{label:"Full Day Minutes",fullWidth:!0,type:"number",value:a.workingMinutes.fullDay,onChange:e=>i("workingMinutes","fullDay",Number(e.target.value))}),t.jsx(n,{label:"Half Day Minutes",fullWidth:!0,type:"number",value:a.workingMinutes.halfDay,onChange:e=>i("workingMinutes","halfDay",Number(e.target.value))}),t.jsx(n,{label:"Short Day Threshold (min)",fullWidth:!0,type:"number",value:a.workingMinutes.shortDayThreshold,onChange:e=>i("workingMinutes","shortDayThreshold",Number(e.target.value))}),t.jsx(n,{label:"Overtime After Minutes",fullWidth:!0,type:"number",value:a.workingMinutes.overtimeAfterMinutes,onChange:e=>i("workingMinutes","overtimeAfterMinutes",Number(e.target.value))}),t.jsxs(b,{fullWidth:!0,children:[t.jsx(x,{children:"Weekly Offs"}),t.jsx(v,{multiple:!0,value:a.weeklyOffs,onChange:e=>o({...a,weeklyOffs:e.target.value}),input:t.jsx(M,{label:"Weekly Offs"}),renderValue:e=>e.map(l=>{var r;return(r=d.find(s=>s.value===l))==null?void 0:r.label}).join(", "),children:d.map(e=>t.jsxs(k,{value:e.value,children:[t.jsx(j,{checked:a.weeklyOffs.includes(e.value)}),t.jsx(p,{primary:e.label})]},e.value))})]}),Object.entries(a.attendanceRules).map(([e,l])=>t.jsx(n,{fullWidth:!0,label:e.replace(/([A-Z])/g," $1").replace(/^./,r=>r.toUpperCase()),type:"time",value:l,onChange:r=>i("attendanceRules",e,r.target.value)},e))]}),t.jsx(f,{sx:{mt:4,textAlign:"right"},children:t.jsx(C,{variant:"contained",onClick:g,children:"Update Settings"})})]})};export{G as default};
