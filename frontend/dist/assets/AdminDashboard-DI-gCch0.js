import{g as b,r as a,a as z,u as k,h as d,j as e,F as N,I as v,S as y,M as c,O as I,i as S,C as _,A as P,k as R}from"./index-BaIBXqin.js";import{D as B}from"./dashboardCard-BUGRQt_b.js";import{T as M}from"./Tooltip-6hOWHoTT.js";import"./Popper-N1qRPdR7.js";const G=()=>{var g;const{attandence:r,employee:x,branch:i,department:u}=b(s=>s.user),{islogin:A,isadmin:q}=b(s=>s.auth),[h,w]=a.useState([]),[f,E]=a.useState([]);let D=z();k();const C=a.useRef(r),[l,F]=a.useState("all"),[p,j]=a.useState("all"),[m,O]=a.useState([]);return a.useEffect(()=>{!A&&D("/login")},[]),a.useEffect(()=>{if(!x||x.length===0)return;const s=x.filter(n=>{const t=l==="all"||n.branchId===l,o=p==="all"||n.department._id===p;return t&&o});O(s)},[l,p,x]),a.useEffect(()=>{j("all")},[l]),a.useEffect(()=>{C.current=r},[r]),a.useEffect(()=>{if(!r)return;let s=r.filter(t=>d(t.date).isSame(d(),"day")&&!t.punchOut),n=r.filter(t=>d(t.date).isSame(d(),"day"));w(s),E(n)},[r]),a.useEffect(()=>()=>{},[]),e.jsxs("div",{className:"p-0  md:p-3",children:[e.jsx("div",{className:"mb-3 ",children:e.jsx(B,{employee:x,todaypresent:f.length,currentpresent:h.length})}),e.jsxs("div",{className:"w-full flex-col flex gap-5 shadow  bg-white p-2 rounded",children:[e.jsxs("div",{className:"flex gap-3 pt-3",children:[e.jsxs(N,{sx:{width:"160px"},required:!0,size:"small",children:[e.jsx(v,{id:"demo-simple-select-helper-label",children:"Branch"}),e.jsxs(y,{value:l,input:e.jsx(I,{startAdornment:e.jsx(S,{position:"start",children:e.jsx(_,{fontSize:"small"})}),label:"branch"}),onChange:s=>F(s.target.value),children:[e.jsx(c,{selected:!0,value:"all",children:"All"}),(i==null?void 0:i.length)>1?i==null?void 0:i.map(s=>e.jsx(c,{value:s._id,children:s.name},s._id)):e.jsx(c,{disabled:!0,value:"",children:"No Branch Found"})]})]}),e.jsxs(N,{sx:{width:"160px"},required:!0,size:"small",children:[e.jsx(v,{id:"demo-simple-select-helper-label",children:"Department"}),e.jsxs(y,{disabled:l=="all",value:p,input:e.jsx(I,{startAdornment:e.jsx(S,{position:"start",children:e.jsx(_,{fontSize:"small"})}),label:"Department"}),onChange:s=>j(s.target.value),children:[e.jsx(c,{selected:!0,value:"all",children:"All"}),(u==null?void 0:u.length)>1?(g=u.filter(s=>s.branchId._id==l))==null?void 0:g.map(s=>e.jsx(c,{value:s._id,children:s.department},s._id)):e.jsx(c,{disabled:!0,value:"",children:"No Department Found"})]})]})]}),e.jsx("div",{className:"px-1 md:px-3 grid grid-cols-5 md:grid-cols-10 lg:grid-cols-13 gap-2 md:gap-4",children:m==null?void 0:m.map(s=>{const n=h.some(o=>o.employeeId._id===s._id),t=f.find(o=>o.employeeId._id===s._id);return e.jsx(M,{arrow:!0,enterDelay:800,placement:"top",title:e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("span",{children:[" In       ",t!=null&&t.punchIn?d(t.punchIn).format("hh:mm A"):" -:-"]}),e.jsxs("span",{children:[" Out    ",t!=null&&t.punchOut?d(t.punchOut).format("hh:mm A"):"-:-"]})]}),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`${t?n?"border-green-500":"border-amber-400":"border-gray-300"} p-[2px] border-3 rounded-full`,children:e.jsx(P,{src:s.profileimage,alt:s.employeename,children:!s.profileimage&&e.jsx(R,{})})}),e.jsx("p",{className:`${t?n?"text-green-600 text-[14px]":"text-amber-700":"text-gray-500"} text-[12px] text-center transition-all duration-300 capitalize `,children:s.userid.name})]},s._id)},s._id)})}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-500 text-[13px] ",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-green-500 "})," In Premise"]}),e.jsxs("span",{className:"flex items-center gap-1 text-amber-700 text-[13px]",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-amber-500 "})," Present"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-500 text-[13px]",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-gray-500  "})," Absent"]})]})]})]})};export{G as default};
