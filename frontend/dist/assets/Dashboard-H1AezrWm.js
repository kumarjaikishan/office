import{r as d,c as u,y as l,j as t,B as x,$ as E,a0 as $,h as D,a1 as M,b as p,R as z}from"./index-DBKpBzGg.js";import{u as B}from"./attandencehelper-Cwq7A8Tb.js";import{a as U}from"./index-DIU8Fm62.js";import{A as I}from"./index-ZEQGb_Gi.js";import"./index-BVG7apjh.js";const Y=()=>{d.useEffect(()=>{m()},[]);const h={userid:"",name:"",email:"",password:""},[j,v]=d.useState([]),[y,n]=d.useState(!1),[r,c]=d.useState(h),[g,f]=d.useState(!1),m=async()=>{var e,s;try{const a=localStorage.getItem("emstoken"),o=await u.get("/api/developerfetch",{headers:{Authorization:`Bearer ${a}`}});v(o.data.users)}catch(a){console.log(a),l.warn(((s=(e=a.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},w=async e=>{var s,a;e.preventDefault();try{const o=localStorage.getItem("emstoken"),i=await u.post("/api/User",{...r},{headers:{Authorization:`Bearer ${o}`}});n(!1),m(),l.success(i.data.message,{autoClose:1800})}catch(o){console.log(o),l.warn(((a=(s=o.response)==null?void 0:s.data)==null?void 0:a.message)||"Error",{autoClose:3e3})}finally{}},C=e=>{c({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),f(!0),n(!0)},N=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{var a,o;if(s)try{const i=localStorage.getItem("emstoken"),A=await u.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${i}`}});m(),l.success(A.data.message,{autoClose:1800})}catch(i){console.log(i),l.warn(((o=(a=i.response)==null?void 0:a.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}})},S=async()=>{var e,s;try{const a=localStorage.getItem("emstoken"),o=await u.put(`/api/User/${r.userid}`,{name:r.name,email:r.email},{headers:{Authorization:`Bearer ${a}`}});n(!1),m(),l.success(o.data.message,{autoClose:1800})}catch(a){console.log(a),l.warn(((s=(e=a.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},b=()=>{n(!1),c(h),f(!1)},k=[{name:"S.No",selector:(e,s)=>s+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??""},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>D(e.createdAt).format("DD MMM, YY")},{name:"Status",selector:e=>e.stat||"-",width:"130px"},{name:"Action",width:"100px",cell:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>C(e),children:t.jsx(z,{})}),t.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>N(e._id),children:t.jsx(I,{})})]})}];return t.jsxs("div",{children:[t.jsx("div",{className:"my-1 flex justify-end",children:t.jsx(x,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:t.jsx(E,{}),onClick:()=>n(!0),children:"Add User"})}),t.jsx($,{columns:k,data:j,pagination:!0,customStyles:B(),highlightOnHover:!0,noDataComponent:t.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[t.jsx(U,{className:"text-xl"})," No records found matching your criteria."]})}),t.jsx(M,{open:y,onClose:()=>{n(!1)},children:t.jsx("div",{className:"membermodal w-[500px]",children:t.jsxs("form",{onSubmit:w,children:[t.jsx("h2",{children:"Add New User"}),t.jsx("span",{className:"modalcontent ",children:t.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[t.jsx(p,{fullWidth:!0,required:!0,value:r.name,onChange:e=>c({...r,name:e.target.value}),label:"Name",size:"small"}),t.jsx(p,{fullWidth:!0,required:!0,type:"email",value:r.email,onChange:e=>c({...r,email:e.target.value}),label:"Email",size:"small"}),!g&&t.jsx(p,{fullWidth:!0,required:!0,type:"password",value:r.password,onChange:e=>c({...r,password:e.target.value}),label:"Passowrd",size:"small"}),t.jsxs("div",{children:[g?t.jsx(x,{variant:"contained",sx:{mr:2},onClick:S,children:"Save"}):t.jsx(x,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),t.jsx(x,{variant:"outlined",onClick:b,sx:{mr:2},children:"Cancel"})]})]})})]})})})]})};export{Y as default};
