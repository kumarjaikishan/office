import{h as je,i as ve,r as c,k as be,l as es,m as ss,j as e,n as V,o as ce,p as we,q as te,t as le,b as ue,y as Y,v as Qe,G as ke,w as ts,x as Me,z as Te,g as ye,B as $e,D as Fe,E as as,H as ns,M as rs,I as os,J as is,u as ls,f as ds,a as cs,K as Be,T as us,A as We,L as ms,C as Ge,O as ps,P as xs,Q as Ue,R as _e}from"./index-BbzY4ZUI.js";import{I as qe}from"./index-D4jmEOvm.js";import{M as Se}from"./Modalbox-wGiHBFhx.js";import{X as hs}from"./index.es-D1qtK2rE.js";import{I as gs,a as fs}from"./index-DHx23ukx.js";import{H as js}from"./index-CaqKquCe.js";import{B as vs,P as bs,L as ws}from"./index-C7_5-poe.js";import{A as Ns}from"./index-zcu_T75I.js";import{u as Cs}from"./imageresizer-D4I-KFLq.js";import{C as Ae}from"./CheckPermission-BK4caeRk.js";import{u as ys}from"./attandencehelper-B0fjni3z.js";import{B as H}from"./Box-C64WVMau.js";import{T as de}from"./Typography-B4QEqcF5.js";import{T as N}from"./TextField-BDLtnsif.js";import{I as Ee}from"./InputAdornment-CFUorUYE.js";import{T as Ss,g as Le,u as As,P as Es,F as ne,I as re,S as oe,O as Oe}from"./Select-D_NGKd3N.js";import{M as B}from"./MenuItem-BeTW2alY.js";import{B as K}from"./Button-DWI-vyDf.js";import{u as Is}from"./useSlotProps-CI7U4UXW.js";import{u as Ds,B as Ps}from"./ButtonBase-DViDmRa1.js";import"./createSimplePaletteValueFilter-CPf6oSdo.js";function zs(a){return je("MuiCollapse",a)}ve("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Rs=a=>{const{orientation:r,classes:l}=a,t={root:["root",`${r}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${r}`],wrapperInner:["wrapperInner",`${r}`]};return we(t,zs,l)},ks=V("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(a,r)=>{const{ownerState:l}=a;return[r.root,r[l.orientation],l.state==="entered"&&r.entered,l.state==="exited"&&!l.in&&l.collapsedSize==="0px"&&r.hidden]}})(te(({theme:a})=>({height:0,overflow:"hidden",transition:a.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:a.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:r})=>r.state==="exited"&&!r.in&&r.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Ms=V("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ts=V("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ie=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiCollapse"}),{addEndListener:m,children:p,className:g,collapsedSize:f="0px",component:u,easing:F,in:z,onEnter:D,onEntered:y,onEntering:R,onExit:v,onExited:k,onExiting:j,orientation:b="vertical",style:M,timeout:S=es.standard,TransitionComponent:G=Ss,...Q}=t,E={...t,orientation:b,collapsedSize:f},w=Rs(E),A=Is(),ae=Ds(),h=c.useRef(null),P=c.useRef(),x=typeof f=="number"?`${f}px`:f,U=b==="horizontal",_=U?"width":"height",J=c.useRef(null),q=ss(l,J),i=d=>T=>{if(d){const $=J.current;T===void 0?d($):d($,T)}},I=()=>h.current?h.current[U?"clientWidth":"clientHeight"]:0,X=i((d,T)=>{h.current&&U&&(h.current.style.position="absolute"),d.style[_]=x,D&&D(d,T)}),me=i((d,T)=>{const $=I();h.current&&U&&(h.current.style.position="");const{duration:Z,easing:L}=Le({style:M,timeout:S,easing:F},{mode:"enter"});if(S==="auto"){const he=A.transitions.getAutoHeightDuration($);d.style.transitionDuration=`${he}ms`,P.current=he}else d.style.transitionDuration=typeof Z=="string"?Z:`${Z}ms`;d.style[_]=`${$}px`,d.style.transitionTimingFunction=L,R&&R(d,T)}),pe=i((d,T)=>{d.style[_]="auto",y&&y(d,T)}),Ne=i(d=>{d.style[_]=`${I()}px`,v&&v(d)}),xe=i(k),Ce=i(d=>{const T=I(),{duration:$,easing:Z}=Le({style:M,timeout:S,easing:F},{mode:"exit"});if(S==="auto"){const L=A.transitions.getAutoHeightDuration(T);d.style.transitionDuration=`${L}ms`,P.current=L}else d.style.transitionDuration=typeof $=="string"?$:`${$}ms`;d.style[_]=x,d.style.transitionTimingFunction=Z,j&&j(d)}),C=d=>{S==="auto"&&ae.start(P.current||0,d),m&&m(J.current,d)};return e.jsx(G,{in:z,onEnter:X,onEntered:pe,onEntering:me,onExit:Ne,onExited:xe,onExiting:Ce,addEndListener:C,nodeRef:J,timeout:S==="auto"?null:S,...Q,children:(d,{ownerState:T,...$})=>e.jsx(ks,{as:u,className:ce(w.root,g,{entered:w.entered,exited:!z&&x==="0px"&&w.hidden}[d]),style:{[U?"minWidth":"minHeight"]:x,...M},ref:q,ownerState:{...E,state:d},...$,children:e.jsx(Ms,{ownerState:{...E,state:d},className:w.wrapper,ref:h,children:e.jsx(Ts,{ownerState:{...E,state:d},className:w.wrapperInner,children:p})})})})});Ie&&(Ie.muiSupportAuto=!0);const Je=c.createContext({});function $s(a){return je("MuiAccordion",a)}const fe=ve("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Fs=a=>{const{classes:r,square:l,expanded:t,disabled:m,disableGutters:p}=a;return we({root:["root",!l&&"rounded",t&&"expanded",m&&"disabled",!p&&"gutters"],heading:["heading"],region:["region"]},$s,r)},Bs=V(Es,{name:"MuiAccordion",slot:"Root",overridesResolver:(a,r)=>{const{ownerState:l}=a;return[{[`& .${fe.region}`]:r.region},r.root,!l.square&&r.rounded,!l.disableGutters&&r.gutters]}})(te(({theme:a})=>{const r={duration:a.transitions.duration.shortest};return{position:"relative",transition:a.transitions.create(["margin"],r),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(a.vars||a).palette.divider,transition:a.transitions.create(["opacity","background-color"],r)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${fe.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${fe.disabled}`]:{backgroundColor:(a.vars||a).palette.action.disabledBackground}}}),te(({theme:a})=>({variants:[{props:r=>!r.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(a.vars||a).shape.borderRadius,borderBottomRightRadius:(a.vars||a).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:r=>!r.disableGutters,style:{[`&.${fe.expanded}`]:{margin:"16px 0"}}}]}))),Ws=V("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),He=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordion"}),{children:m,className:p,defaultExpanded:g=!1,disabled:f=!1,disableGutters:u=!1,expanded:F,onChange:z,square:D=!1,slots:y={},slotProps:R={},TransitionComponent:v,TransitionProps:k,...j}=t,[b,M]=As({controlled:F,default:g,name:"Accordion",state:"expanded"}),S=c.useCallback(I=>{M(!b),z&&z(I,!b)},[b,z,M]),[G,...Q]=c.Children.toArray(m),E=c.useMemo(()=>({expanded:b,disabled:f,disableGutters:u,toggle:S}),[b,f,u,S]),w={...t,square:D,disabled:f,disableGutters:u,expanded:b},A=Fs(w),ae={transition:v,...y},h={transition:k,...R},P={slots:ae,slotProps:h},[x,U]=le("root",{elementType:Bs,externalForwardedProps:{...P,...j},className:ce(A.root,p),shouldForwardComponentProp:!0,ownerState:w,ref:l,additionalProps:{square:D}}),[_,J]=le("heading",{elementType:Ws,externalForwardedProps:P,className:A.heading,ownerState:w}),[q,i]=le("transition",{elementType:Ie,externalForwardedProps:P,ownerState:w});return e.jsxs(x,{...U,children:[e.jsx(_,{...J,children:e.jsx(Je.Provider,{value:E,children:G})}),e.jsx(q,{in:b,timeout:"auto",...i,children:e.jsx("div",{"aria-labelledby":G.props.id,id:G.props["aria-controls"],role:"region",className:A.region,children:Q})})]})});function Gs(a){return je("MuiAccordionDetails",a)}ve("MuiAccordionDetails",["root"]);const Us=a=>{const{classes:r}=a;return we({root:["root"]},Gs,r)},_s=V("div",{name:"MuiAccordionDetails",slot:"Root"})(te(({theme:a})=>({padding:a.spacing(1,2,2)}))),Ye=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordionDetails"}),{className:m,...p}=t,g=t,f=Us(g);return e.jsx(_s,{className:ce(f.root,m),ref:l,ownerState:g,...p})});function qs(a){return je("MuiAccordionSummary",a)}const ie=ve("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Ls=a=>{const{classes:r,expanded:l,disabled:t,disableGutters:m}=a;return we({root:["root",l&&"expanded",t&&"disabled",!m&&"gutters"],focusVisible:["focusVisible"],content:["content",l&&"expanded",!m&&"contentGutters"],expandIconWrapper:["expandIconWrapper",l&&"expanded"]},qs,r)},Os=V(Ps,{name:"MuiAccordionSummary",slot:"Root"})(te(({theme:a})=>{const r={duration:a.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:a.spacing(0,2),transition:a.transitions.create(["min-height","background-color"],r),[`&.${ie.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${ie.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`&:hover:not(.${ie.disabled})`]:{cursor:"pointer"},variants:[{props:l=>!l.disableGutters,style:{[`&.${ie.expanded}`]:{minHeight:64}}}]}})),Hs=V("span",{name:"MuiAccordionSummary",slot:"Content"})(te(({theme:a})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:r=>!r.disableGutters,style:{transition:a.transitions.create(["margin"],{duration:a.transitions.duration.shortest}),[`&.${ie.expanded}`]:{margin:"20px 0"}}}]}))),Ys=V("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(te(({theme:a})=>({display:"flex",color:(a.vars||a).palette.action.active,transform:"rotate(0deg)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shortest}),[`&.${ie.expanded}`]:{transform:"rotate(180deg)"}}))),Ve=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordionSummary"}),{children:m,className:p,expandIcon:g,focusVisibleClassName:f,onClick:u,slots:F,slotProps:z,...D}=t,{disabled:y=!1,disableGutters:R,expanded:v,toggle:k}=c.useContext(Je),j=h=>{k&&k(h),u&&u(h)},b={...t,expanded:v,disabled:y,disableGutters:R},M=Ls(b),S={slots:F,slotProps:z},[G,Q]=le("root",{ref:l,shouldForwardComponentProp:!0,className:ce(M.root,p),elementType:Os,externalForwardedProps:{...S,...D},ownerState:b,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:y,"aria-expanded":v,focusVisibleClassName:ce(M.focusVisible,f)},getSlotProps:h=>({...h,onClick:P=>{var x;(x=h.onClick)==null||x.call(h,P),j(P)}})}),[E,w]=le("content",{className:M.content,elementType:Hs,externalForwardedProps:S,ownerState:b}),[A,ae]=le("expandIconWrapper",{className:M.expandIconWrapper,elementType:Ys,externalForwardedProps:S,ownerState:b});return e.jsxs(G,{...Q,children:[e.jsx(E,{...w,children:m}),g&&e.jsx(A,{...ae,children:g})]})}),Vs=[{name:"S.no",selector:a=>a.sno,width:"40px"},{name:"Name",selector:a=>a.name},{name:"Email",selector:a=>a.email},{name:"Department",selector:a=>a.department},{name:"Action",selector:a=>a.action,width:"160px"}],Qs=async({formData:a,dispatch:r,setisload:l,setInp:t,setopenmodal:m,init:p,resetPhoto:g})=>{const f=localStorage.getItem("emstoken");l(!0);try{const u=await ue.post("/api/addemployee",a,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"multipart/form-data"}});Y.success(u.data.message,{autoClose:1200}),t(p),g(),m(!1),r(Qe())}catch(u){console.log(u),u.response?Y.warn(u.response.data.message,{autoClose:1200}):console.error("Error:",u.message)}finally{l(!1)}},Js=async({formData:a,dispatch:r,setEmployeePhoto:l,setisload:t,setInp:m,setopenmodal:p,init:g})=>{const f=localStorage.getItem("emstoken");t(!0);try{const u=await ue.post("/api/updateemployee",a,{headers:{Authorization:`Bearer ${f}`}});Y.success(u.data.message,{autoClose:1200}),l(null),m(g),p(!1),r(Qe())}catch(u){console.log(u),u.response?Y.warn(u.response.data.message,{autoClose:1200}):u.request?console.error("No response from server:",u.request):console.error("Error:",u.message)}finally{t(!1)}},Xs=async({employeeId:a,setisload:r})=>{if(!a){alert("All fileds are Required");return}const l=localStorage.getItem("emstoken");r(!0);try{const t=await ue.post("/api/deleteemployee",{employeeId:a},{headers:{Authorization:`Bearer ${l}`}});console.log("Query:",t),Y.success(t.data.message,{autoClose:1200})}catch(t){console.log(t),t.response?Y.warn(t.response.data.message,{autoClose:1200}):t.request?console.error("No response from server:",t.request):console.error("Error:",t.message)}finally{r(!1)}},Ks=({viewEmployee:a})=>{var f,u,F,z,D,y,R;const[r,l]=c.useState(!1),[t,m]=c.useState(null),[p,g]=c.useState(1);return c.useEffect(()=>{(async()=>{const k=localStorage.getItem("emstoken");l(!0);try{const j=await ue.get(`/api/getemployee?empid=${a}`,{headers:{Authorization:`Bearer ${k}`}});m(j.data)}catch(j){console.log(j),j.response?Y.warn(j.response.data.message,{autoClose:1200}):j.request?console.error("No response from server:",j.request):console.error("Error:",j.message)}finally{l(!1)}})()},[]),e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"w-full h-[300px] flex gap-5 flex-col justify-center items-center bg-white",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"animate-spin",style:{animationDuration:"2.5s"},size:50,color:"teal"}),e.jsx(ke,{className:"absolute -bottom-4 left-0 animate-spin",style:{animationDuration:"3s"},size:20,color:"teal"})]}),e.jsx("p",{className:"text-teal-600",children:"loading..."})]}):e.jsxs("div",{className:"max-w-3xl mx-auto bg-white flex flex-col shadow rounded-lg p-2 md:p-4 ",children:[e.jsx("h2",{className:"text-xl mx-auto font-semibold text-gray-700 mb-4",children:"Employee Details"}),e.jsxs("div",{className:"flex gap-4  pb-2 md:items-start",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full border-2 border-teal-500 border-dashed p-[2px] flex items-center justify-center overflow-hidden",children:t!=null&&t.profileimage?e.jsx("img",{src:t.profileimage,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):e.jsx(ts,{className:"text-3xl text-gray-500"})}),e.jsxs("div",{className:"md:flex-1 w-auto",children:[e.jsx("h3",{className:"text-l md:text-xl capitalize font-bold text-gray-800",children:(f=t==null?void 0:t.userid)==null?void 0:f.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(u=t==null?void 0:t.userid)==null?void 0:u.role}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded",children:t==null?void 0:t.department.department}),e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded",children:"active"})]}),e.jsxs("div",{className:"hidden md:flex mt-3 justify-start flex-wrap text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Me,{className:"text-gray-500 lowercase"})," ",(F=t==null?void 0:t.userid)==null?void 0:F.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ",ye((z=t==null?void 0:t.userid)==null?void 0:z.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Fe,{className:"text-gray-500"})," ID: emp0002"]})]})]})]}),e.jsxs("div",{className:"md:hidden mt-3 justify-start flex flex-wrap text-[12px] md:text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Me,{className:"text-gray-500 lowercase"})," ",(D=t==null?void 0:t.userid)==null?void 0:D.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ",ye((y=t==null?void 0:t.userid)==null?void 0:y.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Fe,{className:"text-gray-500"})," ID: emp0002"]})]}),e.jsxs("div",{className:"pt-1 capitalize",children:[e.jsxs("div",{className:"flex gap-2 md:gap-6 bg-slate-200 p-1 mt-2 text-[12px] md:text-sm font-medium text-gray-700",children:[e.jsx("div",{onClick:()=>g(1),className:`${p==1?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Personal Info"}),e.jsx("div",{onClick:()=>g(2),className:`${p==2?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Employment"}),e.jsx("div",{onClick:()=>g(3),className:`${p==3?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Documents & Skills"})]}),p==1&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(as,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Date of Birth"}),e.jsx("div",{children:t!=null&&t.dob?ye(t==null?void 0:t.dob).format("DD MMM,YYYY"):"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ns,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Address"}),e.jsx("div",{children:(t==null?void 0:t.address)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(rs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Emergency Contact"}),e.jsx("div",{children:(t==null?void 0:t.Emergencyphone)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(vs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Blood Group"}),e.jsx("div",{children:(t==null?void 0:t.bloodGroup)||"N/A"})]})]})]}),p==2&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(bs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Position"}),e.jsx("div",{children:(t==null?void 0:t.designation)||"Accounts"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(os,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Department"}),e.jsx("div",{children:((R=t==null?void 0:t.department)==null?void 0:R.department)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(is,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Salary"}),e.jsx("div",{children:(t==null?void 0:t.salary)||"N/A"})]})]})]}),p==3&&e.jsxs("div",{className:"mt-2 p-2 grid grid-cols-1 max-h-[300px] overflow-y-auto sm:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Education"}),t.education.length>0?t.education.map(v=>e.jsxs("div",{className:"relative my-1 pl-2 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:v.degree}),e.jsx("p",{className:"text-gray-700",children:v.institution}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:v.date}),e.jsx("span",{className:"absolute w-0.5 h-full bg-amber-800 top-0 left-0"})]})):e.jsx("div",{children:"No Data found"})]}),e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Achievement"}),t.achievements.length>0?t.achievements.map(v=>e.jsxs("div",{className:"relative my-1 pl-5 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:v.title}),e.jsx("p",{className:"text-gray-700",children:v.description}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:v.date}),e.jsxs("span",{className:"absolute top-1 -left-0",children:[" ",e.jsx(ws,{size:18,color:"orange"})," "]}),e.jsx("span",{className:"absolute w-0.5 h-full bg-blue-500 top-0 right-0"})]})):e.jsx("div",{children:"No Achievement found"})]})]})]})]})})},bt=()=>{var ze,Re;const[a,r]=c.useState(!1),[l,t]=c.useState(!1),[m,p]=c.useState([]),[g,f]=c.useState([]),[u,F]=c.useState(!1),[z,D]=c.useState(!1),[y,R]=c.useState(!1),[v,k]=c.useState(null),[j,b]=c.useState(null),[M,S]=c.useState(null),{handleImage:G}=Cs(),Q=ls(),{department:E,branch:w,employee:A,profile:ae}=ds(s=>s.user),[h,P]=c.useState({userid:"",pass:""}),[x,U]=c.useState({searchText:"",branch:"all",department:"all"}),_="https://res.cloudinary.com/dusxlxlvm/image/upload/v1753113610/ems/assets/employee_fi3g5p.webp";c.useEffect(()=>{U(s=>({...s,department:"all"}))},[x.branch]);let J=cs();const q={employeeId:"",branchId:"",department:"",employeeName:"",email:"",username:"",designation:"",password:"",phone:"",address:"",gender:"male",bloodGroup:"",dob:"",Emergencyphone:"",skills:[],maritalStatus:!0,salary:0,achievements:[],education:[]},[i,I]=c.useState(q);c.useEffect(()=>{E.length>0&&f(E.filter(s=>s.branchId._id==x.branch))},[x.branch]);const X=(s,n,o,W)=>{const O=[...i[n]];O[o][W]=s.target.value,I(ee=>({...ee,[n]:O}))},me=s=>{const n=s==="achievements"?{title:"",description:"",date:""}:{degree:"",institution:"",date:""};I(o=>({...o,[s]:[...o[s],n]}))},pe=(s,n)=>{const o=i[s].filter((W,O)=>O!==n);I(W=>({...W,[s]:o}))},Ne=Ae("employee",2),xe=Ae("employee",3),Ce=Ae("employee",4);c.useEffect(()=>{if((A==null?void 0:A.length)<1)return;let s=1;const n=A==null?void 0:A.map(o=>({id:o._id,sno:s++,rawname:o.userid.name,name:e.jsxs("div",{className:"flex items-center capitalize gap-3 ",children:[e.jsx(We,{src:o.profileimage||_,alt:o.employeename,children:!o.profileimage&&_}),e.jsx(H,{children:e.jsx(de,{variant:"body2",children:o.userid.name})})]}),email:o.userid.email,branch:o.branchId,department:o.department.department,departmentid:o.department._id,action:e.jsxs("div",{className:"action flex gap-2.5",children:[e.jsx("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"View Profile",onClick:()=>{S(o._id),F(!0)},children:e.jsx(gs,{})}),e.jsx("span",{className:"eye edit text-[18px] text-amber-500 cursor-pointer",title:"Attandence Report",onClick:()=>J(`/dashboard/performance/${o.userid._id}`),children:e.jsx(js,{})}),xe&&e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>Xe(o),children:e.jsx(Be,{})}),xe&&e.jsxs("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"Reset Password",onClick:()=>{P({...h,userid:o.userid._id}),D(!0)},children:[e.jsx(us,{})," "]}),Ce&&e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>Ke(o._id),children:e.jsx(Ns,{})})]})}));p(n)},[A]);const C=(s,n)=>{I({...i,[n]:s.target.value})},d=(s,n)=>{U(o=>({...o,[s]:n}))},T=s=>{const n=s.target.files[0];if(b(n),n){const o=new FileReader;o.onloadend=()=>{k(o.result)},o.readAsDataURL(n)}else k(null)},$=async s=>{s.preventDefault();const n=new FormData;if(n.append("employeeName",i.employeeName),n.append("branchId",i.branchId),n.append("department",i.department),n.append("username",i.username),n.append("email",i.email),n.append("password",i.password),n.append("designation",i.designation),n.append("salary",i.salary),j){let o=await G(300,j);n.append("photo",o)}await Qs({formData:n,dispatch:Q,setisload:t,setInp:I,setopenmodal:r,init:q,resetPhoto:L})},Z=async()=>{const s=new FormData;if(Object.keys(i).forEach(n=>{const o=i[n];Array.isArray(o)||typeof o=="object"?s.append(n,JSON.stringify(o)):s.append(n,o)}),j){let n=await G(300,j);s.append("photo",n)}await Js({formData:s,dispatch:Q,setisload:t,setEmployeePhoto:b,setInp:I,setopenmodal:r,init:q,resetPhoto:L})},L=()=>{k(null),b(null)},he=async s=>{s.preventDefault();try{const n=localStorage.getItem("emstoken"),o=await ue.post("/api/updatepassword",{pass:h},{headers:{Authorization:`Bearer ${n}`}});P({userid:"",pass:""}),D(!1),console.log("Query:",o),Y.success(o.data.message,{autoClose:1200})}catch(n){console.log(n),n.response?Y.warn(n.response.data.message,{autoClose:1200}):n.request?console.error("No response from server:",n.request):console.error("Error:",n.message)}},Xe=s=>{var n,o,W;R(!0),I({employeeId:s._id,branchId:s.branchId,department:s.department._id,employeeName:(n=s==null?void 0:s.userid)==null?void 0:n.name,email:(o=s==null?void 0:s.userid)==null?void 0:o.email,username:(W=s==null?void 0:s.userid)==null?void 0:W.name,dob:s==null?void 0:s.dob,salary:s==null?void 0:s.salary,designation:s==null?void 0:s.designation,phone:s==null?void 0:s.phone,address:(s==null?void 0:s.address)||"",gender:(s==null?void 0:s.gender)||"male",bloodGroup:s==null?void 0:s.bloodGroup,Emergencyphone:s==null?void 0:s.Emergencyphone,skills:s==null?void 0:s.skills,maritalStatus:(s==null?void 0:s.maritalStatus)||!0,achievements:s==null?void 0:s.achievements,education:s==null?void 0:s.education}),s.profileimage&&k(s.profileimage),r(!0)},Ke=s=>{ms({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{n&&Xs({employeeId:s,setisload:t})})},De=c.useRef(null),Pe=m==null?void 0:m.filter(s=>{var ge;const n=((ge=s.rawname)==null?void 0:ge.toLowerCase())||"",o=s.departmentid||"",W=s.branch||"",O=x.searchText.trim()===""||n.includes(x.searchText.toLowerCase()),ee=x.department==="all"||o===x.department,se=x.branch==="all"||W===x.branch;return O&&ee&&se}),Ze=()=>{const s=["S.No","Name","Email","Department"],n=Pe.map((se,ge)=>[ge+1,se.rawname,se.email,se.department]),o=[s,...n].map(se=>se.join(",")).join(`
`),W=new Blob([o],{type:"text/csv"}),O=URL.createObjectURL(W),ee=document.createElement("a");ee.href=O,ee.download="Employee List.csv",ee.click(),URL.revokeObjectURL(O)};return e.jsxs("div",{className:"employee p-1",children:[e.jsxs("div",{className:"flex gap-5 justify-between items-center flex-wrap",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-1 w-full md:w-fit",children:[e.jsx(N,{size:"small",className:"md:col-span-1 md:max-w-[160px] col-span-2",value:x.searchText,onChange:s=>d("searchText",s.target.value),InputProps:{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(fs,{})})},label:"Search Employee"}),e.jsxs(ne,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(re,{children:"Branch"}),e.jsxs(oe,{label:"Branch",value:x.branch,input:e.jsx(Oe,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(Ge,{fontSize:"small"})}),label:"Branch"}),onChange:s=>d("branch",s.target.value),children:[e.jsx(B,{value:"all",children:"All"}),w==null?void 0:w.map(s=>e.jsx(B,{value:s._id,children:s.name},s._id))]})]}),e.jsxs(ne,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(re,{children:"Department"}),e.jsxs(oe,{label:"Department",disabled:x.branch==="all",value:x.department,input:e.jsx(Oe,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(Ge,{fontSize:"small"})}),label:"Department"}),onChange:s=>d("department",s.target.value),children:[e.jsx(B,{value:"all",children:"All"}),g.length>0?g.map(s=>e.jsx(B,{value:s._id,children:s.department},s._id)):e.jsx(B,{disabled:!0,children:"No departments found"})]})]})]}),e.jsxs("div",{className:"flex gap-1 w-full md:w-fit",children:[e.jsx(K,{variant:"outlined",className:"flex-1 md:w-fit md:flex-none",onClick:Ze,startIcon:e.jsx(ps,{}),children:"Export"}),Ne&&e.jsx(K,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:e.jsx(xs,{}),onClick:()=>r(!0),children:"Add Employee"})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(hs,{columns:Vs,data:Pe,pagination:!0,customStyles:ys(),highlightOnHover:!0})}),e.jsx(Se,{open:a,onClose:()=>{r(!1),R(!1),I(q),L()},children:e.jsx("div",{className:"membermodal",children:e.jsxs("div",{className:"whole",children:[e.jsx("div",{className:"modalhead",children:y?"Update Employee":"Add Employee"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsxs(ne,{fullWidth:!0,required:!0,size:"small",children:[e.jsx(re,{children:"Branch"}),e.jsx(oe,{value:i.branchId,label:"branch",onChange:s=>C(s,"branchId"),children:w==null?void 0:w.map(s=>e.jsx(B,{value:s._id,children:s.name},s._id))})]}),e.jsxs(ne,{disabled:!i.branchId,fullWidth:!0,required:!0,size:"small",children:[e.jsx(re,{children:"Department"}),e.jsx(oe,{value:i.department,label:"Department",onChange:s=>C(s,"department"),children:(E==null?void 0:E.filter(s=>s.branchId._id===i.branchId).length)>0?E.filter(s=>s.branchId._id===i.branchId).map(s=>e.jsx(B,{value:s._id,children:s.department},s._id)):e.jsx(B,{disabled:!0,children:"No departments found"})})]}),e.jsxs(H,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:i.employeeName,onChange:s=>C(s,"employeeName"),label:"Name",size:"small"}),e.jsx(N,{fullWidth:!0,required:!0,value:i.email,onChange:s=>C(s,"email"),label:"email",size:"small"})]}),e.jsxs(H,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:i.username,onChange:s=>C(s,"username"),label:"username",size:"small"}),e.jsx(N,{fullWidth:!0,disabled:y,value:i.password,onChange:s=>C(s,"password"),label:"password",size:"small"})]}),e.jsx(H,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,value:i.designation,onChange:s=>C(s,"designation"),label:"Designation",size:"small"})}),e.jsx(H,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,value:i.salary,onChange:s=>C(s,"salary"),label:"salary",size:"small"})}),e.jsxs("div",{className:"mt-1 gap-2 flex items-center relative",children:[e.jsx("input",{style:{display:"none"},type:"file",onChange:T,ref:De,accept:"image/*",name:"",id:"fileInput"}),v?e.jsx("img",{src:v,alt:"Preview",className:"mt-2 w-[100px] h-[100px] rounded-full object-cover"}):e.jsx(We,{sx:{width:100,height:100},alt:i.employeeName,src:"/static/images/avatar/1.jpg"}),e.jsx("span",{onClick:()=>De.current.click(),className:"absolute -bottom-1 -right-1 rounded-full bg-teal-900 text-white p-1",children:e.jsx(Be,{size:18})})]}),y&&e.jsxs(He,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Ve,{expandIcon:e.jsx(Ue,{}),children:e.jsx(de,{variant:"subtitle1",children:"Personal Details (optional)"})}),e.jsx(Ye,{children:e.jsxs(H,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsx(N,{fullWidth:!0,value:i.phone,onChange:s=>C(s,"phone"),label:"Phone",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.Emergencyphone,onChange:s=>C(s,"Emergencyphone"),label:"Emergencyphone",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.address,onChange:s=>C(s,"address"),label:"Address",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.bloodGroup,onChange:s=>C(s,"bloodGroup"),label:"Blood Group",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.dob,type:"date",onChange:s=>C(s,"dob"),label:"Date of Birth",size:"small"}),e.jsxs(ne,{size:"small",children:[e.jsx(re,{children:"maritalStatus"}),e.jsxs(oe,{label:"maritalStatus",value:i.maritalStatus,onChange:s=>C(s,"maritalStatus"),children:[e.jsx(B,{selected:!0,value:!0,children:"Married"}),e.jsx(B,{selected:!0,value:!1,children:"Unmarried"})]})]}),e.jsxs(ne,{size:"small",children:[e.jsx(re,{children:"Gender"}),e.jsxs(oe,{label:"Gender",value:i.gender,onChange:s=>C(s,"gender"),children:[e.jsx(B,{selected:!0,value:"male",children:"Male"}),e.jsx(B,{selected:!0,value:"female",children:"female"})]})]})]})})]}),y&&e.jsxs(He,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Ve,{expandIcon:e.jsx(Ue,{}),children:e.jsx(de,{variant:"subtitle1",children:"Document & Skills (optional)"})}),e.jsxs(Ye,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(H,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2}}),e.jsx(de,{fontWeight:"bold",children:"Achievements"}),(ze=i==null?void 0:i.achievements)==null?void 0:ze.map((s,n)=>e.jsxs(H,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Title",size:"small",value:s.title,onChange:o=>X(o,"achievements",n,"title")}),e.jsx(N,{label:"Description",size:"small",value:s.description,onChange:o=>X(o,"achievements",n,"description")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:o=>X(o,"achievements",n,"date")}),e.jsx(_e,{size:24,title:"Delete this",onClick:()=>pe("achievements",n)})]},n)),e.jsx(K,{onClick:()=>me("achievements"),variant:"outlined",children:"Add Achievement"}),e.jsx(de,{fontWeight:"bold",children:"Education"}),(Re=i==null?void 0:i.education)==null?void 0:Re.map((s,n)=>e.jsxs(H,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Degree",size:"small",value:s.degree,onChange:o=>X(o,"education",n,"degree")}),e.jsx(N,{label:"Institution",size:"small",value:s.institution,onChange:o=>X(o,"education",n,"institution")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:o=>X(o,"education",n,"date")}),e.jsx(_e,{size:24,title:"Delete this",onClick:()=>pe("education",n)})]},n)),e.jsx(K,{onClick:()=>me("education"),variant:"outlined",children:"Add Education"})]})]})]}),e.jsxs("div",{className:"modalfooter",children:[e.jsx(K,{size:"small",onClick:()=>{r(!1),R(!1),I(q),L()},variant:"outlined",children:"Cancel"}),y?e.jsx(K,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(qe,{}),variant:"contained",onClick:Z,children:"Update"}):e.jsx(K,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(qe,{}),variant:"contained",onClick:$,children:"Add"})]})]})})}),e.jsx(Se,{open:u,onClose:()=>{F(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsx(Ks,{viewEmployee:M})})}),e.jsx(Se,{open:z,onClose:()=>{D(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:he,children:[e.jsx("h2",{children:"Reset Passowrd"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsx(N,{fullWidth:!0,required:!0,value:h.pass,onChange:s=>P({...h,pass:s.target.value}),label:"Passowrd",size:"small"}),e.jsx(K,{variant:"contained",sx:{mr:2},type:"submit",children:"Reset Password"})]})]})})})]})};export{bt as default};
