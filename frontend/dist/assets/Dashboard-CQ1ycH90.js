import{r as i,c as p,y as l,j as a,B as d,a9 as U,aa as O,h as P,ab as S,b as m,bS as F,a1 as R}from"./index-ChGZyta4.js";import{u as Y}from"./attandencehelper-CDWGpmoQ.js";import{a as _}from"./index-D8sZrzPT.js";import{A as G}from"./index-DNOwe0Kw.js";const ee=()=>{i.useEffect(()=>{j()},[]);const C={userid:"",name:"",email:"",password:""},[k,D]=i.useState([]),[A,u]=i.useState(!1),[r,h]=i.useState(C),[w,b]=i.useState(!1),[y,N]=i.useState(!1),[E,f]=i.useState(!1),[c,g]=i.useState({companyId:"",name:"",email:"",password:""}),[H,T]=i.useState(!1),[X,J]=i.useState([]),j=async()=>{var e,o;try{const t=localStorage.getItem("emstoken"),s=await p.get("/api/developerfetch",{headers:{Authorization:`Bearer ${t}`}});D(s.data.users)}catch(t){console.log(t),l.warn(((o=(e=t.response)==null?void 0:e.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}},$=async e=>{var o,t;e.preventDefault();try{const s=localStorage.getItem("emstoken"),n=await p.post("/api/User",{...r},{headers:{Authorization:`Bearer ${s}`}});u(!1),j(),l.success(n.data.message,{autoClose:1800})}catch(s){console.log(s),l.warn(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}finally{}},I=e=>{h({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),b(!0),u(!0)},M=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async o=>{var t,s;if(o)try{const n=localStorage.getItem("emstoken"),x=await p.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${n}`}});j(),l.success(x.data.message,{autoClose:1800})}catch(n){console.log(n),l.warn(((s=(t=n.response)==null?void 0:t.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}})},z=async()=>{var e,o;try{const t=localStorage.getItem("emstoken"),s=await p.put(`/api/User/${r.userid}`,{name:r.name,email:r.email},{headers:{Authorization:`Bearer ${t}`}});u(!1),j(),l.success(s.data.message,{autoClose:1800})}catch(t){console.log(t),l.warn(((o=(e=t.response)==null?void 0:e.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}},v=async e=>{swal({title:`Are you sure you want to Deploy ${e}?`,icon:"warning",buttons:!0,dangerMode:!0}).then(async o=>{var t,s;if(o){N(!0);const n=l.loading(`Deploying ${e}...`);try{const x=localStorage.getItem("emstoken"),L=await p.get(`/api/deploy/${e}`,{headers:{Authorization:`Bearer ${x}`}});l.update(n,{render:L.data.message,type:"success",isLoading:!1,autoClose:1800})}catch(x){l.update(n,{render:((s=(t=x.response)==null?void 0:t.data)==null?void 0:s.message)||"Error during deployment",type:"error",isLoading:!1,autoClose:3e3}),console.log(x)}finally{N(!1)}}})},B=()=>{u(!1),h(C),b(!1)},W=e=>{g({companyId:e==null?void 0:e.companyId,email:"",password:""}),f(!0)},q=[{name:"S.No",selector:(e,o)=>o+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??""},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>P(e.createdAt).format("DD MMM, YY")},{name:"Status",selector:e=>e.stat||"-",width:"130px"},{name:"Action",width:"100px",cell:e=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>W(e),children:a.jsx(F,{})}),a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>I(e),children:a.jsx(R,{})}),a.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>M(e._id),children:a.jsx(G,{})})]})}];return a.jsxs("div",{children:[a.jsxs("div",{className:"my-1 flex justify-end gap-2",children:[a.jsx(d,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:y,onClick:()=>v("accusoft"),children:"Accusoft"}),a.jsx(d,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:y,onClick:()=>v("battlefiesta"),children:"battlefiesta"}),a.jsx(d,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:y,onClick:()=>v("office"),children:"office"}),a.jsx(d,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:a.jsx(U,{}),onClick:()=>u(!0),children:"Add User"})]}),a.jsx(O,{columns:q,data:k,pagination:!0,customStyles:Y(),highlightOnHover:!0,noDataComponent:a.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[a.jsx(_,{className:"text-xl"})," No records found matching your criteria."]})}),a.jsx(S,{open:A,onClose:()=>{u(!1)},children:a.jsx("div",{className:"membermodal w-[500px]",children:a.jsxs("form",{onSubmit:$,children:[a.jsx("h2",{children:"Add New User"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[a.jsx(m,{fullWidth:!0,required:!0,value:r.name,onChange:e=>h({...r,name:e.target.value}),label:"Name",size:"small"}),a.jsx(m,{fullWidth:!0,required:!0,type:"email",value:r.email,onChange:e=>h({...r,email:e.target.value}),label:"Email",size:"small"}),!w&&a.jsx(m,{fullWidth:!0,required:!0,type:"password",value:r.password,onChange:e=>h({...r,password:e.target.value}),label:"Passowrd",size:"small"}),a.jsxs("div",{children:[w?a.jsx(d,{variant:"contained",sx:{mr:2},onClick:z,children:"Save"}):a.jsx(d,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),a.jsx(d,{variant:"outlined",onClick:B,sx:{mr:2},children:"Cancel"})]})]})})]})})}),a.jsx(S,{open:E,onClose:()=>f(!1),children:a.jsx("div",{className:"membermodal w-[400px]",children:a.jsxs("form",{onSubmit:async e=>{var o,t;e.preventDefault();try{const s=localStorage.getItem("emstoken"),n=await p.post("/api/demo",c,{headers:{Authorization:`Bearer ${s}`}});l.success(n.data.message,{autoClose:2e3}),f(!1)}catch(s){l.error(((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)||"Error creating demo",{autoClose:2e3})}},children:[a.jsx("h2",{children:"Create Demo Account"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 mt-3",children:[a.jsx(m,{fullWidth:!0,label:"Company ID",value:c.companyId,disabled:!0,size:"small"}),a.jsx(m,{fullWidth:!0,required:!0,variant:"standard",label:"Name",value:c.name,onChange:e=>g({...c,name:e.target.value}),size:"small"}),a.jsx(m,{fullWidth:!0,required:!0,variant:"standard",label:"Demo Email",value:c.email,onChange:e=>g({...c,email:e.target.value}),size:"small"}),a.jsx(m,{fullWidth:!0,required:!0,variant:"standard",type:"password",label:"Password",value:c.password,onChange:e=>g({...c,password:e.target.value}),size:"small"}),a.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[a.jsx(d,{variant:"outlined",onClick:()=>f(!1),children:"Cancel"}),a.jsx(d,{variant:"contained",type:"submit",children:"Create"})]})]})})]})})})]})};export{ee as default};
