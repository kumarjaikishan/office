import{j as e,b as E,y as b,r as m,I as $,A as O,F as P}from"./index-CTh4XINP.js";import{d as x}from"./dayjs.min-D-96h9Fd.js";import{X as _}from"./index.es-DqB4JCGQ.js";import{A as L}from"./index-D8LLMcYn.js";import{M as U}from"./Modalbox-CNzqGYqV.js";import{I as X}from"./index-YZVVm7Xt.js";import{B as M}from"./Box-0AwRt24s.js";import{T as d}from"./TextField-DZ2WNkho.js";import{F as q,I as H,S as G}from"./Select-CrBcKFAw.js";import{M as y}from"./MenuItem-Cy-BF1ws.js";import{B as A}from"./Button-Gf5sSqIk.js";import{c as J}from"./attandencehelper-B7qcYoQE.js";import{C as N}from"./CheckPermission-C26bx95A.js";import{T as k}from"./Typography-22Vbjyg4.js";import"./useSlotProps-DkXkGTp2.js";import"./createSimplePaletteValueFilter-B4rI7VpO.js";import"./ButtonBase-DRT54j5u.js";const K=({inp:t,openmodal:h,isload:f,handleChange:l,setopenmodal:i,setInp:c,init:n})=>{const p=async o=>{o.preventDefault(),console.log(t);const j=localStorage.getItem("emstoken");try{const r=await E.post("/api/leavehandle",{...t},{headers:{Authorization:`Bearer ${j}`}});i(!1),c(n),b.success(r.data.message,{autoClose:2e3})}catch(r){r.response&&b.warning(r.response.data.message,{autoClose:3e3}),console.error(r)}};return e.jsx(U,{open:h,onClose:()=>{i(!1),c(n)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:p,children:[e.jsx("h2",{children:"Leave Management"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsxs(M,{sx:{width:"100%",gap:2},children:[e.jsx(d,{fullWidth:!0,value:t.department,label:"Department",size:"small"}),e.jsx(d,{fullWidth:!0,value:t.employeename,label:"Name",size:"small"})]}),e.jsxs(M,{sx:{width:"100%",gap:2},children:[e.jsx(d,{fullWidth:!0,value:t.from,label:"From",size:"small"}),e.jsx(d,{fullWidth:!0,value:t.to,label:"To",size:"small"})]}),e.jsx(d,{fullWidth:!0,multiline:!0,minRows:2,value:t.reason,onChange:o=>l(o,"reason"),label:"Reason",size:"small"}),e.jsxs(q,{fullWidth:!0,required:!0,size:"small",children:[e.jsx(H,{children:"Status"}),e.jsxs(G,{value:t.status,label:"Status",onChange:o=>l(o,"status"),children:[e.jsx(y,{value:"pending",children:"Pending"}),e.jsx(y,{value:"approved",children:"Approve"}),e.jsx(y,{value:"rejected",children:"Reject"})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx(A,{sx:{mr:2},loading:f,loadingPosition:"end",endIcon:e.jsx(X,{}),variant:"contained",type:"submit",children:"Update"}),e.jsx(A,{size:"small",onClick:()=>{i(!1),c(n)},variant:"outlined",children:"Cancel"})]})]})]})})})},he=()=>{const[t,h]=m.useState([]),[f,l]=m.useState(!1),[i,c]=m.useState(!1),n={leaveid:"",department:"",employeename:"",from:"",to:"",reason:"",status:""},[p,o]=m.useState(n),j=N("leave",3),r=N("leave",4);m.useEffect(()=>{(async()=>{var v,D;const g=localStorage.getItem("emstoken");try{const u=await E.get("/api/fetchleave",{headers:{Authorization:`Bearer ${g}`}});let W=1;const T=await u.data.leave.map(s=>{var I,Y,S,w,C,z;return{id:s._id,sno:W++,name:e.jsxs("div",{className:"flex items-center gap-3 ",children:[e.jsx(O,{src:(I=s==null?void 0:s.employeeId)==null?void 0:I.profileimage,alt:(Y=s==null?void 0:s.employeeId)==null?void 0:Y.employeename,children:!((S=s.employeeId)!=null&&S.profileimage)&&e.jsx(P,{})}),e.jsxs(M,{children:[e.jsx(k,{variant:"body2",children:(w=s.employeeId)==null?void 0:w.employeename}),e.jsx(k,{variant:"body2",children:(z=(C=s.employeeId)==null?void 0:C.userid)==null?void 0:z.email})]})]}),from:x(s.fromDate).format("DD MMM, YYYY"),to:x(s.toDate).format("DD MMM, YYYY"),reason:s.reason,status:e.jsx("span",{className:`${s.status=="approved"?"bg-green-100 text-green-800":s.status=="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"} px-3 py-1 rounded capitalize`,children:s.status}),action:e.jsxs("div",{className:"flex gap-2",children:[j&&e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>R(s),children:e.jsx($,{})}),r&&e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>F(s._id),children:e.jsx(L,{})})]})}});h(T)}catch(u){console.error(u),b.warning(((D=(v=u.response)==null?void 0:v.data)==null?void 0:D.message)||"Error")}})()},[]);const B=(a,g)=>{o({...p,[g]:a.target.value})},F=()=>{},R=a=>{console.log(a),o({leaveid:a._id,department:a.employeeId.userid.email,employeename:a.employeeId.employeename,from:x(a.fromDate).format("DD MMM, YYYY"),to:x(a.toDate).format("DD MMM, YYYY"),reason:a.reason,status:a.status}),l(!0)};return e.jsxs("div",{children:[e.jsx(_,{customStyles:J,columns:Q,data:t,pagination:!0,highlightOnHover:!0}),e.jsx(K,{handleChange:B,inp:p,isload:i,init:n,setInp:o,openmodal:f,setopenmodal:l})]})},Q=[{name:"S.no",selector:t=>t.sno,width:"60px"},{name:"Employee",selector:t=>t.name},{name:"from",selector:t=>t.from,width:"120px"},{name:"to",selector:t=>t.to,width:"120px"},{name:"Reason",selector:t=>t.reason},{name:"Status",selector:t=>t.status,width:"120px"},{name:"Action",selector:t=>t.action,width:"90px"}];export{Q as columns,he as default};
