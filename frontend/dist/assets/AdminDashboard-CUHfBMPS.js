import{f as b,r,a as z,u as P,g as d,j as e,C as N,A as R,F as k}from"./index-Bn9gE8Df.js";import{D as B}from"./dashboardCard-DeubH6jP.js";import{F as v,I,S as y,O as S}from"./Select-D5eREMyP.js";import{M as c}from"./MenuItem-BRVOW9ge.js";import{I as _}from"./InputAdornment-CoDl8mN7.js";import{T as M}from"./Tooltip-DyHQFUab.js";import"./createSimplePaletteValueFilter-B5ZCTa1T.js";import"./useSlotProps-D4oRlUF-.js";import"./ButtonBase-CwA52pCW.js";import"./Typography-C2AV8jVe.js";import"./Popper-D8G-Tp4V.js";const X=()=>{var g;const{attandence:a,employee:o,branch:i,department:p}=b(t=>t.user),{islogin:A,isadmin:q}=b(t=>t.auth),[h,w]=r.useState([]),[f,E]=r.useState([]);let D=z();P();const F=r.useRef(a),[l,C]=r.useState("all"),[m,j]=r.useState("all"),[u,O]=r.useState([]);return r.useEffect(()=>{!A&&D("/login")},[]),r.useEffect(()=>{if(!o||o.length===0)return;const t=o.filter(n=>{const s=l==="all"||n.branchId===l,x=m==="all"||n.department._id===m;return s&&x});O(t)},[l,m,o]),r.useEffect(()=>{j("all")},[l]),r.useEffect(()=>{F.current=a},[a]),r.useEffect(()=>{if(!a)return;let t=a.filter(s=>d(s.date).isSame(d(),"day")&&!s.punchOut),n=a.filter(s=>d(s.date).isSame(d(),"day"));w(t),E(n)},[a]),r.useEffect(()=>()=>{},[]),e.jsxs("div",{className:"p-0  md:p-3",children:[e.jsx("div",{className:"mb-3 ",children:e.jsx(B,{employee:o,todaypresent:f.length,currentpresent:h.length})}),e.jsxs("div",{className:"w-full flex-col flex gap-5 shadow  bg-white p-2 rounded",children:[e.jsxs("div",{className:"flex gap-3 pt-3",children:[e.jsxs(v,{sx:{width:"160px"},required:!0,size:"small",children:[e.jsx(I,{id:"demo-simple-select-helper-label",children:"Branch"}),e.jsxs(y,{value:l,input:e.jsx(S,{startAdornment:e.jsx(_,{position:"start",children:e.jsx(N,{fontSize:"small"})}),label:"branch"}),onChange:t=>C(t.target.value),children:[e.jsx(c,{selected:!0,value:"all",children:"All"}),(i==null?void 0:i.length)>1?i==null?void 0:i.map(t=>e.jsx(c,{value:t._id,children:t.name},t._id)):e.jsx(c,{disabled:!0,value:"",children:"No Branch Found"})]})]}),e.jsxs(v,{sx:{width:"160px"},required:!0,size:"small",children:[e.jsx(I,{id:"demo-simple-select-helper-label",children:"Department"}),e.jsxs(y,{disabled:l=="all",value:m,input:e.jsx(S,{startAdornment:e.jsx(_,{position:"start",children:e.jsx(N,{fontSize:"small"})}),label:"Department"}),onChange:t=>j(t.target.value),children:[e.jsx(c,{selected:!0,value:"all",children:"All"}),(p==null?void 0:p.length)>1?(g=p.filter(t=>t.branchId._id==l))==null?void 0:g.map(t=>e.jsx(c,{value:t._id,children:t.department},t._id)):e.jsx(c,{disabled:!0,value:"",children:"No Department Found"})]})]})]}),e.jsx("div",{className:"px-1 md:px-3 grid grid-cols-5 md:grid-cols-10 lg:grid-cols-13 gap-2 md:gap-4",children:u==null?void 0:u.map(t=>{const n=h.some(x=>x.employeeId._id===t._id),s=f.find(x=>x.employeeId._id===t._id);return e.jsx(M,{arrow:!0,enterDelay:800,placement:"top",title:e.jsxs("div",{className:"flex flex-col ",children:[e.jsxs("span",{children:[" In       ",s!=null&&s.punchIn?d(s.punchIn).format("hh:mm A"):" -:-"]}),e.jsxs("span",{children:[" Out    ",s!=null&&s.punchOut?d(s.punchOut).format("hh:mm A"):"-:-"]})]}),children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`${s?n?"border-green-500":"border-amber-400":"border-gray-300"} p-[2px] border-3 rounded-full`,children:e.jsx(R,{src:t.profileimage,alt:t.employeename,children:!t.profileimage&&e.jsx(k,{})})}),e.jsx("p",{className:`${s?n?"text-green-600 text-[14px]":"text-amber-700":"text-gray-500"} text-[12px] text-center transition-all duration-300 capitalize `,children:t.userid.name})]},t._id)},t._id)})}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-500 text-[13px] ",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-green-500 "})," In Premise"]}),e.jsxs("span",{className:"flex items-center gap-1 text-amber-700 text-[13px]",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-amber-500 "})," Present"]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-500 text-[13px]",children:[e.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-gray-500  "})," Absent"]})]})]})]})};export{X as default};
