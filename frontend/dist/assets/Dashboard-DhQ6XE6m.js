import{r as m,c as x,y as r,j as a,B as i,a9 as z,aa as B,h as I,ab as U,b as h,a1 as O}from"./index-C35MsjE7.js";import{u as q}from"./attandencehelper-DQxgSfnb.js";import{a as W}from"./index-DTEpo6Cf.js";import{A as L}from"./index-zmt7Lw9T.js";const F=()=>{m.useEffect(()=>{p()},[]);const y={userid:"",name:"",email:"",password:""},[C,N]=m.useState([]),[k,c]=m.useState(!1),[n,u]=m.useState(y),[j,v]=m.useState(!1),[f,w]=m.useState(!1),p=async()=>{var e,s;try{const t=localStorage.getItem("emstoken"),o=await x.get("/api/developerfetch",{headers:{Authorization:`Bearer ${t}`}});N(o.data.users)}catch(t){console.log(t),r.warn(((s=(e=t.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},b=async e=>{var s,t;e.preventDefault();try{const o=localStorage.getItem("emstoken"),l=await x.post("/api/User",{...n},{headers:{Authorization:`Bearer ${o}`}});c(!1),p(),r.success(l.data.message,{autoClose:1800})}catch(o){console.log(o),r.warn(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}finally{}},S=e=>{u({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),v(!0),c(!0)},A=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{var t,o;if(s)try{const l=localStorage.getItem("emstoken"),d=await x.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${l}`}});p(),r.success(d.data.message,{autoClose:1800})}catch(l){console.log(l),r.warn(((o=(t=l.response)==null?void 0:t.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}})},$=async()=>{var e,s;try{const t=localStorage.getItem("emstoken"),o=await x.put(`/api/User/${n.userid}`,{name:n.name,email:n.email},{headers:{Authorization:`Bearer ${t}`}});c(!1),p(),r.success(o.data.message,{autoClose:1800})}catch(t){console.log(t),r.warn(((s=(e=t.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},g=async e=>{swal({title:`Are you sure you want to Deploy ${e}?`,icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{var t,o;if(s){w(!0);const l=r.loading(`Deploying ${e}...`);try{const d=localStorage.getItem("emstoken"),M=await x.get(`/api/deploy/${e}`,{headers:{Authorization:`Bearer ${d}`}});r.update(l,{render:M.data.message,type:"success",isLoading:!1,autoClose:1800})}catch(d){r.update(l,{render:((o=(t=d.response)==null?void 0:t.data)==null?void 0:o.message)||"Error during deployment",type:"error",isLoading:!1,autoClose:3e3}),console.log(d)}finally{w(!1)}}})},E=()=>{c(!1),u(y),v(!1)},D=[{name:"S.No",selector:(e,s)=>s+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??""},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>I(e.createdAt).format("DD MMM, YY")},{name:"Status",selector:e=>e.stat||"-",width:"130px"},{name:"Action",width:"100px",cell:e=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>S(e),children:a.jsx(O,{})}),a.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>A(e._id),children:a.jsx(L,{})})]})}];return a.jsxs("div",{children:[a.jsxs("div",{className:"my-1 flex justify-end gap-2",children:[a.jsx(i,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:f,onClick:()=>g("accusoft"),children:"Accusoft"}),a.jsx(i,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:f,onClick:()=>g("battlefiesta"),children:"battlefiesta"}),a.jsx(i,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:f,onClick:()=>g("office"),children:"office"}),a.jsx(i,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:a.jsx(z,{}),onClick:()=>c(!0),children:"Add User"})]}),a.jsx(B,{columns:D,data:C,pagination:!0,customStyles:q(),highlightOnHover:!0,noDataComponent:a.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[a.jsx(W,{className:"text-xl"})," No records found matching your criteria."]})}),a.jsx(U,{open:k,onClose:()=>{c(!1)},children:a.jsx("div",{className:"membermodal w-[500px]",children:a.jsxs("form",{onSubmit:b,children:[a.jsx("h2",{children:"Add New User"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[a.jsx(h,{fullWidth:!0,required:!0,value:n.name,onChange:e=>u({...n,name:e.target.value}),label:"Name",size:"small"}),a.jsx(h,{fullWidth:!0,required:!0,type:"email",value:n.email,onChange:e=>u({...n,email:e.target.value}),label:"Email",size:"small"}),!j&&a.jsx(h,{fullWidth:!0,required:!0,type:"password",value:n.password,onChange:e=>u({...n,password:e.target.value}),label:"Passowrd",size:"small"}),a.jsxs("div",{children:[j?a.jsx(i,{variant:"contained",sx:{mr:2},onClick:$,children:"Save"}):a.jsx(i,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),a.jsx(i,{variant:"outlined",onClick:E,sx:{mr:2},children:"Cancel"})]})]})})]})})})]})};export{F as default};
