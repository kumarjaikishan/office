import{r as d,c as m,y as l,j as a,B as u,$,a0 as D,h as z,a1 as B,b as p,R as M}from"./index-C0uMPCF7.js";import{u as I}from"./attandencehelper-BZ1chyyJ.js";import{a as U}from"./index-DST0yz8C.js";import{A as O}from"./index-C0YYKqt5.js";const Y=()=>{d.useEffect(()=>{x()},[]);const h={userid:"",name:"",email:"",password:""},[j,y]=d.useState([]),[v,n]=d.useState(!1),[r,c]=d.useState(h),[g,f]=d.useState(!1),x=async()=>{var e,t;try{const s=localStorage.getItem("emstoken"),o=await m.get("/api/developerfetch",{headers:{Authorization:`Bearer ${s}`}});y(o.data.users)}catch(s){console.log(s),l.warn(((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}},w=async e=>{var t,s;e.preventDefault();try{const o=localStorage.getItem("emstoken"),i=await m.post("/api/User",{...r},{headers:{Authorization:`Bearer ${o}`}});n(!1),x(),l.success(i.data.message,{autoClose:1800})}catch(o){console.log(o),l.warn(((s=(t=o.response)==null?void 0:t.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}finally{}},C=e=>{c({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),f(!0),n(!0)},N=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async t=>{var s,o;if(t)try{const i=localStorage.getItem("emstoken"),E=await m.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${i}`}});x(),l.success(E.data.message,{autoClose:1800})}catch(i){console.log(i),l.warn(((o=(s=i.response)==null?void 0:s.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}})},k=async()=>{var e,t;try{const s=localStorage.getItem("emstoken"),o=await m.put(`/api/User/${r.userid}`,{name:r.name,email:r.email},{headers:{Authorization:`Bearer ${s}`}});n(!1),x(),l.success(o.data.message,{autoClose:1800})}catch(s){console.log(s),l.warn(((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}},S=async()=>{var e,t;console.log("hey");try{const s=localStorage.getItem("emstoken"),o=await m.get("/api/deploy",{headers:{Authorization:`Bearer ${s}`}});l.success(o.data.message,{autoClose:1800})}catch(s){console.log(s),l.warn(((t=(e=s.response)==null?void 0:e.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}},b=()=>{n(!1),c(h),f(!1)},A=[{name:"S.No",selector:(e,t)=>t+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??""},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>z(e.createdAt).format("DD MMM, YY")},{name:"Status",selector:e=>e.stat||"-",width:"130px"},{name:"Action",width:"100px",cell:e=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>C(e),children:a.jsx(M,{})}),a.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>N(e._id),children:a.jsx(O,{})})]})}];return a.jsxs("div",{children:[a.jsxs("div",{className:"my-1 flex justify-end gap-2",children:[a.jsx(u,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",onClick:S,children:"Deploy"}),a.jsx(u,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:a.jsx($,{}),onClick:()=>n(!0),children:"Add User"})]}),a.jsx(D,{columns:A,data:j,pagination:!0,customStyles:I(),highlightOnHover:!0,noDataComponent:a.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[a.jsx(U,{className:"text-xl"})," No records found matching your criteria."]})}),a.jsx(B,{open:v,onClose:()=>{n(!1)},children:a.jsx("div",{className:"membermodal w-[500px]",children:a.jsxs("form",{onSubmit:w,children:[a.jsx("h2",{children:"Add New User"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[a.jsx(p,{fullWidth:!0,required:!0,value:r.name,onChange:e=>c({...r,name:e.target.value}),label:"Name",size:"small"}),a.jsx(p,{fullWidth:!0,required:!0,type:"email",value:r.email,onChange:e=>c({...r,email:e.target.value}),label:"Email",size:"small"}),!g&&a.jsx(p,{fullWidth:!0,required:!0,type:"password",value:r.password,onChange:e=>c({...r,password:e.target.value}),label:"Passowrd",size:"small"}),a.jsxs("div",{children:[g?a.jsx(u,{variant:"contained",sx:{mr:2},onClick:k,children:"Save"}):a.jsx(u,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),a.jsx(u,{variant:"outlined",onClick:b,sx:{mr:2},children:"Cancel"})]})]})})]})})})]})};export{Y as default};
