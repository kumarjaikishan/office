import{g as v,r as a,a as P,u as R,h as d,j as s,F as y,I,S,M as c,O as _,i as A,C as w,A as B,k as M}from"./index-CXypEiKM.js";import{D as q}from"./dashboardCard-BkhIh8LH.js";import{T}from"./Tooltip-CXMDDoX7.js";import"./Popper-DzPY5B67.js";const J=()=>{var N;const{attandence:r,employee:x,branch:i,department:u}=v(e=>e.user),{islogin:E,isadmin:$}=v(e=>e.auth),[j,D]=a.useState([]),[g,C]=a.useState([]);let F=P();R();const O=a.useRef(r),[l,z]=a.useState("all"),[h,b]=a.useState("all"),[m,k]=a.useState([]);return a.useEffect(()=>{!E&&F("/login")},[]),a.useEffect(()=>{if(!x||x.length===0)return;const e=x.filter(n=>{const t=l==="all"||n.branchId===l,p=h==="all"||n.department._id===h;return t&&p});k(e)},[l,h,x]),a.useEffect(()=>{b("all")},[l]),a.useEffect(()=>{O.current=r},[r]),a.useEffect(()=>{if(!r)return;let e=r.filter(t=>d(t.date).isSame(d(),"day")&&!t.punchOut),n=r.filter(t=>d(t.date).isSame(d(),"day"));D(e),C(n)},[r]),a.useEffect(()=>()=>{},[]),s.jsxs("div",{className:"p-0  md:p-3",children:[s.jsx("div",{className:"mb-3 ",children:s.jsx(q,{employee:x,todaypresent:g.length,currentpresent:j.length})}),s.jsxs("div",{className:"w-full flex-col flex gap-5 shadow  bg-white p-2 rounded",children:[s.jsxs("div",{className:"flex gap-3 pt-3",children:[s.jsxs(y,{sx:{width:"160px"},required:!0,size:"small",children:[s.jsx(I,{id:"demo-simple-select-helper-label",children:"Branch"}),s.jsxs(S,{value:l,input:s.jsx(_,{startAdornment:s.jsx(A,{position:"start",children:s.jsx(w,{fontSize:"small"})}),label:"branch"}),onChange:e=>z(e.target.value),children:[s.jsx(c,{selected:!0,value:"all",children:"All"}),(i==null?void 0:i.length)>1?i==null?void 0:i.map(e=>s.jsx(c,{value:e._id,children:e.name},e._id)):s.jsx(c,{disabled:!0,value:"",children:"No Branch Found"})]})]}),s.jsxs(y,{sx:{width:"160px"},required:!0,size:"small",children:[s.jsx(I,{id:"demo-simple-select-helper-label",children:"Department"}),s.jsxs(S,{disabled:l=="all",value:h,input:s.jsx(_,{startAdornment:s.jsx(A,{position:"start",children:s.jsx(w,{fontSize:"small"})}),label:"Department"}),onChange:e=>b(e.target.value),children:[s.jsx(c,{selected:!0,value:"all",children:"All"}),(u==null?void 0:u.length)>1?(N=u.filter(e=>e.branchId._id==l))==null?void 0:N.map(e=>s.jsx(c,{value:e._id,children:e.department},e._id)):s.jsx(c,{disabled:!0,value:"",children:"No Department Found"})]})]})]}),s.jsx("div",{className:"px-1 md:px-3 grid grid-cols-5 md:grid-cols-10 lg:grid-cols-13 gap-2 md:gap-4",children:m==null?void 0:m.filter(e=>e.status!==!1).map(e=>{var p;const n=j.some(f=>{var o;return((o=f.employeeId)==null?void 0:o._id)===(e==null?void 0:e._id)}),t=g.find(f=>{var o;return((o=f.employeeId)==null?void 0:o._id)===(e==null?void 0:e._id)});return s.jsx(T,{arrow:!0,enterDelay:800,placement:"top",title:s.jsxs("div",{className:"flex flex-col ",children:[s.jsxs("span",{children:[" In       ",t!=null&&t.punchIn?d(t.punchIn).format("hh:mm A"):" -:-"]}),s.jsxs("span",{children:[" Out    ",t!=null&&t.punchOut?d(t.punchOut).format("hh:mm A"):"-:-"]})]}),children:s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:`${t?n?"border-green-500":"border-amber-400":"border-gray-300"} p-[2px] border-3 rounded-full`,children:s.jsx(B,{src:e==null?void 0:e.profileimage,alt:e.employeename,children:!e.profileimage&&s.jsx(M,{})})}),s.jsx("p",{className:`${t?n?"text-green-600 text-[14px]":"text-amber-700":"text-gray-500"} text-[12px] text-center transition-all duration-300 capitalize `,children:(p=e==null?void 0:e.userid)==null?void 0:p.name})]},e._id)},e._id)})}),s.jsxs("div",{className:"flex gap-5",children:[s.jsxs("span",{className:"flex items-center gap-1 text-green-500 text-[13px] ",children:[s.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-green-500 "})," In Premise"]}),s.jsxs("span",{className:"flex items-center gap-1 text-amber-700 text-[13px]",children:[s.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-amber-500 "})," Present"]}),s.jsxs("span",{className:"flex items-center gap-1 text-gray-500 text-[13px]",children:[s.jsx("span",{className:"block w-[15px] rounded-3xl h-[15px] bg-gray-500  "})," Absent"]})]})]})]})};export{J as default};
