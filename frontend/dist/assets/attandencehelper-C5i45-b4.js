import{bj as j,g as v,j as t,h as a,A,k as C,l as D,a3 as Y,aN as E,a1 as R,y,c as N,D as I}from"./index-CcdprHkT.js";import{A as B}from"./index-yKSfn35U.js";function z(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M435.9 64.9l-367.1 160c-6.5 3.1-6.3 12.4.3 15.3l99.3 56.1c5.9 3.3 13.2 2.6 18.3-1.8l195.8-168.8c1.3-1.1 4.4-3.2 5.6-2 1.3 1.3-.7 4.3-1.8 5.6L216.9 320.1c-4.7 5.3-5.4 13.1-1.6 19.1l64.9 104.1c3.2 6.3 12.3 6.2 15.2-.2L447.2 76c3.3-7.2-4.2-14.5-11.3-11.1z"},child:[]}]})(l)}function L(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M403.002 217.001C388.998 148.002 328.998 96 256 96c-57.998 0-107.998 32.998-132.998 81.001C63.002 183.002 16 233.998 16 296c0 65.996 53.999 120 120 120h260c55 0 100-45 100-100 0-52.998-40.996-96.001-92.998-98.999zM224 268v-76h64v76h68L256 368 156 268h68z"},child:[]}]})(l)}function O(l){return j({attr:{viewBox:"0 0 512 512"},child:[{tag:"g",attr:{fillOpacity:".9"},child:[{tag:"path",attr:{d:"M255.8 48C141 48 48 141.2 48 256s93 208 207.8 208c115 0 208.2-93.2 208.2-208S370.8 48 255.8 48zm.2 374.4c-91.9 0-166.4-74.5-166.4-166.4S164.1 89.6 256 89.6 422.4 164.1 422.4 256 347.9 422.4 256 422.4z"},child:[]},{tag:"path",attr:{d:"M266.4 152h-31.2v124.8l109.2 65.5 15.6-25.6-93.6-55.5V152z"},child:[]}]}]})(l)}const F=async({isPunchIn:l,inp:n,setisload:r,dispatch:i})=>{r(!1);const x={employeeId:n.employeeId,date:a(n.date).toDate()};n.status=="leave"&&(x.reason=n.reason);const c=l?{...x,...n.punchIn?{punchIn:a(n.punchIn).toDate()}:{},status:n.status}:{...x,...n.punchOut?{punchOut:a(n.punchOut).toDate()}:{}},g=l?"/api/checkin":"/api/checkout";try{const u=localStorage.getItem("emstoken"),e=await N.post(g,{...c},{headers:{Authorization:`Bearer ${u}`}});return y.success(e.data.message,{autoClose:1800}),i(I()),!0}catch(u){console.log(u),u.response?y.warn(u.response.data.message,{autoClose:3e3}):u.request?console.error("No response from server:",u.request):console.error("Error:",u.message)}finally{r(!1)}},T=async({attandanceId:l,setselectedRows:n,setisload:r,dispatch:i})=>{if(!l)return y.warning("Attandance Id is needed");const x="/api/deleteattandence";try{const c=localStorage.getItem("emstoken"),g=await N.post(x,{attandanceId:l},{headers:{Authorization:`Bearer ${c}`}});return y.success(g.data.message,{autoClose:1800}),i(I()),n([]),!0}catch(c){console.log(c),c.response?y.warn(c.response.data.message,{autoClose:2700}):c.request?console.error("No response from server:",c.request):console.error("Error:",c.message)}finally{r(!1)}};function M(l,n,r){var x,c,g;const i=n.find(u=>u._id===l.branchId&&u.defaultsetting===!1);return i?{attendanceRules:(x=i==null?void 0:i.setting)==null?void 0:x.attendanceRules,workingMinutes:(c=i==null?void 0:i.setting)==null?void 0:c.workingMinutes,weeklyOffs:(g=i==null?void 0:i.setting)==null?void 0:g.weeklyOffs}:{attendanceRules:r==null?void 0:r.attendanceRules,workingMinutes:r==null?void 0:r.workingMinutes,weeklyOffs:r==null?void 0:r.weeklyOffs}}const W=({branch:l,company:n,holidaydate:r,minutesinhours:i,canEdit:x,canDelete:c,edite:g,deletee:u})=>[{name:"Name",selector:e=>{var s,d;return(d=(s=e==null?void 0:e.employeeId)==null?void 0:s.userid)==null?void 0:d.name},sortable:!0,style:{minWidth:"180px"},cell:e=>{var s,d,h,m,o;return t.jsxs("div",{className:"flex items-center gap-3 ",children:[t.jsx(A,{src:C((s=e==null?void 0:e.employeeId)==null?void 0:s.profileimage,{format:"webp",width:100,height:100}),alt:(d=e==null?void 0:e.employeeId)==null?void 0:d.employeename,children:!((h=e==null?void 0:e.employeeId)!=null&&h.profileimage)&&t.jsx(D,{})}),t.jsx(Y,{children:t.jsx("p",{className:"text-[12px] md:text-[14px] text-gray-700 font-semibold",children:(o=(m=e==null?void 0:e.employeeId)==null?void 0:m.userid)==null?void 0:o.name})})]})}},{name:"Date",selector:e=>e.date,sortable:!0,width:"110px",cell:e=>a(e.date).format("DD MMM, YYYY")},{name:"Punch In",width:"140px",cell:e=>{if(!e.punchIn)return"- : -";const s=M(e,l,n),d=s==null?void 0:s.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY")),[m,o]=s.attendanceRules.considerEarlyEntryBefore.split(":").map(Number),[p,f]=s.attendanceRules.considerLateEntryAfter.split(":").map(Number),b=a(e.punchIn).startOf("day").add(m,"hour").add(o,"minute"),k=a(e.punchIn).startOf("day").add(p,"hour").add(f,"minute");return t.jsxs("div",{className:"flex w-full items-center gap-1",children:[t.jsx(O,{className:"text-[16px] text-blue-700"}),a(e.punchIn).format("hh:mm A"),!d&&!h&&t.jsxs(t.Fragment,{children:[a(e.punchIn).isBefore(b)&&t.jsx("span",{className:"px-2 py-1 rounded bg-sky-100 text-sky-800",children:"Early"}),a(e.punchIn).isAfter(k)&&t.jsx("span",{className:"px-2 py-1 rounded bg-amber-100 text-amber-800",children:"Late"})]})]})}},{name:"Punch Out",width:"140px",cell:e=>{if(!e.punchOut)return"- : -";const s=M(e,l,n),d=s==null?void 0:s.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY")),[m,o]=s.attendanceRules.considerEarlyExitBefore.split(":").map(Number),[p,f]=s.attendanceRules.considerLateExitAfter.split(":").map(Number),b=a(e.punchOut).startOf("day").add(m,"hour").add(o,"minute"),k=a(e.punchOut).startOf("day").add(p,"hour").add(f,"minute");return t.jsxs("div",{className:"flex  items-center gap-1",children:[t.jsx(O,{className:"text-[16px] text-blue-700"}),a(e.punchOut).format("hh:mm A"),!d&&!h&&t.jsxs(t.Fragment,{children:[a(e.punchOut).isBefore(b)&&t.jsx("span",{className:"px-2 py-1 rounded bg-amber-100 text-amber-800",children:"Early"}),a(e.punchOut).isAfter(k)&&t.jsx("span",{className:"px-2 py-1 rounded bg-sky-100 text-sky-800",children:"Late"})]})]})}},{name:"Status",width:"100px",cell:e=>{var o,p,f;const s=e.status==="absent",d=e.status==="leave",h=e.status==="holiday",m=e.status==="weekly off";return t.jsxs(t.Fragment,{children:[t.jsx("span",{title:d?(o=e==null?void 0:e.leave)==null?void 0:o.reason:"",className:`px-2 py-1 rounded
             ${s?"bg-red-100 text-red-800":d?"bg-amber-100 text-amber-800":h?"bg-blue-50 text-blue-800":m?"bg-gray-50 text-gray-800":"bg-green-100 text-green-800"}`,children:e.status}),d&&((p=e==null?void 0:e.leave)==null?void 0:p.reason)&&t.jsxs("span",{title:(f=e==null?void 0:e.leave)==null?void 0:f.reason,className:"ml-1 text-blue-600 text-lg font-bold",children:[" ",t.jsx(E,{})," "]})]})}},{name:"Working Hours",width:"210px",cell:e=>{var m,o,p,f;const s=M(e,l,n),d=s==null?void 0:s.weeklyOffs.includes(a(e.date).day()),h=r.includes(a(e.date).format("DD/MM/YYYY"));return e.workingMinutes?t.jsxs("div",{children:[t.jsxs("p",{children:[t.jsx("span",{className:"inline-block w-[50px]",children:i(e==null?void 0:e.workingMinutes)}),d||h?t.jsxs("span",{className:"ml-2 px-1 py-1 rounded bg-green-100 text-green-800",children:["Overtime ",e.workingMinutes," min"]}):t.jsxs(t.Fragment,{children:[e.workingMinutes<((m=s==null?void 0:s.workingMinutes)==null?void 0:m.shortDayThreshold)&&t.jsxs("span",{className:"ml-2 px-1 py-1 rounded bg-amber-100 text-amber-800",children:["Short ",((o=s==null?void 0:s.workingMinutes)==null?void 0:o.shortDayThreshold)-e.workingMinutes," min"]}),e.workingMinutes>((p=s==null?void 0:s.workingMinutes)==null?void 0:p.overtimeAfterMinutes)&&t.jsxs("span",{className:"ml-2 p-1 rounded bg-green-100 text-green-800",children:["Overtime ",e.workingMinutes-((f=s==null?void 0:s.workingMinutes)==null?void 0:f.overtimeAfterMinutes)," min"]})]})]}),t.jsx("p",{className:"text-[12px] mt-1 text-gray-600",children:h?"(Holiday)":d?"(Weekly Off)":""})]}):"-"}},{name:"Action",width:"80px",cell:e=>t.jsxs("div",{className:"flex gap-2.5",children:[x&&t.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>g(e),children:t.jsx(R,{})}),c&&t.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",onClick:()=>u(e._id),children:t.jsx(B,{})})]})}],$=()=>({headCells:{style:{backgroundColor:v(n=>n.user.primaryColor)||"#115e59",fontWeight:"bold",fontSize:"14px",color:"white",justifyContent:"flex-start",paddingLeft:"8px",paddingRight:"0px"}},headRow:{style:{borderBottom:"2px solid #ccc"}},rows:{style:{minHeight:"48px",borderBottom:"1px solid #eee"}},cells:{style:{justifyContent:"flex-start",paddingLeft:"8px",paddingRight:"0px"}}});export{z as I,O as a,L as b,W as c,T as d,F as s,$ as u};
