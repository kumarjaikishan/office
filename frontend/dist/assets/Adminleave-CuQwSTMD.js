import{j as e,b as E,y as b,r as m,g as x,K as $,A as O,F as P}from"./index-Yr5TVBX8.js";import{X as _}from"./index.es-BNEnLlPq.js";import{A as L}from"./index-DPLLIyaO.js";import{M as U}from"./Modalbox-DFzdZFVl.js";import{I as X}from"./index-BtacAYSp.js";import{B as M}from"./Box-CAslWZV8.js";import{T as d}from"./TextField-BZQlsKpZ.js";import{F as q,I as H,S as K}from"./Select-BzO5C_ZD.js";import{M as y}from"./MenuItem-DUYgeWuo.js";import{B as A}from"./Button-DbYv_FMR.js";import{u as G}from"./attandencehelper-Dy0nLLzv.js";import{C as N}from"./CheckPermission-DEijDNSt.js";import{T as k}from"./Typography-wzkP9v2k.js";import"./useSlotProps-BKaa53Ma.js";import"./createSimplePaletteValueFilter-B57QjJRu.js";import"./ButtonBase-BPEedJVC.js";const J=({inp:s,openmodal:h,isload:f,handleChange:l,setopenmodal:i,setInp:c,init:n})=>{const u=async o=>{o.preventDefault(),console.log(s);const j=localStorage.getItem("emstoken");try{const r=await E.post("/api/leavehandle",{...s},{headers:{Authorization:`Bearer ${j}`}});i(!1),c(n),b.success(r.data.message,{autoClose:2e3})}catch(r){r.response&&b.warning(r.response.data.message,{autoClose:3e3}),console.error(r)}};return e.jsx(U,{open:h,onClose:()=>{i(!1),c(n)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:u,children:[e.jsx("h2",{children:"Leave Management"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsxs(M,{sx:{width:"100%",gap:2},children:[e.jsx(d,{fullWidth:!0,value:s.department,label:"Department",size:"small"}),e.jsx(d,{fullWidth:!0,value:s.employeename,label:"Name",size:"small"})]}),e.jsxs(M,{sx:{width:"100%",gap:2},children:[e.jsx(d,{fullWidth:!0,value:s.from,label:"From",size:"small"}),e.jsx(d,{fullWidth:!0,value:s.to,label:"To",size:"small"})]}),e.jsx(d,{fullWidth:!0,multiline:!0,minRows:2,value:s.reason,onChange:o=>l(o,"reason"),label:"Reason",size:"small"}),e.jsxs(q,{fullWidth:!0,required:!0,size:"small",children:[e.jsx(H,{children:"Status"}),e.jsxs(K,{value:s.status,label:"Status",onChange:o=>l(o,"status"),children:[e.jsx(y,{value:"pending",children:"Pending"}),e.jsx(y,{value:"approved",children:"Approve"}),e.jsx(y,{value:"rejected",children:"Reject"})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx(A,{sx:{mr:2},loading:f,loadingPosition:"end",endIcon:e.jsx(X,{}),variant:"contained",type:"submit",children:"Update"}),e.jsx(A,{size:"small",onClick:()=>{i(!1),c(n)},variant:"outlined",children:"Cancel"})]})]})]})})})},xe=()=>{const[s,h]=m.useState([]),[f,l]=m.useState(!1),[i,c]=m.useState(!1),n={leaveid:"",department:"",employeename:"",from:"",to:"",reason:"",status:""},[u,o]=m.useState(n),j=N("leave",3),r=N("leave",4);m.useEffect(()=>{(async()=>{var v,D;const g=localStorage.getItem("emstoken");try{const p=await E.get("/api/fetchleave",{headers:{Authorization:`Bearer ${g}`}});let W=1;const T=await p.data.leave.map(t=>{var S,Y,I,w,C,z;return{id:t._id,sno:W++,name:e.jsxs("div",{className:"flex items-center gap-3 ",children:[e.jsx(O,{src:(S=t==null?void 0:t.employeeId)==null?void 0:S.profileimage,alt:(Y=t==null?void 0:t.employeeId)==null?void 0:Y.employeename,children:!((I=t.employeeId)!=null&&I.profileimage)&&e.jsx(P,{})}),e.jsxs(M,{children:[e.jsx(k,{variant:"body2",children:(w=t.employeeId)==null?void 0:w.employeename}),e.jsx(k,{variant:"body2",children:(z=(C=t.employeeId)==null?void 0:C.userid)==null?void 0:z.email})]})]}),from:x(t.fromDate).format("DD MMM, YYYY"),to:x(t.toDate).format("DD MMM, YYYY"),reason:t.reason,status:e.jsx("span",{className:`${t.status=="approved"?"bg-green-100 text-green-800":t.status=="rejected"?"bg-red-100 text-red-800":"bg-amber-100 text-amber-800"} px-3 py-1 rounded capitalize`,children:t.status}),action:e.jsxs("div",{className:"flex gap-2",children:[j&&e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>R(t),children:e.jsx($,{})}),r&&e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>F(t._id),children:e.jsx(L,{})})]})}});h(T)}catch(p){console.error(p),b.warning(((D=(v=p.response)==null?void 0:v.data)==null?void 0:D.message)||"Error")}})()},[]);const B=(a,g)=>{o({...u,[g]:a.target.value})},F=()=>{},R=a=>{console.log(a),o({leaveid:a._id,department:a.employeeId.userid.email,employeename:a.employeeId.employeename,from:x(a.fromDate).format("DD MMM, YYYY"),to:x(a.toDate).format("DD MMM, YYYY"),reason:a.reason,status:a.status}),l(!0)};return e.jsxs("div",{children:[e.jsx(_,{customStyles:G(),columns:Q,data:s,pagination:!0,highlightOnHover:!0}),e.jsx(J,{handleChange:B,inp:u,isload:i,init:n,setInp:o,openmodal:f,setopenmodal:l})]})},Q=[{name:"S.no",selector:s=>s.sno,width:"60px"},{name:"Employee",selector:s=>s.name},{name:"from",selector:s=>s.from,width:"120px"},{name:"to",selector:s=>s.to,width:"120px"},{name:"Reason",selector:s=>s.reason},{name:"Status",selector:s=>s.status,width:"120px"},{name:"Action",selector:s=>s.action,width:"90px"}];export{Q as columns,xe as default};
