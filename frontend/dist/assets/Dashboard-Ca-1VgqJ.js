import{r as c,c as m,y as l,j as a,B as r,a9 as G,aa as H,h as T,ab as N,b as u,bU as V,bV as X,a1 as J}from"./index-D_KYbKMv.js";import{u as K}from"./attandencehelper-BpECklSl.js";import{a as Q}from"./index-BvY2lkv_.js";import{A as $}from"./index-BXx8RfSK.js";const te=()=>{c.useEffect(()=>{v()},[]);const b={userid:"",name:"",email:"",password:""},[I,A]=c.useState([]),[E,x]=c.useState(!1),[i,p]=c.useState(b),[k,S]=c.useState(!1),[g,D]=c.useState(!1),[z,f]=c.useState(!1),[d,j]=c.useState({companyId:"",name:"",email:"",password:""}),[M,w]=c.useState(!1),[y,B]=c.useState([]),v=async()=>{var e,s;try{const t=localStorage.getItem("emstoken"),o=await m.get("/api/developerfetch",{headers:{Authorization:`Bearer ${t}`}});A(o.data.users)}catch(t){console.log(t),l.warn(((s=(e=t.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},U=async e=>{var s,t;e.preventDefault();try{const o=localStorage.getItem("emstoken"),n=await m.post("/api/User",{...i},{headers:{Authorization:`Bearer ${o}`}});x(!1),v(),l.success(n.data.message,{autoClose:1800})}catch(o){console.log(o),l.warn(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error",{autoClose:3e3})}finally{}},W=e=>{p({userid:e==null?void 0:e._id,name:e==null?void 0:e.registeredName,email:e==null?void 0:e.email}),S(!0),x(!0)},q=e=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{var t,o;if(s)try{const n=localStorage.getItem("emstoken"),h=await m.delete(`/api/User/${e}`,{headers:{Authorization:`Bearer ${n}`}});v(),l.success(h.data.message,{autoClose:1800})}catch(n){console.log(n),l.warn(((o=(t=n.response)==null?void 0:t.data)==null?void 0:o.message)||"Error",{autoClose:3e3})}})},L=async()=>{var e,s;try{const t=localStorage.getItem("emstoken"),o=await m.put(`/api/User/${i.userid}`,{name:i.name,email:i.email},{headers:{Authorization:`Bearer ${t}`}});x(!1),v(),l.success(o.data.message,{autoClose:1800})}catch(t){console.log(t),l.warn(((s=(e=t.response)==null?void 0:e.data)==null?void 0:s.message)||"Error",{autoClose:3e3})}},C=async e=>{swal({title:`Are you sure you want to Deploy ${e}?`,icon:"warning",buttons:!0,dangerMode:!0}).then(async s=>{var t,o;if(s){D(!0);const n=l.loading(`Deploying ${e}...`);try{const h=localStorage.getItem("emstoken"),Y=await m.get(`/api/deploy/${e}`,{headers:{Authorization:`Bearer ${h}`}});l.update(n,{render:Y.data.message,type:"success",isLoading:!1,autoClose:1800})}catch(h){l.update(n,{render:((o=(t=h.response)==null?void 0:t.data)==null?void 0:o.message)||"Error during deployment",type:"error",isLoading:!1,autoClose:3e3}),console.log(h)}finally{D(!1)}}})},O=()=>{x(!1),p(b),S(!1)},P=e=>{j({companyId:e==null?void 0:e.companyId,email:"",password:""}),f(!0)},_=async e=>{try{const s=localStorage.getItem("emstoken"),t=await m.get(`/api/demo/${e.companyId}`,{headers:{Authorization:`Bearer ${s}`}});B(t.data.demousers),w(!0)}catch(s){console.log(s)}},F=async e=>{try{const s=localStorage.getItem("emstoken"),t=await m.delete(`/api/demo/${e}`,{headers:{Authorization:`Bearer ${s}`}});console.log(t.data),l.success(t.data.message)}catch(s){console.log(s)}},R=[{name:"S.No",selector:(e,s)=>s+1,width:"60px"},{name:"Name",selector:e=>(e==null?void 0:e.registeredName)??"",width:"160px"},{name:"Email",selector:e=>e.email},{name:"Date",selector:e=>T(e.createdAt).format("DD MMM, YY"),width:"90px"},{name:"Status",selector:e=>e.stat||"-",width:"110px"},{name:"Action",width:"140px",cell:e=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>_(e),children:a.jsx(V,{})}),a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>P(e),children:a.jsx(X,{})}),a.jsx("span",{className:"text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>W(e),children:a.jsx(J,{})}),a.jsx("span",{className:"text-[18px] text-red-500 cursor-pointer",title:"Delete",onClick:()=>q(e._id),children:a.jsx($,{})})]})}];return a.jsxs("div",{children:[a.jsxs("div",{className:"my-1 flex justify-end gap-2",children:[a.jsx(r,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:g,onClick:()=>C("accusoft"),children:"Accusoft"}),a.jsx(r,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:g,onClick:()=>C("battlefiesta"),children:"battlefiesta"}),a.jsx(r,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:g,onClick:()=>C("office"),children:"EMS"}),a.jsx(r,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",loading:g,onClick:()=>C("portfolio"),children:"Portfolio"}),a.jsx(r,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:a.jsx(G,{}),onClick:()=>x(!0),children:"Add User"})]}),a.jsx(H,{columns:R,data:I,pagination:!0,customStyles:K(),highlightOnHover:!0,noDataComponent:a.jsxs("div",{className:"flex items-center gap-2 py-6 text-center text-gray-600 text-sm",children:[a.jsx(Q,{className:"text-xl"})," No records found matching your criteria."]})}),a.jsx(N,{open:E,onClose:()=>{x(!1)},children:a.jsx("div",{className:"membermodal w-[500px]",children:a.jsxs("form",{onSubmit:U,children:[a.jsx("h2",{children:"Add New User"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[a.jsx(u,{fullWidth:!0,required:!0,value:i.name,onChange:e=>p({...i,name:e.target.value}),label:"Name",size:"small"}),a.jsx(u,{fullWidth:!0,required:!0,type:"email",value:i.email,onChange:e=>p({...i,email:e.target.value}),label:"Email",size:"small"}),!k&&a.jsx(u,{fullWidth:!0,required:!0,type:"password",value:i.password,onChange:e=>p({...i,password:e.target.value}),label:"Passowrd",size:"small"}),a.jsxs("div",{children:[k?a.jsx(r,{variant:"contained",sx:{mr:2},onClick:L,children:"Save"}):a.jsx(r,{variant:"contained",sx:{mr:2},type:"submit",children:"Add User"}),a.jsx(r,{variant:"outlined",onClick:O,sx:{mr:2},children:"Cancel"})]})]})})]})})}),a.jsx(N,{open:z,onClose:()=>f(!1),children:a.jsx("div",{className:"membermodal w-[400px]",children:a.jsxs("form",{onSubmit:async e=>{var s,t;e.preventDefault();try{const o=localStorage.getItem("emstoken"),n=await m.post("/api/demo",d,{headers:{Authorization:`Bearer ${o}`}});l.success(n.data.message,{autoClose:2e3}),f(!1)}catch(o){console.log(o),l.error(((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Error creating demo",{autoClose:4e3})}},children:[a.jsx("h2",{children:"Create Demo Account"}),a.jsx("span",{className:"modalcontent ",children:a.jsxs("div",{className:"flex flex-col gap-3 mt-3",children:[a.jsx(u,{fullWidth:!0,label:"Company ID",value:d.companyId,disabled:!0,size:"small"}),a.jsx(u,{fullWidth:!0,required:!0,variant:"standard",label:"Name",value:d.name,onChange:e=>j({...d,name:e.target.value}),size:"small"}),a.jsx(u,{fullWidth:!0,required:!0,variant:"standard",label:"Demo Email",value:d.email,onChange:e=>j({...d,email:e.target.value}),size:"small"}),a.jsx(u,{fullWidth:!0,required:!0,variant:"standard",type:"password",label:"Password",value:d.password,onChange:e=>j({...d,password:e.target.value}),size:"small"}),a.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[a.jsx(r,{variant:"outlined",onClick:()=>f(!1),children:"Cancel"}),a.jsx(r,{variant:"contained",type:"submit",children:"Create"})]})]})})]})})}),a.jsx(N,{open:M,onClose:()=>w(!1),children:a.jsx("div",{className:"membermodal w-[400px]",children:a.jsxs("form",{children:[a.jsx("h2",{children:"Demo Accounts"}),a.jsxs("span",{className:"modalcontent ",children:[y.length<1&&a.jsx("div",{className:"text-center",children:"No Demo Id found"}),a.jsx("ul",{className:"mt-3 space-y-2",children:y==null?void 0:y.map((e,s)=>a.jsxs("li",{className:"flex justify-between bg-gray-50 p-2 rounded-md text-sm",children:[a.jsxs("span",{className:"text-gray-500",children:[s+1,". ",e.name]}),a.jsx("span",{children:e.email}),a.jsxs("span",{onClick:()=>F(e._id),className:" text-red-600 text-2xl cursor-pointer",children:[a.jsx($,{})," "]})]},s))})]}),a.jsx("span",{className:"modalbody",children:a.jsx(r,{variant:"outlined",onClick:()=>w(!1),children:"Close"})})]})})})]})};export{te as default};
