import{ax as L,r as p,ay as H,j as a,x as X,az as J,aA as A,aB as P,aC as K,aD as Q,aE as W,z as Y,l as Z,aF as ee,aG as $,w as ae,n as se,c as B,at as te,au as ne,y as I,b as S,B as w,ag as re,F as T,I as V,S as R,M as D}from"./index-UVvS6XYW.js";import{I as _}from"./index-GXjyqOjN.js";import{M as oe}from"./Modalbox-VUZKQTBg.js";const le=ee(),ie=L("div",{name:"MuiStack",slot:"Root"});function ce(e){return J({props:e,name:"MuiStack",defaultTheme:le})}function de(e,n){const t=p.Children.toArray(e).filter(Boolean);return t.reduce((o,r,i)=>(o.push(r),i<t.length-1&&o.push(p.cloneElement(n,{key:`separator-${i}`})),o),[])}const ue=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],me=({ownerState:e,theme:n})=>{let t={display:"flex",flexDirection:"column",...A({theme:n},P({values:e.direction,breakpoints:n.breakpoints.values}),o=>({flexDirection:o}))};if(e.spacing){const o=K(n),r=Object.keys(n.breakpoints.values).reduce((l,c)=>((typeof e.spacing=="object"&&e.spacing[c]!=null||typeof e.direction=="object"&&e.direction[c]!=null)&&(l[c]=!0),l),{}),i=P({values:e.direction,base:r}),h=P({values:e.spacing,base:r});typeof i=="object"&&Object.keys(i).forEach((l,c,f)=>{if(!i[l]){const b=c>0?i[f[c-1]]:"column";i[l]=b}}),t=Q(t,A({theme:n},h,(l,c)=>e.useFlexGap?{gap:$(o,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${ue(c?i[c]:e.direction)}`]:$(o,l)}}))}return t=W(n.breakpoints,t),t};function pe(e={}){const{createStyledComponent:n=ie,useThemeProps:t=ce,componentName:o="MuiStack"}=e,r=()=>Y({root:["root"]},l=>Z(o,l),{}),i=n(me);return p.forwardRef(function(l,c){const f=t(l),u=H(f),{component:b="div",direction:E="column",spacing:C=0,divider:m,children:v,className:z,useFlexGap:q=!1,...F}=u,M={direction:E,spacing:C,useFlexGap:q},N=r();return a.jsx(i,{as:b,ownerState:M,ref:c,className:X(N.root,z),...F,children:m?de(v,m):v})})}const G=pe({createStyledComponent:ae("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>se({props:e,name:"MuiStack"})}),ye=[{name:"S.no",selector:e=>e.sno},{name:"Employee",selector:e=>e.employeeId},{name:"Department",selector:e=>e.department},{name:"Salary",selector:e=>e.netSalary},{name:"Pay date",selector:e=>e.payDate},{name:"Action",selector:e=>e.action}],he=async({setisload:e})=>{const n=localStorage.getItem("emstoken");e(!0);try{return(await B.get("/api/employeelist",{headers:{Authorization:`Bearer ${n}`}})).data.list}catch(t){console.log(t),t.response?I.warn(t.response.data.message,{autoClose:1200}):t.request?console.error("No response from server:",t.request):console.error("Error:",t.message)}finally{e(!1)}},xe=async({setisload:e,deletee:n,edite:t})=>{const o=localStorage.getItem("emstoken");e(!0);try{const r=await B.get("/api/salaryfetch",{headers:{Authorization:`Bearer ${o}`}});console.log(r.data);let i=1;return await r.data.salary.map(d=>({id:d._id,sno:i++,employeeId:d.employeeId.employeename,department:d.employeeId.department.department,netSalary:d.netSalary,payDate:d.payDate,action:a.jsxs("div",{className:"action",children:[a.jsx("span",{className:"edit",title:"Edit",onClick:()=>t(d),children:a.jsx(te,{})}),a.jsx("span",{className:"delete",onClick:()=>n(d._id),children:a.jsx(ne,{})})]})}))}catch(r){console.log(r),r.response?I.warn(r.response.data.message,{autoClose:1200}):r.request?console.error("No response from server:",r.request):console.error("Error:",r.message)}finally{e(!1)}},fe=async({inp:e,setisload:n})=>{const t=localStorage.getItem("emstoken");n(!0);const{employeeId:o,basicSalary:r,allowance:i,deductions:h,netSalary:d,payDate:l,department:c,description:f}=e;try{const u=await B.post("/api/addsalary",{employeeId:o,basicSalary:r,allowance:i,deductions:h,netSalary:d,payDate:l,department:c,description:f},{headers:{Authorization:`Bearer ${t}`}});return console.log(u),I.success(u.data.message,{autoClose:1200}),n(!1),!0}catch(u){console.log(u),u.response?I.warn(u.response.data.message,{autoClose:1200}):u.request?console.error("No response from server:",u.request):console.error("Error:",u.message)}finally{n(!1)}},be=()=>{const[e,n]=p.useState(!1),[t,o]=p.useState(!1),[r,i]=p.useState(!1),[h,d]=p.useState([]),[l,c]=p.useState(""),[f,u]=p.useState([]),[b,E]=p.useState([]),C={employeeId:"",basicSalary:"",allowance:"",deductions:"",netSalary:0,payDate:"",description:"",department:""},[m,v]=p.useState(C);p.useEffect(()=>{q(),z()},[]);const z=async()=>{let s=await xe({setisload:n,edite:M,deletee:N});console.log(s),E(s)},q=async()=>{const s=await he({setisload:n});let x=[];s.forEach(y=>{let g=x.find(k=>k.departmentid===y.department._id);if(g)g.employee.push({id:y._id,name:y.employeename});else{let k={departmentid:y.department._id,departmentname:y.department.department,employee:[{id:y._id,name:y.employeename}]};x.push(k)}}),d(x)};p.useEffect(()=>{if(l){let s=h.find(x=>x.departmentid==l);u(s.employee)}},[l,h]);const F=async s=>{s.preventDefault(),console.log(m),await fe({inp:m,setisload:n})&&o(!1)},M=s=>{console.log("eplyee edit",s)},N=s=>console.log("delete",s),j=(s,x)=>{const y=s.target.value,g={...m,[x]:y},k=parseFloat(x==="basicSalary"?y:g.basicSalary)||0,O=parseFloat(x==="allowance"?y:g.allowance)||0,U=parseFloat(x==="deductions"?y:g.deductions)||0;g.netSalary=(k+O-U).toFixed(2),v(g)};return a.jsxs("div",{className:"salary",children:[a.jsx("h2",{children:"Salary Management"}),a.jsxs("div",{className:"head",children:[a.jsx(S,{size:"small",id:"outlined-basic",label:"Search Department",variant:"standard"}),a.jsx(w,{variant:"contained",onClick:()=>o(!0),children:"Add Salary"})]}),a.jsx("div",{className:"list",children:a.jsx(re,{columns:ye,data:b,pagination:!0,highlightOnHover:!0})}),a.jsx(oe,{open:t,onClose:()=>o(!1),children:a.jsx("div",{className:"membermodal",children:a.jsxs("form",{onSubmit:F,children:[a.jsx("h2",{children:"Add Salary"}),a.jsxs("span",{className:"modalcontent",children:[a.jsxs(T,{sx:{width:"98%"},required:!0,size:"small",children:[a.jsx(V,{id:"department-label",children:"Department"}),a.jsxs(R,{labelId:"department-label",id:"department-select",value:m.department,name:"Department",label:"Department",onChange:s=>{j(s,"department"),c(s.target.value)},children:[a.jsx(D,{disabled:!0,value:"",children:"Select Department"},""),h==null?void 0:h.map(s=>a.jsx(D,{value:s.departmentid,children:s.departmentname},s.departmentid))]})]}),a.jsxs(T,{sx:{width:"98%"},required:!0,size:"small",children:[a.jsx(V,{id:"employee-label",children:"Employee"}),a.jsxs(R,{labelId:"employee-label",id:"employee-select",value:m.employeeId,name:"Employee",label:"Employee",onChange:s=>j(s,"employeeId"),children:[a.jsx(D,{disabled:!0,value:"",children:"Select Employee"},""),f==null?void 0:f.map(s=>a.jsx(D,{value:s.id,children:s.name},s.id))]})]}),a.jsxs(G,{direction:"row",spacing:2,sx:{width:"98%"},children:[a.jsx(S,{sx:{width:"50%"},required:!0,value:m.basicSalary,type:"number",onChange:s=>j(s,"basicSalary"),label:"basicSalary",size:"small"}),a.jsx(S,{sx:{width:"50%"},required:!0,value:m.allowance,type:"number",onChange:s=>j(s,"allowance"),label:"allowance",size:"small"})]}),a.jsxs(G,{direction:"row",spacing:2,sx:{width:"98%"},children:[a.jsx(S,{sx:{width:"50%"},required:!0,value:m.deductions,type:"number",onChange:s=>j(s,"deductions"),label:"deductions",size:"small"}),a.jsx(S,{sx:{width:"50%"},required:!0,value:m.netSalary,label:"netSalary",size:"small"})]}),a.jsx(S,{sx:{width:"98%"},required:!0,value:m.payDate,onChange:s=>j(s,"payDate"),label:"payDate",size:"small"}),a.jsx(S,{multiline:!0,rows:4,onChange:s=>j(s,"description"),value:m.description,sx:{width:"98%"},label:"Description",size:"small"}),a.jsxs("div",{children:[!r&&a.jsx(w,{sx:{mr:2},loading:e,loadingPosition:"end",endIcon:a.jsx(_,{}),variant:"contained",type:"submit",children:"Add"}),r&&a.jsx(w,{sx:{mr:2},loading:e,loadingPosition:"end",endIcon:a.jsx(_,{}),variant:"contained",onClick:updatee,children:"Update"}),a.jsx(w,{size:"small",onClick:()=>{o(!1),i(!1),v(C)},variant:"outlined",children:" cancel"})]})]})]})})})]})};export{be as default};
