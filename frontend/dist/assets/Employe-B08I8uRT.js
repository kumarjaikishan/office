import{h as je,i as ve,r as c,k as be,l as Ze,m as es,j as e,n as X,o as ce,p as we,q as se,t as ie,b as ue,y as J,v as ss,w as Re,x as Me,z as Te,B as $e,D as ts,E as as,M as ns,G as rs,H as os,f as is,a as ls,I as We,T as ds,A as Be,J as cs,C as Fe,K as us,L as Ge,O as Ue}from"./index-CleMBIBn.js";import{I as _e}from"./index-BATINc3G.js";import{M as ye}from"./Modalbox-rZpR_NLY.js";import{X as ms}from"./index.es-BzX17GyM.js";import{I as ps,a as xs}from"./index-BLrl-Ufv.js";import{G as qe,a as hs}from"./index-D4eCxbfa.js";import{H as gs}from"./index-FeQRIqJJ.js";import{B as fs,P as js,L as vs}from"./index-DaNm9UTd.js";import{d as Se}from"./dayjs.min-DSKahEwl.js";import{A as bs}from"./index-CWdIVX8_.js";import{u as ws}from"./imageresizer-D4I-KFLq.js";import{C as Ae}from"./CheckPermission-BFzjOU-Y.js";import{B as Q}from"./Box-DxCvFchx.js";import{T as de}from"./Typography-CcZCxKTQ.js";import{T as N}from"./TextField-DiABiCHh.js";import{I as Ee}from"./InputAdornment-BHx7rmla.js";import{T as Ns,g as Le,u as Cs,P as ys,F as ae,I as ne,S as re,O as Oe}from"./Select-D3hz-9Ri.js";import{M as G}from"./MenuItem-DOZMs1J2.js";import{B as K}from"./Button-CoB3H69l.js";import{u as Ss}from"./useSlotProps-BIGTSc1Y.js";import{u as As,B as Es}from"./ButtonBase-CbJsO36x.js";import"./createSimplePaletteValueFilter-BYlBxWKv.js";function Is(a){return je("MuiCollapse",a)}ve("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Ds=a=>{const{orientation:r,classes:l}=a,t={root:["root",`${r}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${r}`],wrapperInner:["wrapperInner",`${r}`]};return we(t,Is,l)},zs=X("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(a,r)=>{const{ownerState:l}=a;return[r.root,r[l.orientation],l.state==="entered"&&r.entered,l.state==="exited"&&!l.in&&l.collapsedSize==="0px"&&r.hidden]}})(se(({theme:a})=>({height:0,overflow:"hidden",transition:a.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:a.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:r})=>r.state==="exited"&&!r.in&&r.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Ps=X("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),ks=X("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Ie=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiCollapse"}),{addEndListener:p,children:x,className:g,collapsedSize:u="0px",component:h,easing:T,in:D,onEnter:I,onEntered:S,onEntering:z,onExit:b,onExited:P,onExiting:j,orientation:w="vertical",style:k,timeout:A=Ze.standard,TransitionComponent:_=Ns,...$}=t,E={...t,orientation:w,collapsedSize:u},v=Ds(E),H=Ss(),q=As(),f=c.useRef(null),m=c.useRef(),W=typeof u=="number"?`${u}px`:u,L=w==="horizontal",Y=L?"width":"height",B=c.useRef(null),i=es(l,B),C=d=>R=>{if(d){const M=B.current;R===void 0?d(M):d(M,R)}},F=()=>f.current?f.current[L?"clientWidth":"clientHeight"]:0,me=C((d,R)=>{f.current&&L&&(f.current.style.position="absolute"),d.style[Y]=W,I&&I(d,R)}),pe=C((d,R)=>{const M=F();f.current&&L&&(f.current.style.position="");const{duration:O,easing:te}=Le({style:k,timeout:A,easing:T},{mode:"enter"});if(A==="auto"){const he=H.transitions.getAutoHeightDuration(M);d.style.transitionDuration=`${he}ms`,m.current=he}else d.style.transitionDuration=typeof O=="string"?O:`${O}ms`;d.style[Y]=`${M}px`,d.style.transitionTimingFunction=te,z&&z(d,R)}),Ne=C((d,R)=>{d.style[Y]="auto",S&&S(d,R)}),xe=C(d=>{d.style[Y]=`${F()}px`,b&&b(d)}),Ce=C(P),y=C(d=>{const R=F(),{duration:M,easing:O}=Le({style:k,timeout:A,easing:T},{mode:"exit"});if(A==="auto"){const te=H.transitions.getAutoHeightDuration(R);d.style.transitionDuration=`${te}ms`,m.current=te}else d.style.transitionDuration=typeof M=="string"?M:`${M}ms`;d.style[Y]=W,d.style.transitionTimingFunction=O,j&&j(d)}),le=d=>{A==="auto"&&q.start(m.current||0,d),p&&p(B.current,d)};return e.jsx(_,{in:D,onEnter:me,onEntered:Ne,onEntering:pe,onExit:xe,onExited:Ce,onExiting:y,addEndListener:le,nodeRef:B,timeout:A==="auto"?null:A,...$,children:(d,{ownerState:R,...M})=>e.jsx(zs,{as:h,className:ce(v.root,g,{entered:v.entered,exited:!D&&W==="0px"&&v.hidden}[d]),style:{[L?"minWidth":"minHeight"]:W,...k},ref:i,ownerState:{...E,state:d},...M,children:e.jsx(Ps,{ownerState:{...E,state:d},className:v.wrapper,ref:f,children:e.jsx(ks,{ownerState:{...E,state:d},className:v.wrapperInner,children:x})})})})});Ie&&(Ie.muiSupportAuto=!0);const Qe=c.createContext({});function Rs(a){return je("MuiAccordion",a)}const fe=ve("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),Ms=a=>{const{classes:r,square:l,expanded:t,disabled:p,disableGutters:x}=a;return we({root:["root",!l&&"rounded",t&&"expanded",p&&"disabled",!x&&"gutters"],heading:["heading"],region:["region"]},Rs,r)},Ts=X(ys,{name:"MuiAccordion",slot:"Root",overridesResolver:(a,r)=>{const{ownerState:l}=a;return[{[`& .${fe.region}`]:r.region},r.root,!l.square&&r.rounded,!l.disableGutters&&r.gutters]}})(se(({theme:a})=>{const r={duration:a.transitions.duration.shortest};return{position:"relative",transition:a.transitions.create(["margin"],r),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(a.vars||a).palette.divider,transition:a.transitions.create(["opacity","background-color"],r)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${fe.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${fe.disabled}`]:{backgroundColor:(a.vars||a).palette.action.disabledBackground}}}),se(({theme:a})=>({variants:[{props:r=>!r.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(a.vars||a).shape.borderRadius,borderBottomRightRadius:(a.vars||a).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:r=>!r.disableGutters,style:{[`&.${fe.expanded}`]:{margin:"16px 0"}}}]}))),$s=X("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),He=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordion"}),{children:p,className:x,defaultExpanded:g=!1,disabled:u=!1,disableGutters:h=!1,expanded:T,onChange:D,square:I=!1,slots:S={},slotProps:z={},TransitionComponent:b,TransitionProps:P,...j}=t,[w,k]=Cs({controlled:T,default:g,name:"Accordion",state:"expanded"}),A=c.useCallback(F=>{k(!w),D&&D(F,!w)},[w,D,k]),[_,...$]=c.Children.toArray(p),E=c.useMemo(()=>({expanded:w,disabled:u,disableGutters:h,toggle:A}),[w,u,h,A]),v={...t,square:I,disabled:u,disableGutters:h,expanded:w},H=Ms(v),q={transition:b,...S},f={transition:P,...z},m={slots:q,slotProps:f},[W,L]=ie("root",{elementType:Ts,externalForwardedProps:{...m,...j},className:ce(H.root,x),shouldForwardComponentProp:!0,ownerState:v,ref:l,additionalProps:{square:I}}),[Y,B]=ie("heading",{elementType:$s,externalForwardedProps:m,className:H.heading,ownerState:v}),[i,C]=ie("transition",{elementType:Ie,externalForwardedProps:m,ownerState:v});return e.jsxs(W,{...L,children:[e.jsx(Y,{...B,children:e.jsx(Qe.Provider,{value:E,children:_})}),e.jsx(i,{in:w,timeout:"auto",...C,children:e.jsx("div",{"aria-labelledby":_.props.id,id:_.props["aria-controls"],role:"region",className:H.region,children:$})})]})});function Ws(a){return je("MuiAccordionDetails",a)}ve("MuiAccordionDetails",["root"]);const Bs=a=>{const{classes:r}=a;return we({root:["root"]},Ws,r)},Fs=X("div",{name:"MuiAccordionDetails",slot:"Root"})(se(({theme:a})=>({padding:a.spacing(1,2,2)}))),Ye=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordionDetails"}),{className:p,...x}=t,g=t,u=Bs(g);return e.jsx(Fs,{className:ce(u.root,p),ref:l,ownerState:g,...x})});function Gs(a){return je("MuiAccordionSummary",a)}const oe=ve("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Us=a=>{const{classes:r,expanded:l,disabled:t,disableGutters:p}=a;return we({root:["root",l&&"expanded",t&&"disabled",!p&&"gutters"],focusVisible:["focusVisible"],content:["content",l&&"expanded",!p&&"contentGutters"],expandIconWrapper:["expandIconWrapper",l&&"expanded"]},Gs,r)},_s=X(Es,{name:"MuiAccordionSummary",slot:"Root"})(se(({theme:a})=>{const r={duration:a.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:a.spacing(0,2),transition:a.transitions.create(["min-height","background-color"],r),[`&.${oe.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${oe.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`&:hover:not(.${oe.disabled})`]:{cursor:"pointer"},variants:[{props:l=>!l.disableGutters,style:{[`&.${oe.expanded}`]:{minHeight:64}}}]}})),qs=X("span",{name:"MuiAccordionSummary",slot:"Content"})(se(({theme:a})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:r=>!r.disableGutters,style:{transition:a.transitions.create(["margin"],{duration:a.transitions.duration.shortest}),[`&.${oe.expanded}`]:{margin:"20px 0"}}}]}))),Ls=X("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(se(({theme:a})=>({display:"flex",color:(a.vars||a).palette.action.active,transform:"rotate(0deg)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shortest}),[`&.${oe.expanded}`]:{transform:"rotate(180deg)"}}))),Ve=c.forwardRef(function(r,l){const t=be({props:r,name:"MuiAccordionSummary"}),{children:p,className:x,expandIcon:g,focusVisibleClassName:u,onClick:h,slots:T,slotProps:D,...I}=t,{disabled:S=!1,disableGutters:z,expanded:b,toggle:P}=c.useContext(Qe),j=f=>{P&&P(f),h&&h(f)},w={...t,expanded:b,disabled:S,disableGutters:z},k=Us(w),A={slots:T,slotProps:D},[_,$]=ie("root",{ref:l,shouldForwardComponentProp:!0,className:ce(k.root,x),elementType:_s,externalForwardedProps:{...A,...I},ownerState:w,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:S,"aria-expanded":b,focusVisibleClassName:ce(k.focusVisible,u)},getSlotProps:f=>({...f,onClick:m=>{var W;(W=f.onClick)==null||W.call(f,m),j(m)}})}),[E,v]=ie("content",{className:k.content,elementType:qs,externalForwardedProps:A,ownerState:w}),[H,q]=ie("expandIconWrapper",{className:k.expandIconWrapper,elementType:Ls,externalForwardedProps:A,ownerState:w});return e.jsxs(_,{...$,children:[e.jsx(E,{...v,children:p}),g&&e.jsx(H,{...q,children:g})]})}),Os=[{name:"S.no",selector:a=>a.sno,width:"40px"},{name:"Name",selector:a=>a.name},{name:"Email",selector:a=>a.email},{name:"Department",selector:a=>a.department},{name:"Action",selector:a=>a.action,width:"160px"}],Hs=async({formData:a,setisload:r,setInp:l,setopenmodal:t,init:p,resetPhoto:x})=>{const g=localStorage.getItem("emstoken");r(!0);try{const u=await ue.post("/api/addemployee",a,{headers:{Authorization:`Bearer ${g}`,"Content-Type":"multipart/form-data"}});J.success(u.data.message,{autoClose:1200}),l(p),x(),t(!1)}catch(u){console.log(u),u.response?J.warn(u.response.data.message,{autoClose:1200}):console.error("Error:",u.message)}finally{r(!1)}},Ys=async({formData:a,inp:r,setEmployeePhoto:l,setisload:t,setInp:p,setopenmodal:x,init:g})=>{const u=localStorage.getItem("emstoken");t(!0);try{const h=await ue.post("/api/updateemployee",a,{headers:{Authorization:`Bearer ${u}`}});console.log("Query:",h),J.success(h.data.message,{autoClose:1200}),l(null),p(g),x(!1)}catch(h){console.log(h),h.response?J.warn(h.response.data.message,{autoClose:1200}):h.request?console.error("No response from server:",h.request):console.error("Error:",h.message)}finally{t(!1)}},Vs=async({employeeId:a,setisload:r})=>{if(!a){alert("All fileds are Required");return}const l=localStorage.getItem("emstoken");r(!0);try{const t=await ue.post("/api/deleteemployee",{employeeId:a},{headers:{Authorization:`Bearer ${l}`}});console.log("Query:",t),J.success(t.data.message,{autoClose:1200})}catch(t){console.log(t),t.response?J.warn(t.response.data.message,{autoClose:1200}):t.request?console.error("No response from server:",t.request):console.error("Error:",t.message)}finally{r(!1)}},Qs=({viewEmployee:a})=>{var u,h,T,D,I,S,z;const[r,l]=c.useState(!1),[t,p]=c.useState(null),[x,g]=c.useState(1);return c.useEffect(()=>{(async()=>{const P=localStorage.getItem("emstoken");l(!0);try{const j=await ue.get(`/api/getemployee?empid=${a}`,{headers:{Authorization:`Bearer ${P}`}});p(j.data)}catch(j){console.log(j),j.response?J.warn(j.response.data.message,{autoClose:1200}):j.request?console.error("No response from server:",j.request):console.error("Error:",j.message)}finally{l(!1)}})()},[]),e.jsx(e.Fragment,{children:r?e.jsxs("div",{className:"w-full h-[300px] flex gap-5 flex-col justify-center items-center bg-white",children:[e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"animate-spin",style:{animationDuration:"2.5s"},size:50,color:"teal"}),e.jsx(qe,{className:"absolute -bottom-4 left-0 animate-spin",style:{animationDuration:"3s"},size:20,color:"teal"})]}),e.jsx("p",{className:"text-teal-600",children:"loading..."})]}):e.jsxs("div",{className:"max-w-3xl mx-auto bg-white flex flex-col shadow rounded-lg p-2 md:p-4 ",children:[e.jsx("h2",{className:"text-xl mx-auto font-semibold text-gray-700 mb-4",children:"Employee Details"}),e.jsxs("div",{className:"flex gap-4  pb-2 md:items-start",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full border-2 border-teal-500 border-dashed p-[2px] flex items-center justify-center overflow-hidden",children:t!=null&&t.profileimage?e.jsx("img",{src:t.profileimage,alt:"Profile",className:"w-full h-full object-cover rounded-full"}):e.jsx(ss,{className:"text-3xl text-gray-500"})}),e.jsxs("div",{className:"md:flex-1 w-auto",children:[e.jsx("h3",{className:"text-l md:text-xl capitalize font-bold text-gray-800",children:(u=t==null?void 0:t.userid)==null?void 0:u.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(h=t==null?void 0:t.userid)==null?void 0:h.role}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded",children:t==null?void 0:t.department.department}),e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded",children:"active"})]}),e.jsxs("div",{className:"hidden md:flex mt-3 justify-start flex-wrap text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Re,{className:"text-gray-500 lowercase"})," ",(T=t==null?void 0:t.userid)==null?void 0:T.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Me,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500"})," ",Se((D=t==null?void 0:t.userid)==null?void 0:D.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ID: emp0002"]})]})]})]}),e.jsxs("div",{className:"md:hidden mt-3 justify-start flex flex-wrap text-[12px] md:text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Re,{className:"text-gray-500 lowercase"})," ",(I=t==null?void 0:t.userid)==null?void 0:I.email]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Me,{className:"text-gray-500"})," ",(t==null?void 0:t.phone)||"N/A"]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx(Te,{className:"text-gray-500"})," ",Se((S=t==null?void 0:t.userid)==null?void 0:S.createdAt).format("DD MMM, YYYY")]}),e.jsxs("div",{className:"flex w-1/2 items-center gap-2",children:[e.jsx($e,{className:"text-gray-500"})," ID: emp0002"]})]}),e.jsxs("div",{className:"pt-1 capitalize",children:[e.jsxs("div",{className:"flex gap-2 md:gap-6 bg-slate-200 p-1 mt-2 text-[12px] md:text-sm font-medium text-gray-700",children:[e.jsx("div",{onClick:()=>g(1),className:`${x==1?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Personal Info"}),e.jsx("div",{onClick:()=>g(2),className:`${x==2?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Employment"}),e.jsx("div",{onClick:()=>g(3),className:`${x==3?"bg-white":"text-gray-400"} w-1/3 cursor-pointer py-1.5 text-center rounded`,children:"Documents & Skills"})]}),x==1&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ts,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Date of Birth"}),e.jsx("div",{children:t!=null&&t.dob?Se(t==null?void 0:t.dob).format("DD MMM,YYYY"):"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(as,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Address"}),e.jsx("div",{children:(t==null?void 0:t.address)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ns,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Emergency Contact"}),e.jsx("div",{children:(t==null?void 0:t.Emergencyphone)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Blood Group"}),e.jsx("div",{children:(t==null?void 0:t.bloodGroup)||"N/A"})]})]})]}),x==2&&e.jsxs("div",{className:"mt-2 grid grid-cols-2 max-h-[300px] overflow-y-auto md:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(js,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Position"}),e.jsx("div",{children:(t==null?void 0:t.designation)||"Accounts"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(rs,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Department"}),e.jsx("div",{children:((z=t==null?void 0:t.department)==null?void 0:z.department)||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(os,{className:"mt-1 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Salary"}),e.jsx("div",{children:(t==null?void 0:t.salary)||"N/A"})]})]})]}),x==3&&e.jsxs("div",{className:"mt-2 p-2 grid grid-cols-1 max-h-[300px] overflow-y-auto sm:grid-cols-2 gap-4 text-[12px] md:text-sm text-gray-700",children:[e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Education"}),t.education.length>0?t.education.map(b=>e.jsxs("div",{className:"relative my-1 pl-2 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:b.degree}),e.jsx("p",{className:"text-gray-700",children:b.institution}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:b.date}),e.jsx("span",{className:"absolute w-0.5 h-full bg-amber-800 top-0 left-0"})]})):e.jsx("div",{children:"No Data found"})]}),e.jsxs("div",{className:"rounded border border-gray-300 bg-white p-2 md:p-4 flex flex-col gap-1",children:[e.jsx("h3",{className:"font-bold",children:"Achievement"}),t.achievements.length>0?t.achievements.map(b=>e.jsxs("div",{className:"relative my-1 pl-5 rounded overflow-hidden",children:[e.jsx("p",{className:"text-gray-700 font-semibold",children:b.title}),e.jsx("p",{className:"text-gray-700",children:b.description}),e.jsx("p",{className:"text-gray-500 text-[10px]",children:b.date}),e.jsxs("span",{className:"absolute top-1 -left-0",children:[" ",e.jsx(vs,{size:18,color:"orange"})," "]}),e.jsx("span",{className:"absolute w-0.5 h-full bg-blue-500 top-0 right-0"})]})):e.jsx("div",{children:"No Achievement found"})]})]})]})]})})},jt=()=>{var Pe,ke;const[a,r]=c.useState(!1),[l,t]=c.useState(!1),[p,x]=c.useState([]),[g,u]=c.useState([]),[h,T]=c.useState(!1),[D,I]=c.useState(!1),[S,z]=c.useState(!1),[b,P]=c.useState(null),[j,w]=c.useState(null),[k,A]=c.useState(null),{handleImage:_}=ws(),{department:$,branch:E,employee:v,profile:H}=is(s=>s.user),[q,f]=c.useState({userid:"",pass:""}),[m,W]=c.useState({searchText:"",branch:"all",department:"all"}),L="https://res.cloudinary.com/dusxlxlvm/image/upload/v1753113610/ems/assets/employee_fi3g5p.webp";c.useEffect(()=>{W(s=>({...s,department:"all"}))},[m.branch]);let Y=ls();const B={employeeId:"",branchId:"",department:"",employeeName:"",email:"",username:"",designation:"",password:"",phone:"",address:"",gender:"male",bloodGroup:"",dob:"",Emergencyphone:"",skills:[],maritalStatus:!0,salary:0,achievements:[],education:[]},[i,C]=c.useState(B);c.useEffect(()=>{$.length>0&&u($.filter(s=>s.branchId._id==m.branch))},[m.branch]);const F=(s,n,o,U)=>{const V=[...i[n]];V[o][U]=s.target.value,C(Z=>({...Z,[n]:V}))},me=s=>{const n=s==="achievements"?{title:"",description:"",date:""}:{degree:"",institution:"",date:""};C(o=>({...o,[s]:[...o[s],n]}))},pe=(s,n)=>{const o=i[s].filter((U,V)=>V!==n);C(U=>({...U,[s]:o}))},Ne=Ae("employee",2),xe=Ae("employee",3),Ce=Ae("employee",4);c.useEffect(()=>{if((v==null?void 0:v.length)<1)return;let s=1;const n=v==null?void 0:v.map(o=>({id:o._id,sno:s++,rawname:o.userid.name,name:e.jsxs("div",{className:"flex items-center capitalize gap-3 ",children:[e.jsx(Be,{src:o.profileimage||L,alt:o.employeename,children:!o.profileimage&&L}),e.jsx(Q,{children:e.jsx(de,{variant:"body2",children:o.userid.name})})]}),email:o.userid.email,branch:o.branchId,department:o.department.department,departmentid:o.department._id,action:e.jsxs("div",{className:"action flex gap-2.5",children:[e.jsx("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"View Profile",onClick:()=>{A(o._id),T(!0)},children:e.jsx(ps,{})}),e.jsx("span",{className:"eye edit text-[18px] text-amber-500 cursor-pointer",title:"Attandence Report",onClick:()=>Y(`/dashboard/performance/${o.userid._id}`),children:e.jsx(gs,{})}),xe&&e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>he(o),children:e.jsx(We,{})}),xe&&e.jsxs("span",{className:"eye edit text-[18px] text-green-500 cursor-pointer",title:"Reset Password",onClick:()=>{f({...q,userid:o.userid._id}),I(!0)},children:[e.jsx(ds,{})," "]}),Ce&&e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>Je(o._id),children:e.jsx(bs,{})})]})}));x(n)},[v]);const y=(s,n)=>{C({...i,[n]:s.target.value})},le=(s,n)=>{W(o=>({...o,[s]:n}))},d=s=>{const n=s.target.files[0];if(w(n),n){const o=new FileReader;o.onloadend=()=>{P(o.result)},o.readAsDataURL(n)}else P(null)},R=async s=>{s.preventDefault();const n=new FormData;if(n.append("employeeName",i.employeeName),n.append("branchId",i.branchId),n.append("department",i.department),n.append("username",i.username),n.append("email",i.email),n.append("password",i.password),n.append("designation",i.designation),n.append("salary",i.salary),j){let o=await _(400,j);n.append("photo",o)}await Hs({formData:n,setisload:t,setInp:C,setopenmodal:r,init:B,resetPhoto:O})},M=async()=>{const s=new FormData;if(Object.keys(i).forEach(n=>{const o=i[n];Array.isArray(o)||typeof o=="object"?s.append(n,JSON.stringify(o)):s.append(n,o)}),j){let n=await _(600,j);s.append("photo",n)}await Ys({formData:s,setisload:t,setEmployeePhoto:w,setInp:C,setopenmodal:r,init:B,resetPhoto:O})},O=()=>{P(null),w(null)},te=async s=>{s.preventDefault();try{const n=localStorage.getItem("emstoken"),o=await ue.post("/api/updatepassword",{pass:q},{headers:{Authorization:`Bearer ${n}`}});f({userid:"",pass:""}),I(!1),console.log("Query:",o),J.success(o.data.message,{autoClose:1200})}catch(n){console.log(n),n.response?J.warn(n.response.data.message,{autoClose:1200}):n.request?console.error("No response from server:",n.request):console.error("Error:",n.message)}},he=s=>{var n,o,U;z(!0),C({employeeId:s._id,branchId:s.branchId,department:s.department._id,employeeName:(n=s==null?void 0:s.userid)==null?void 0:n.name,email:(o=s==null?void 0:s.userid)==null?void 0:o.email,username:(U=s==null?void 0:s.userid)==null?void 0:U.name,dob:s==null?void 0:s.dob,salary:s==null?void 0:s.salary,designation:s==null?void 0:s.designation,phone:s==null?void 0:s.phone,address:(s==null?void 0:s.address)||"",gender:(s==null?void 0:s.gender)||"male",bloodGroup:s==null?void 0:s.bloodGroup,Emergencyphone:s==null?void 0:s.Emergencyphone,skills:s==null?void 0:s.skills,maritalStatus:(s==null?void 0:s.maritalStatus)||!0,achievements:s==null?void 0:s.achievements,education:s==null?void 0:s.education}),s.profileimage&&P(s.profileimage),r(!0)},Je=s=>{cs({title:"Are you sure?",text:"Once deleted, you will not be able to recover this",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{n&&Vs({employeeId:s,setisload:t})})},Xe={headCells:{style:{backgroundColor:"teal",fontWeight:"bold",fontSize:"14px",color:"white",padding:"0px 5px"}},rows:{style:{minHeight:"48px"}}},De=c.useRef(null),ze=p==null?void 0:p.filter(s=>{var ge;const n=((ge=s.rawname)==null?void 0:ge.toLowerCase())||"",o=s.departmentid||"",U=s.branch||"",V=m.searchText.trim()===""||n.includes(m.searchText.toLowerCase()),Z=m.department==="all"||o===m.department,ee=m.branch==="all"||U===m.branch;return V&&Z&&ee}),Ke=()=>{const s=["S.No","Name","Email","Department"],n=ze.map((ee,ge)=>[ge+1,ee.rawname,ee.email,ee.department]),o=[s,...n].map(ee=>ee.join(",")).join(`
`),U=new Blob([o],{type:"text/csv"}),V=URL.createObjectURL(U),Z=document.createElement("a");Z.href=V,Z.download="Employee List.csv",Z.click(),URL.revokeObjectURL(V)};return e.jsxs("div",{className:"employee p-1",children:[e.jsxs("div",{className:"flex gap-5 justify-between items-center flex-wrap",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mt-1 w-full md:w-fit",children:[e.jsx(N,{size:"small",className:"md:col-span-1 md:max-w-[160px] col-span-2",value:m.searchText,onChange:s=>le("searchText",s.target.value),InputProps:{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(xs,{})})},label:"Search Employee"}),e.jsxs(ae,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(ne,{children:"Branch"}),e.jsxs(re,{label:"Branch",value:m.branch,input:e.jsx(Oe,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(Fe,{fontSize:"small"})}),label:"Branch"}),onChange:s=>le("branch",s.target.value),children:[e.jsx(G,{value:"all",children:"All"}),E==null?void 0:E.map(s=>e.jsx(G,{value:s._id,children:s.name},s._id))]})]}),e.jsxs(ae,{size:"small",className:" md:max-w-[160px] col-span-1",children:[e.jsx(ne,{children:"Department"}),e.jsxs(re,{label:"Department",disabled:m.branch==="all",value:m.department,input:e.jsx(Oe,{startAdornment:e.jsx(Ee,{position:"start",children:e.jsx(Fe,{fontSize:"small"})}),label:"Department"}),onChange:s=>le("department",s.target.value),children:[e.jsx(G,{value:"all",children:"All"}),g.length>0?g.map(s=>e.jsx(G,{value:s._id,children:s.department},s._id)):e.jsx(G,{disabled:!0,children:"No departments found"})]})]})]}),e.jsxs("div",{className:"flex gap-1 w-full md:w-fit",children:[e.jsx(K,{variant:"outlined",className:"flex-1 md:w-fit md:flex-none",onClick:Ke,startIcon:e.jsx(us,{}),children:"Export"}),Ne&&e.jsx(K,{variant:"contained",className:"flex-[2] md:w-fit md:flex-none",startIcon:e.jsx(hs,{}),onClick:()=>r(!0),children:"Add Employee"})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(ms,{columns:Os,data:ze,pagination:!0,customStyles:Xe,highlightOnHover:!0})}),e.jsx(ye,{open:a,onClose:()=>{r(!1),z(!1),C(B),O()},children:e.jsx("div",{className:"membermodal",children:e.jsxs("div",{className:"whole",children:[e.jsx("div",{className:"modalhead",children:S?"Update Employee":"Add Employee"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsxs(ae,{fullWidth:!0,required:!0,size:"small",children:[e.jsx(ne,{children:"Branch"}),e.jsx(re,{value:i.branchId,label:"branch",onChange:s=>y(s,"branchId"),children:E==null?void 0:E.map(s=>e.jsx(G,{value:s._id,children:s.name},s._id))})]}),e.jsxs(ae,{disabled:!i.branchId,fullWidth:!0,required:!0,size:"small",children:[e.jsx(ne,{children:"Department"}),e.jsx(re,{value:i.department,label:"Department",onChange:s=>y(s,"department"),children:($==null?void 0:$.filter(s=>s.branchId._id===i.branchId).length)>0?$.filter(s=>s.branchId._id===i.branchId).map(s=>e.jsx(G,{value:s._id,children:s.department},s._id)):e.jsx(G,{disabled:!0,children:"No departments found"})})]}),e.jsxs(Q,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:i.employeeName,onChange:s=>y(s,"employeeName"),label:"Name",size:"small"}),e.jsx(N,{fullWidth:!0,required:!0,value:i.email,onChange:s=>y(s,"email"),label:"email",size:"small"})]}),e.jsxs(Q,{sx:{width:"100%",gap:2},children:[e.jsx(N,{fullWidth:!0,required:!0,value:i.username,onChange:s=>y(s,"username"),label:"username",size:"small"}),e.jsx(N,{fullWidth:!0,disabled:S,value:i.password,onChange:s=>y(s,"password"),label:"password",size:"small"})]}),e.jsx(Q,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,value:i.designation,onChange:s=>y(s,"designation"),label:"Designation",size:"small"})}),e.jsx(Q,{sx:{width:"100%",gap:2},children:e.jsx(N,{fullWidth:!0,value:i.salary,onChange:s=>y(s,"salary"),label:"salary",size:"small"})}),e.jsxs("div",{className:"mt-1 gap-2 flex items-center relative",children:[e.jsx("input",{style:{display:"none"},type:"file",onChange:d,ref:De,accept:"image/*",name:"",id:"fileInput"}),b?e.jsx("img",{src:b,alt:"Preview",className:"mt-2 w-[100px] h-[100px] rounded-full object-cover"}):e.jsx(Be,{sx:{width:100,height:100},alt:i.employeeName,src:"/static/images/avatar/1.jpg"}),e.jsx("span",{onClick:()=>De.current.click(),className:"absolute -bottom-1 -right-1 rounded-full bg-teal-900 text-white p-1",children:e.jsx(We,{size:18})})]}),S&&e.jsxs(He,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Ve,{expandIcon:e.jsx(Ge,{}),children:e.jsx(de,{variant:"subtitle1",children:"Personal Details (optional)"})}),e.jsx(Ye,{children:e.jsxs(Q,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsx(N,{fullWidth:!0,value:i.phone,onChange:s=>y(s,"phone"),label:"Phone",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.Emergencyphone,onChange:s=>y(s,"Emergencyphone"),label:"Emergencyphone",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.address,onChange:s=>y(s,"address"),label:"Address",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.bloodGroup,onChange:s=>y(s,"bloodGroup"),label:"Blood Group",size:"small"}),e.jsx(N,{fullWidth:!0,value:i.dob,type:"date",onChange:s=>y(s,"dob"),label:"Date of Birth",size:"small"}),e.jsxs(ae,{size:"small",children:[e.jsx(ne,{children:"maritalStatus"}),e.jsxs(re,{label:"maritalStatus",value:i.maritalStatus,onChange:s=>y(s,"maritalStatus"),children:[e.jsx(G,{selected:!0,value:!0,children:"Married"}),e.jsx(G,{selected:!0,value:!1,children:"Unmarried"})]})]}),e.jsxs(ae,{size:"small",children:[e.jsx(ne,{children:"Gender"}),e.jsxs(re,{label:"Gender",value:i.gender,onChange:s=>y(s,"gender"),children:[e.jsx(G,{selected:!0,value:"male",children:"Male"}),e.jsx(G,{selected:!0,value:"female",children:"female"})]})]})]})})]}),S&&e.jsxs(He,{sx:{width:"100%"},className:"flex flex-col",children:[e.jsx(Ve,{expandIcon:e.jsx(Ge,{}),children:e.jsx(de,{variant:"subtitle1",children:"Document & Skills (optional)"})}),e.jsxs(Ye,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(Q,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2}}),e.jsx(de,{fontWeight:"bold",children:"Achievements"}),(Pe=i==null?void 0:i.achievements)==null?void 0:Pe.map((s,n)=>e.jsxs(Q,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Title",size:"small",value:s.title,onChange:o=>F(o,"achievements",n,"title")}),e.jsx(N,{label:"Description",size:"small",value:s.description,onChange:o=>F(o,"achievements",n,"description")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:o=>F(o,"achievements",n,"date")}),e.jsx(Ue,{size:24,title:"Delete this",onClick:()=>pe("achievements",n)})]},n)),e.jsx(K,{onClick:()=>me("achievements"),variant:"outlined",children:"Add Achievement"}),e.jsx(de,{fontWeight:"bold",children:"Education"}),(ke=i==null?void 0:i.education)==null?void 0:ke.map((s,n)=>e.jsxs(Q,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:2,alignItems:"center"},children:[e.jsx(N,{label:"Degree",size:"small",value:s.degree,onChange:o=>F(o,"education",n,"degree")}),e.jsx(N,{label:"Institution",size:"small",value:s.institution,onChange:o=>F(o,"education",n,"institution")}),e.jsx(N,{type:"date",size:"small",label:"Date",InputLabelProps:{shrink:!0},value:s.date,onChange:o=>F(o,"education",n,"date")}),e.jsx(Ue,{size:24,title:"Delete this",onClick:()=>pe("education",n)})]},n)),e.jsx(K,{onClick:()=>me("education"),variant:"outlined",children:"Add Education"})]})]})]}),e.jsxs("div",{className:"modalfooter",children:[S?e.jsx(K,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(_e,{}),variant:"contained",onClick:M,children:"Update"}):e.jsx(K,{sx:{mr:2},loading:l,loadingPosition:"end",endIcon:e.jsx(_e,{}),variant:"contained",onClick:R,children:"Add"}),e.jsx(K,{size:"small",onClick:()=>{r(!1),z(!1),C(B),O()},variant:"outlined",children:"Cancel"})]})]})})}),e.jsx(ye,{open:h,onClose:()=>{T(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsx(Qs,{viewEmployee:k})})}),e.jsx(ye,{open:D,onClose:()=>{I(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:te,children:[e.jsx("h2",{children:"Reset Passowrd"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsx(N,{fullWidth:!0,required:!0,value:q.pass,onChange:s=>f({...q,pass:s.target.value}),label:"Passowrd",size:"small"}),e.jsx(K,{variant:"contained",sx:{mr:2},type:"submit",children:"Reset Password"})]})]})})})]})};export{jt as default};
