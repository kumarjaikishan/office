import{a5 as Pe,r as b,a6 as ze,j as e,a7 as ke,a8 as De,a9 as Se,aa as Oe,ab as Be,ac as Te,ad as Me,ae as We,af as Le,ag as pe,T as Y,ah as Re,ai as te,aj as be,u as me,g as ge,b as C,F as ee,I as se,S as Q,M as q,A as oe,l as Ae,O as ie,V as re,B as D,c as F,y as M,m as U,R as ye,W as _e,i as Fe,C as Ge,a0 as Ie,a1 as de,ak as qe,U as Ue,al as He,a2 as V,a3 as Z,k as Ve}from"./index-IHelaw-x.js";import{C as ne}from"./Checkbox-BksB3pid.js";import{F as Ze}from"./FormControlLabel-305zdSzv.js";import{u as Ee,I as je}from"./attandencehelper-DyV9hAIG.js";import{A as xe,a as Je}from"./index-CZNv2t76.js";import{u as $e}from"./imageresizer-D4I-KFLq.js";import{s as Qe}from"./styled---Vrnup5.js";import{u as Xe}from"./useThemeProps-BibrL_Td.js";const Ke=(t,r)=>t.filter(d=>r.includes(d)),X=(t,r,d)=>{const o=t.keys[0];Array.isArray(r)?r.forEach((n,c)=>{d((m,j)=>{c<=t.keys.length-1&&(c===0?Object.assign(m,j):m[t.up(t.keys[c])]=j)},n)}):r&&typeof r=="object"?(Object.keys(r).length>t.keys.length?t.keys:Ke(t.keys,Object.keys(r))).forEach(c=>{if(t.keys.includes(c)){const m=r[c];m!==void 0&&d((j,P)=>{o===c?Object.assign(j,P):j[t.up(c)]=P},m)}}):(typeof r=="number"||typeof r=="string")&&d((n,c)=>{Object.assign(n,c)},r)};function ce(t){return`--Grid-${t}Spacing`}function ue(t){return`--Grid-parent-${t}Spacing`}const ve="--Grid-columns",J="--Grid-parent-columns",Ye=({theme:t,ownerState:r})=>{const d={};return X(t.breakpoints,r.size,(o,n)=>{let c={};n==="grow"&&(c={flexBasis:0,flexGrow:1,maxWidth:"100%"}),n==="auto"&&(c={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof n=="number"&&(c={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${n} / var(${J}) - (var(${J}) - ${n}) * (var(${ue("column")}) / var(${J})))`}),o(d,c)}),d},es=({theme:t,ownerState:r})=>{const d={};return X(t.breakpoints,r.offset,(o,n)=>{let c={};n==="auto"&&(c={marginLeft:"auto"}),typeof n=="number"&&(c={marginLeft:n===0?"0px":`calc(100% * ${n} / var(${J}) + var(${ue("column")}) * ${n} / var(${J}))`}),o(d,c)}),d},ss=({theme:t,ownerState:r})=>{if(!r.container)return{};const d={[ve]:12};return X(t.breakpoints,r.columns,(o,n)=>{const c=n??12;o(d,{[ve]:c,"> *":{[J]:c}})}),d},ts=({theme:t,ownerState:r})=>{if(!r.container)return{};const d={};return X(t.breakpoints,r.rowSpacing,(o,n)=>{var m;const c=typeof n=="string"?n:(m=t.spacing)==null?void 0:m.call(t,n);o(d,{[ce("row")]:c,"> *":{[ue("row")]:c}})}),d},as=({theme:t,ownerState:r})=>{if(!r.container)return{};const d={};return X(t.breakpoints,r.columnSpacing,(o,n)=>{var m;const c=typeof n=="string"?n:(m=t.spacing)==null?void 0:m.call(t,n);o(d,{[ce("column")]:c,"> *":{[ue("column")]:c}})}),d},rs=({theme:t,ownerState:r})=>{if(!r.container)return{};const d={};return X(t.breakpoints,r.direction,(o,n)=>{o(d,{flexDirection:n})}),d},ns=({ownerState:t})=>({minWidth:0,boxSizing:"border-box",...t.container&&{display:"flex",flexWrap:"wrap",...t.wrap&&t.wrap!=="wrap"&&{flexWrap:t.wrap},gap:`var(${ce("row")}) var(${ce("column")})`}}),ls=t=>{const r=[];return Object.entries(t).forEach(([d,o])=>{o!==!1&&o!==void 0&&r.push(`grid-${d}-${String(o)}`)}),r},os=(t,r="xs")=>{function d(o){return o===void 0?!1:typeof o=="string"&&!Number.isNaN(Number(o))||typeof o=="number"&&o>0}if(d(t))return[`spacing-${r}-${String(t)}`];if(typeof t=="object"&&!Array.isArray(t)){const o=[];return Object.entries(t).forEach(([n,c])=>{d(c)&&o.push(`spacing-${n}-${String(c)}`)}),o}return[]},is=t=>t===void 0?[]:typeof t=="object"?Object.entries(t).map(([r,d])=>`direction-${r}-${d}`):[`direction-xs-${String(t)}`];function ds(t,r){t.item!==void 0&&delete t.item,t.zeroMinWidth!==void 0&&delete t.zeroMinWidth,r.keys.forEach(d=>{t[d]!==void 0&&delete t[d]})}const cs=Be(),ms=Qe("div",{name:"MuiGrid",slot:"Root"});function us(t){return Xe({props:t,name:"MuiGrid",defaultTheme:cs})}function hs(t={}){const{createStyledComponent:r=ms,useThemeProps:d=us,useTheme:o=Pe,componentName:n="MuiGrid"}=t,c=(w,h)=>{const{container:i,direction:p,spacing:A,wrap:k,size:T}=w,I={root:["root",i&&"container",k!=="wrap"&&`wrap-xs-${String(k)}`,...is(p),...ls(T),...i?os(A,h.breakpoints.keys[0]):[]]};return Se(I,v=>Oe(n,v),{})};function m(w,h,i=()=>!0){const p={};return w===null||(Array.isArray(w)?w.forEach((A,k)=>{A!==null&&i(A)&&h.keys[k]&&(p[h.keys[k]]=A)}):typeof w=="object"?Object.keys(w).forEach(A=>{const k=w[A];k!=null&&i(k)&&(p[A]=k)}):p[h.keys[0]]=w),p}const j=r(ss,as,ts,Ye,rs,ns,es),P=b.forwardRef(function(h,i){const p=o(),A=d(h),k=ze(A);ds(k,p.breakpoints);const{className:T,children:I,columns:v=12,container:a=!1,component:x="div",direction:g="row",wrap:$="wrap",size:O={},offset:W={},spacing:s=0,rowSpacing:y=s,columnSpacing:f=s,unstable_level:N=0,...E}=k,L=m(O,p.breakpoints,z=>z!==!1),R=m(W,p.breakpoints),B=h.columns??(N?void 0:v),G=h.spacing??(N?void 0:s),he=h.rowSpacing??h.spacing??(N?void 0:y),l=h.columnSpacing??h.spacing??(N?void 0:f),u={...k,level:N,columns:B,container:a,direction:g,wrap:$,spacing:G,rowSpacing:he,columnSpacing:l,size:L,offset:R},S=c(u,p);return e.jsx(j,{ref:i,as:x,ownerState:u,className:ke(S.root,T),...E,children:b.Children.map(I,z=>{var _;return b.isValidElement(z)&&De(z,["Grid"])&&a&&z.props.container?b.cloneElement(z,{unstable_level:((_=z.props)==null?void 0:_.unstable_level)??N+1}):z})})});return P.muiName="Grid",P}const ps=hs({createStyledComponent:Te("div",{name:"MuiGrid",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:d}=t;return[r.root,d.container&&r.container]}}),componentName:"MuiGrid",useThemeProps:t=>Me({props:t,name:"MuiGrid"}),useTheme:We}),fs=t=>{const{classes:r,inset:d,primary:o,secondary:n,dense:c}=t;return Se({root:["root",d&&"inset",c&&"dense",o&&n&&"multiline"],primary:["primary"],secondary:["secondary"]},Re,r)},xs=Te("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:d}=t;return[{[`& .${te.primary}`]:r.primary},{[`& .${te.secondary}`]:r.secondary},r.root,d.inset&&r.inset,d.primary&&d.secondary&&r.multiline,d.dense&&r.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${be.root}:where(& .${te.primary})`]:{display:"block"},[`.${be.root}:where(& .${te.secondary})`]:{display:"block"},variants:[{props:({ownerState:t})=>t.primary&&t.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:t})=>t.inset,style:{paddingLeft:56}}]}),le=b.forwardRef(function(r,d){const o=Me({props:r,name:"MuiListItemText"}),{children:n,className:c,disableTypography:m=!1,inset:j=!1,primary:P,primaryTypographyProps:w,secondary:h,secondaryTypographyProps:i,slots:p={},slotProps:A={},...k}=o,{dense:T}=b.useContext(Le);let I=P??n,v=h;const a={...o,disableTypography:m,inset:j,primary:!!I,secondary:!!v,dense:T},x=fs(a),g={slots:p,slotProps:{primary:w,secondary:i,...A}},[$,O]=pe("root",{className:ke(x.root,c),elementType:xs,externalForwardedProps:{...g,...k},ownerState:a,ref:d}),[W,s]=pe("primary",{className:x.primary,elementType:Y,externalForwardedProps:g,ownerState:a}),[y,f]=pe("secondary",{className:x.secondary,elementType:Y,externalForwardedProps:g,ownerState:a});return I!=null&&I.type!==Y&&!m&&(I=e.jsx(W,{variant:T?"body2":"body1",component:s!=null&&s.variant?void 0:"span",...s,children:I})),v!=null&&v.type!==Y&&!m&&(v=e.jsx(y,{variant:"body2",color:"textSecondary",...f,children:v})),e.jsxs($,{...O,children:[I,v]})}),we=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],gs=({setopenviewmodal:t,employee:r,company:d,editbranch:o,editbranchdata:n})=>{const c={id:"",name:"",location:"",companyId:"",managerIds:[],defaultsetting:!0,setting:{officeTime:{in:"10:00",out:"18:00",breakMinutes:30},gracePeriod:{lateEntryMinutes:10,earlyExitMinutes:10},workingMinutes:{fullDay:480,halfDay:240,shortDayThreshold:270,overtimeAfterMinutes:480},weeklyOffs:[0],attendanceRules:{considerEarlyEntryBefore:"09:50",considerLateEntryAfter:"10:10",considerEarlyExitBefore:"17:50",considerLateExitAfter:"18:15"}}},[m,j]=b.useState(c),P=me(),{adminManager:w}=ge(a=>a.user),[h,i]=b.useState([]),p=localStorage.getItem("emstoken");b.useEffect(()=>{j(a=>({...a,companyId:d._id})),o&&j(a=>({...a,...n}))},[d,o]),b.useEffect(()=>{(w==null?void 0:w.length)>0&&i(w.filter(a=>a.role==="manager"))},[w]);const A=()=>{t(!1),j(c)},k=(a,x)=>{j(g=>({...g,[a]:x}))},T=(a,x,g)=>{j($=>({...$,setting:{...$.setting,[a]:{...$.setting[a],[x]:g}}}))},I=async()=>{var a,x;try{const g=await F.post("/api/addBranch",m,{headers:{Authorization:`Bearer ${p}`}});M.success(g.data.message),t(!1),P(U()),A()}catch(g){console.error(g),M.error(((x=(a=g==null?void 0:g.response)==null?void 0:a.data)==null?void 0:x.message)||"Error adding branch")}},v=async()=>{var a,x;try{const g=await F.post("/api/editBranch",m,{headers:{Authorization:`Bearer ${p}`}});M.success(g.data.message),P(U()),t(!1),A()}catch(g){console.error(g),M.error(((x=(a=g==null?void 0:g.response)==null?void 0:a.data)==null?void 0:x.message)||"Error editing branch")}};return e.jsxs("div",{className:"whole",children:[e.jsx("div",{className:"modalhead",children:o?"Edit Branch":"Add New Branch"}),e.jsxs("span",{className:"modalcontent",children:[e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx(C,{label:"Branch Name",fullWidth:!0,size:"small",value:m.name,onChange:a=>k("name",a.target.value),required:!0,helperText:"Enter the official branch name"}),e.jsx(C,{label:"Location",fullWidth:!0,size:"small",value:m.location,onChange:a=>k("location",a.target.value),helperText:"City, State or Address"}),e.jsxs(ee,{size:"small",fullWidth:!0,children:[e.jsx(se,{children:"Managers"}),e.jsx(Q,{multiple:!0,value:(m==null?void 0:m.managerIds)||[],onChange:a=>k("managerIds",a.target.value),input:e.jsx(ie,{label:"Managers"}),renderValue:a=>a.map(x=>{var g;return((g=h.find($=>$._id===x))==null?void 0:g.name)||"Unknown"}).join(", "),children:h&&h.length>0?h.map(a=>{var x;return e.jsxs(q,{value:a._id,children:[e.jsx(ne,{checked:(x=m==null?void 0:m.managerIds)==null?void 0:x.includes(a._id)}),e.jsx(oe,{src:a==null?void 0:a.profileImage,alt:a==null?void 0:a.name,children:!(a!=null&&a.profileImage)&&e.jsx(Ae,{})}),e.jsx(le,{className:"ml-2 capitalize",primary:a==null?void 0:a.name})]},a._id)}):e.jsx(q,{disabled:!0,value:"",children:e.jsx(le,{className:"ml-2 capitalize",primary:"No Manager Found"})})})]})]}),e.jsx(Ze,{control:e.jsx(ne,{checked:!m.defaultsetting,onChange:a=>j(x=>({...x,defaultsetting:!a.target.checked}))}),label:"Override company default attendance settings",sx:{mt:2}}),!m.defaultsetting&&e.jsx("div",{className:"border-primary border-2 border-dashed rounded mt-3 py-3 px-1",children:e.jsxs(re,{className:"mt-1 p-2 grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsx(C,{label:"Office Time In",type:"time",fullWidth:!0,size:"small",value:m.setting.officeTime.in,InputLabelProps:{shrink:!0},onChange:a=>T("officeTime","in",a.target.value),helperText:"Time when office hours begin"}),e.jsx(C,{label:"Office Time Out",type:"time",fullWidth:!0,size:"small",value:m.setting.officeTime.out,InputLabelProps:{shrink:!0},onChange:a=>T("officeTime","out",a.target.value),helperText:"Time when office hours end"}),e.jsx(C,{label:"Break Minutes",fullWidth:!0,type:"number",size:"small",value:m.setting.officeTime.breakMinutes,onChange:a=>T("officeTime","breakMinutes",Number(a.target.value)),helperText:"Total break time allowed during the day"}),e.jsx(C,{label:"Full Day Minutes",fullWidth:!0,type:"number",size:"small",value:m.setting.workingMinutes.fullDay,onChange:a=>T("workingMinutes","fullDay",Number(a.target.value)),helperText:"Total working minutes required for a full day"}),e.jsx(C,{label:"Half Day Minutes",fullWidth:!0,type:"number",size:"small",value:m.setting.workingMinutes.halfDay,onChange:a=>T("workingMinutes","halfDay",Number(a.target.value)),helperText:"Minimum minutes required for marking a half-day"}),e.jsx(C,{label:"Short Day Threshold (min)",fullWidth:!0,type:"number",size:"small",value:m.setting.workingMinutes.shortDayThreshold,onChange:a=>T("workingMinutes","shortDayThreshold",Number(a.target.value)),helperText:"Below this time is considered a short day"}),e.jsx(C,{label:"Overtime After Minutes",fullWidth:!0,type:"number",size:"small",value:m.setting.workingMinutes.overtimeAfterMinutes,onChange:a=>T("workingMinutes","overtimeAfterMinutes",Number(a.target.value)),helperText:"Time after which overtime calculation begins"}),e.jsxs(ee,{size:"small",fullWidth:!0,children:[e.jsx(se,{children:"Weekly Offs"}),e.jsx(Q,{multiple:!0,value:m.setting.weeklyOffs,onChange:a=>j(x=>({...x,setting:{...x.setting,weeklyOffs:a.target.value}})),input:e.jsx(ie,{label:"Weekly Offs"}),renderValue:a=>a.map(x=>{var g;return(g=we.find($=>$.value===x))==null?void 0:g.label}).join(", "),children:we.map(a=>e.jsxs(q,{value:a.value,children:[e.jsx(ne,{checked:m.setting.weeklyOffs.includes(a.value)}),e.jsx(le,{primary:a.label})]},a.value))})]}),Object.entries(m.setting.attendanceRules).map(([a,x])=>{const g=a.replace(/([A-Z])/g," $1").replace(/^./,O=>O.toUpperCase()),$={considerEarlyEntryBefore:"Considered early if punched before this time",considerLateEntryAfter:"Considered late if punched after this time",considerEarlyExitBefore:"Considered early exit if leaving before this time",considerLateExitAfter:"Considered late exit if leaving after this time"};return e.jsx(C,{fullWidth:!0,size:"small",label:g,type:"time",value:x,onChange:O=>j(W=>({...W,setting:{...W.setting,attendanceRules:{...W.setting.attendanceRules,[a]:O.target.value}}})),helperText:$[a]},a)})]})})]}),e.jsxs("div",{className:"modalfooter",children:[e.jsx(D,{variant:"outlined",onClick:A,children:"Cancel"}),o?e.jsx(D,{variant:"contained",onClick:v,children:"Save"}):e.jsx(D,{variant:"contained",onClick:I,children:"Add Branch"})]})]})},ys=async({companyinp:t,setisload:r})=>{const d=localStorage.getItem("emstoken");r(!0);try{const o=await F.post("/api/addcompany",{name:t.name,industry:t.industry},{headers:{Authorization:`Bearer ${d}`}});console.log("Query:",o),M.success(o.data.message,{autoClose:1200})}catch(o){console.log(o),o.response?M.warn(o.response.data.message,{autoClose:1200}):o.request?console.error("No response from server:",o.request):console.error("Error:",o.message)}finally{r(!1)}},bs=[{name:"S.no",selector:t=>t.sno,width:"40px"},{name:"Branch",selector:t=>t.branch},{name:"Department",selector:t=>t.dep_name},{name:"Action",selector:t=>t.action,width:"80px"}],js=async({inp:t,setisload:r,setInp:d,setopenmodal:o,init:n,dispatch:c})=>{console.log(t);const{branchId:m,department:j,description:P}=t;if(!j){alert("Please fill in both fields");return}const w=localStorage.getItem("emstoken");r(!0);try{const h=await F.post("/api/adddepartment",{department:j,branchId:m,description:P},{headers:{Authorization:`Bearer ${w}`}});c(U()),M.success(h.data.message,{autoClose:1200}),d(n),o(!1)}catch(h){console.log(h),h.response?M.warn(h.response.data.message,{autoClose:1200}):h.request?console.error("No response from server:",h.request):console.error("Error:",h.message)}finally{r(!1)}},vs=async({inp:t,setisload:r,setInp:d,setopenmodal:o,init:n,dispatch:c})=>{const{departmentId:m,department:j,description:P}=t;if(!j||!m){alert("All fileds are Required");return}const w=localStorage.getItem("emstoken");r(!0);try{const h=await F.post("/api/updatedepartment",{departmentId:m,department:j,description:P},{headers:{Authorization:`Bearer ${w}`}});c(U()),M.success(h.data.message,{autoClose:1200}),d(n),o(!1)}catch(h){console.log(h),h.response?M.warn(h.response.data.message,{autoClose:1200}):h.request?console.error("No response from server:",h.request):console.error("Error:",h.message)}finally{r(!1)}},ws=async({departmentId:t,setisload:r,dispatch:d})=>{if(!t){alert("All fileds are Required");return}const o=localStorage.getItem("emstoken");r(!0);try{const n=await F.post("/api/deletedepartment",{departmentId:t},{headers:{Authorization:`Bearer ${o}`}});d(U()),M.success(n.data.message,{autoClose:1200})}catch(n){console.log(n),n.response?M.warn(n.response.data.message,{autoClose:1200}):n.request?console.error("No response from server:",n.request):console.error("Error:",n.message)}finally{r(!1)}},Ns=()=>{const[t,r]=b.useState(!1),[d,o]=b.useState(!1),[n,c]=b.useState([]),[m,j]=b.useState(!1),[P,w]=b.useState([]),{branch:h,department:i}=ge(s=>s.user),[p,A]=b.useState({branch:"all",department:" "}),k=p.branch!=="all"||p.department.trim()!=="",T=me();b.useEffect(()=>{if(!n||n.length===0)return;const s=n.filter(y=>{var E;const f=p.branch==="all"||y.branchid===p.branch,N=p.department.trim()===""||((E=y.dep_name)==null?void 0:E.toLowerCase().includes(p.department.trim().toLowerCase()));return f&&N});w(s)},[p,n]);const I={departmentId:"",branchId:"",department:"",description:""},[v,a]=b.useState(I);b.useEffect(()=>{if(i.length>0){let s=1;const y=i.map(f=>{var N,E;return{id:f._id,sno:s++,branchid:(N=f==null?void 0:f.branchId)==null?void 0:N._id,branch:(E=f==null?void 0:f.branchId)==null?void 0:E.name,dep_name:f==null?void 0:f.department,action:e.jsxs("div",{className:"action",children:[e.jsx("span",{className:"edit",title:"Edit",onClick:()=>$(f),children:e.jsx(ye,{})}),e.jsx("span",{className:"delete",onClick:()=>O(f._id),children:e.jsx(xe,{})})]})}});c(y)}},[i]);const x=(s,y)=>{a({...v,[y]:s.target.value})},g=s=>{s.preventDefault(),js({inp:v,setisload:o,setInp:a,setopenmodal:r,init:I,dispatch:T})},$=s=>{console.log("edit",s),j(!0),a({branchId:s.branchId._id,departmentId:s._id,department:s.department,description:s.description}),r(!0)},O=s=>{console.log("delete",s),_e({title:"Are you sure?",text:"Once deleted, All empoyee of this department deleted",icon:"warning",buttons:!0,dangerMode:!0}).then(async y=>{y&&ws({departmentId:s,setisload:o,dispatch:T})})},W=()=>{vs({inp:v,setisload:o,setInp:a,setopenmodal:r,init:I,dispatch:T})};return e.jsxs("div",{className:"department pt-3",children:[e.jsxs("div",{className:"head flex flex-wrap gap-1",children:[e.jsxs("div",{className:"flex gap-2 w-full justify-around md:w-auto",children:[e.jsxs(ee,{className:"w-[48%] md:w-[150px]",size:"small",children:[e.jsx(se,{id:"demo-simple-select-helper-label",children:"Branch"}),e.jsxs(Q,{value:p.branch,onChange:s=>A({...p,branch:s.target.value}),input:e.jsx(ie,{startAdornment:e.jsx(Fe,{position:"start",children:e.jsx(Ge,{fontSize:"small"})}),label:"branch"}),children:[e.jsx(q,{selected:!0,value:"all",children:"All"}),h==null?void 0:h.map(s=>e.jsx(q,{value:s._id,children:s.name},s._id))]})]}),e.jsx(C,{size:"small",id:"outlined-basic",value:p.department,onChange:s=>A({...p,department:s.target.value}),variant:"outlined",label:"Search Department"})]}),e.jsx(D,{className:"w-full md:w-auto",variant:"contained",onClick:()=>r(!0),children:"Add Department"})]}),e.jsx("div",{className:"list",children:e.jsx(Ie,{customStyles:Ee(),columns:bs,data:k?P:n,pagination:!0,highlightOnHover:!0})}),e.jsx(de,{open:t,onClose:()=>r(!1),children:e.jsx("div",{className:"membermodal w-[650px]",children:e.jsxs("div",{className:"whole",children:[e.jsx("div",{className:"modalhead",children:"Add Department"}),e.jsx("form",{onSubmit:g,children:e.jsx("span",{className:"modalcontent ",children:e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsxs(ee,{sx:{width:"98%"},size:"small",children:[e.jsx(se,{id:"demo-simple-select-helper-label",children:"Branch"}),e.jsx(Q,{value:v.branchId,label:"branch",onChange:s=>x(s,"branchId"),children:h==null?void 0:h.map(s=>e.jsx(q,{value:s._id,children:s.name},s._id))})]}),e.jsx(C,{sx:{width:"98%"},required:!0,value:v.department,onChange:s=>x(s,"department"),label:"Department",size:"small"}),e.jsx(C,{multiline:!0,rows:4,onChange:s=>x(s,"description"),value:v.description,sx:{width:"98%"},label:"Description",size:"small"})]})})}),e.jsxs("div",{className:"modalfooter",children:[e.jsx(D,{size:"small",onClick:()=>{r(!1),j(!1),a(I)},variant:"outlined",children:" cancel"}),!m&&e.jsx(D,{sx:{mr:2},loading:d,loadingPosition:"end",endIcon:e.jsx(je,{}),onClick:g,variant:"contained",type:"submit",children:"Add"}),m&&e.jsx(D,{sx:{mr:2},loading:d,loadingPosition:"end",endIcon:e.jsx(je,{}),variant:"contained",onClick:W,children:"Update"})]})]})})})]})},ae={1:"Read",2:"Create",3:"Update",4:"Delete"},Ne=["branch","department","employee","attandence","ledger","ledger_entry","holiday","leave","notification","salary"],fe={branch:[1,2,3,4],department:[1,2,3,4],employee:[1,2,3,4],attandence:[1,2,3,4],ledger:[1,2,3,4],ledger_entry:[1,2,3,4],holiday:[1,2,3,4],leave:[1,3,4],notification:[1,2,3,4],salary:[1,2,3]},Cs={department:[1,2,3],employee:[1,2,3],attandence:[1,2,3],ledger:[1,2,3,4],ledger_entry:[1,2,3,4],holiday:[1,2],leave:[1,3],notification:[1,2],salary:[1]};function ks(){const[t,r]=b.useState([]),[d,o]=b.useState([]),[n,c]=b.useState({name:"",email:"",password:"",role:"admin",profileImage:null,profilePreview:"",permissions:{...fe}}),m=me();b.useEffect(()=>{s()},[]);const j=b.useRef(null),{handleImage:P}=$e(),[w,h]=b.useState(null),[i,p]=b.useState(!1),[A,k]=b.useState(""),[T,I]=b.useState(!1),[v,a]=b.useState(null),x=l=>{a(u=>u===l?null:l)},g=()=>{c({name:"",email:"",password:"",role:"admin",profileImage:null,profilePreview:"",permissions:{...fe}}),k(""),h(null),p(!1)},[$,O]=b.useState({userid:"",pass:""}),W=async()=>{const l={...n},u=new FormData;o(!0);try{const S=l.profileImage?await P(240,l.profileImage):null;S&&u.append("photo",S),u.append("name",l.name),u.append("email",l.email),u.append("role",l.role),u.append("password",l.password),u.append("permissions",JSON.stringify(l.permissions));const z=localStorage.getItem("emstoken");o(!0);const _=w!==null?`/api/editAdmin/${t[w]._id}`:"/api/addAdmin",K=await F["post"](_,u,{headers:{Authorization:`Bearer ${z}`,"Content-Type":"multipart/form-data"}});M.success(K.data.message,{autoClose:1200}),g(),s(),m(U())}catch(S){console.error(S),S.response?M.warn(S.response.data.message,{autoClose:1200}):M.error("Something went wrong",{autoClose:1200})}finally{o(!1)}},s=async()=>{try{const l=localStorage.getItem("emstoken");o(!0);const u=await F.get("/api/getAdmin",{headers:{Authorization:`Bearer ${l}`}});r(u.data)}catch(l){console.error(l),l.response?M.warn(l.response.data.message,{autoClose:1200}):M.error("Something went wrong",{autoClose:1200})}finally{o(!1)}},y=l=>{const u=t[l];console.log(u),c({...u,profilePreview:u.profileImage||"",profileImage:null}),h(l),p(!0)},f=async l=>{l.preventDefault();try{const u=localStorage.getItem("emstoken"),S=await F.post("/api/updatepassword",{pass:$},{headers:{Authorization:`Bearer ${u}`}});O({userid:"",pass:""}),I(!1),M.success(S.data.message,{autoClose:1200})}catch(u){console.log(u),u.response?M.warn(u.response.data.message,{autoClose:1200}):u.request?console.error("No response from server:",u.request):console.error("Error:",u.message)}},N=async l=>{swal({title:"Are you sure to Delete?",icon:"warning",buttons:!0,dangerMode:!0}).then(async u=>{var S,z;if(u){let _;try{const H=localStorage.getItem("emstoken");o(!0),_=M.loading("Deleting...");const K=await F.delete(`/api/deleteAdmin/${l}`,{headers:{Authorization:`Bearer ${H}`}});M.update(_,{render:K.data.message,type:"success",isLoading:!1,autoClose:1800}),s(),m(U())}catch(H){console.error(H),M.update(_,{render:((z=(S=H.response)==null?void 0:S.data)==null?void 0:z.message)||"Error",type:"warning",isLoading:!1,autoClose:2500})}finally{o(!1)}}})},E=(l,u)=>{c(S=>{const z=S.permissions[l]||[],H=z.includes(u)?z.filter(K=>K!==u):[...z,u].sort();return{...S,permissions:{...S.permissions,[l]:H}}})},L=l=>{const u=l==="admin"?{...fe}:{...Cs};c({...n,role:l,permissions:u})},R=l=>{const u=l.target.files[0];u&&c(S=>({...S,profileImage:u,profilePreview:URL.createObjectURL(u)}))},B=()=>{A&&(c(l=>({...l,permissions:{...l.permissions,[A]:[]}})),k(""))},G=Array.from(new Set([...n.role==="admin"?Ne:Object.keys(n.permissions),...Object.keys(n.permissions)])),he=Ne.filter(l=>!G.includes(l));return e.jsxs("div",{className:"p-1 w-full",children:[e.jsxs("div",{className:" shadow-md rounded-lg",children:[e.jsx("div",{className:"flex justify-between flex-wrap items-center mb-4",children:e.jsx(D,{variant:"contained",className:"mr-2 w-full md:w-fit",onClick:()=>{g(),p(!0)},children:"Add Admin/ Manager"})}),t.length===0?e.jsx("p",{className:"text-gray-500",children:"No admins added yet."}):e.jsx("div",{className:"space-y-3",children:t.map((l,u)=>e.jsxs("div",{className:"flex flex-col justify-between items-start border border-dashed p-2 rounded-md overflow-x-auto ",children:[e.jsxs("div",{className:"flex justify-between w-full  items-center  gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(oe,{sx:{width:60,height:60},alt:l.name,src:l==null?void 0:l.profileImage}),e.jsxs("div",{children:[e.jsxs("p",{className:" capitalize text-[14px] md:text-[18px] font-medium",children:[l.name," (",l.role,")"]}),e.jsx("p",{className:"text-[12px] md:text-sm text-gray-500",children:l.email})]})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{title:"Edit",className:"p-2 border rounded hover:bg-gray-100",onClick:()=>y(u),children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{title:"Password Reset",className:"p-2 border rounded hover:bg-gray-100 text-green-500",onClick:()=>{O({...$,userid:l._id}),I(!0)},children:e.jsx(Ue,{className:"h-4 w-4 "})}),e.jsx("button",{title:"Delete",className:"p-2 border rounded text-red-600 hover:bg-red-50",onClick:()=>N(l._id),children:e.jsx(He,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex mt-2 justify-between items-center cursor-pointer bg-teal-100 px-4 py-1 rounded-md",onClick:()=>x(u),children:[e.jsxs("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:[" ",v===u?"Hide Permissions":"View Permissions "]}),v===u?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),v===u&&e.jsxs("div",{className:"text-sm w-full  mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Permissions:"}),e.jsxs("table",{className:"table-auto border-collapse border border-gray-300 mt-2 text-xs w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"Module"}),Object.values(ae).map(S=>e.jsx("th",{className:"border border-gray-300 px-2 py-1",children:S},S))]})}),e.jsx("tbody",{children:Object.entries(l.permissions).map(([S,z])=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1 font-semibold",children:S}),Object.keys(ae).map(_=>e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-center",children:z.includes(Number(_))?"✅":"-"},_))]},S))})]})]})]})]},u))})]}),e.jsx(de,{open:i,onClose:()=>p(!1),children:e.jsx("div",{className:"membermodal w-[660px]",children:e.jsxs("form",{onSubmit:W,children:[e.jsxs("div",{className:"modalhead",children:[" ",w!==null?"Edit Admin":"Add Admin"]}),e.jsx("span",{className:"modalcontent",children:e.jsxs("div",{className:"space-y-3 pt-1 flex items-center gap-4 flex-col w-[100%] md:w-full",children:[e.jsxs("div",{className:"mt-1 items-center  w-fit relative",children:[e.jsx("input",{style:{display:"none"},type:"file",onChange:R,ref:j,accept:"image/*",name:"",id:"fileInput"}),e.jsx(oe,{sx:{width:70,height:70},alt:n.name,src:n.profilePreview}),e.jsx("span",{onClick:()=>j.current.click(),className:"absolute -bottom-1 -right-1 rounded-full bg-teal-900 text-white p-1",children:e.jsx(ye,{size:18})})]}),e.jsx(C,{fullWidth:!0,required:!0,value:n.name,onChange:l=>c({...n,name:l.target.value}),label:"Name",size:"small"}),e.jsx(C,{fullWidth:!0,required:!0,value:n.email,onChange:l=>c({...n,email:l.target.value}),label:"Email",size:"small",helperText:"*Note - you can also use companyname as mail handler, e.g. xyz@companyname.com"}),w==null&&e.jsxs(e.Fragment,{children:[e.jsx(C,{fullWidth:!0,required:!0,value:n.password,type:"password",onChange:l=>c({...n,password:l.target.value}),label:"Password",size:"small"}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"font-semibold block mb-1",children:"Role"}),e.jsxs("select",{className:"w-full border p-2 rounded",value:n.role,onChange:l=>L(l.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"})]})]})]}),n.role==="manager"&&e.jsxs("div",{className:"flex w-full flex-wrap items-center gap-2",children:[e.jsxs("select",{className:"border p-2 flex-3 rounded ",value:A,onChange:l=>k(l.target.value),children:[e.jsx("option",{value:"",children:"-- Select Module to Add --"}),he.map(l=>e.jsx("option",{value:l,children:l},l))]}),e.jsx(D,{variant:"contained",onClick:B,className:"flex-1",children:"Add Module"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Permissions"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2 text-left",children:"Module"}),Object.entries(ae).map(([l,u])=>e.jsx("th",{className:"border p-2 text-center",children:u},l))]})}),e.jsx("tbody",{children:G.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2 capitalize",children:l}),Object.keys(ae).map(u=>{var S;return e.jsx("td",{className:"border text-center",children:e.jsx("input",{className:` h-3 w-3 md:h-5 md:w-5 cursor-pointer rounded-md border-2 border-gray-400 \r
                                                                       focus:ring-2 focus:ring-red-400 focus:outline-none \r
                                                                       transition duration-200 ease-in-out`,type:"checkbox",checked:((S=n.permissions[l])==null?void 0:S.includes(Number(u)))||!1,onChange:()=>E(l,Number(u))})},u)})]},l))})]})})]})]})}),e.jsxs("div",{className:"modalfooter",children:[e.jsx(D,{variant:"outlined",onClick:g,children:"Cancel"}),e.jsx(D,{variant:"contained",onClick:W,loading:d,children:w!==null?"Update":"Create"})]})]})})}),e.jsx(de,{open:T,onClose:()=>{I(!1)},children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:f,children:[e.jsx("h2",{children:"Reset Passowrd"}),e.jsxs("span",{className:"modalcontent ",children:[e.jsx(C,{fullWidth:!0,inputProps:{minLength:3,maxLength:10},required:!0,value:$.pass,onChange:l=>O({...$,pass:l.target.value}),label:"Passowrd",size:"small"}),e.jsx(D,{variant:"contained",sx:{mr:2},type:"submit",children:"Reset Password"})]})]})})})]})}const Ce=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}];function zs(){const[t,r]=b.useState(null),[d,o]=b.useState(!1),[n,c]=b.useState(!1),[m,j]=b.useState(!1),{handleImage:P}=$e(),[w,h]=b.useState(null),[i,p]=b.useState({name:"",address:"",contact:"",fullname:"",officeTime:{in:"10:00",out:"18:00",breakMinutes:30},gracePeriod:{lateEntryMinutes:10,earlyExitMinutes:10},workingMinutes:{fullDay:480,halfDay:240,shortDayThreshold:360,overtimeAfterMinutes:490},weeklyOffs:[0],attendanceRules:{considerEarlyEntryBefore:"09:50",considerLateEntryAfter:"10:10",considerEarlyExitBefore:"17:50",considerLateExitAfter:"18:15"},payrollPolicies:{allowances:[],bonuses:[],deductions:[]}}),A=me(),{employee:k,company:T,branch:I,profile:v}=ge(s=>s.user),a=s=>{r(y=>y===s?null:s)};b.useEffect(()=>{T&&p(T)},[T]);const x=(s,y,f)=>{p(N=>({...N,[s]:{...N[s],[y]:f}}))},g=async()=>{try{j(!0);const s=localStorage.getItem("emstoken"),y=await F.post("/api/updateCompany",{...i},{headers:{Authorization:`Bearer ${s}`}});A(U()),M.success(y.data.message,{autoClose:1800})}catch(s){console.log(s),s.response?M.warn(s.response.data.message,{autoClose:2700}):s.request?console.error("No response from server:",s.request):console.error("Error:",s.message)}finally{j(!1)}},$=()=>{},O=s=>{var f;o(!0);const y={...s,managerIds:(f=s==null?void 0:s.managerIds)==null?void 0:f.map(N=>N._id)};h(y),c(!0)},W=Ee();return e.jsxs("div",{className:"w-full mx-auto mt-1 p-1 py-2 md:p-6 bg-white rounded-xl shadow-md space-y-3 md:space-y-6",children:[(v==null?void 0:v.role)=="superadmin"&&e.jsxs("div",{className:" shadow-lg border bg-blue-50 border-dashed border-blue-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer  bg-blue-200 px-4 py-2 rounded-md",onClick:()=>a("company"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:"Company Info"}),t==="company"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsx("div",{className:` 
                          rounded overflow-hidden transition-all duration-300 
                          ${t==="company"?"max-h-fit p-0 md:p-2 my-2":"max-h-0 p-0 my-0"}
                        `,children:e.jsxs("div",{className:"p-1 md:p-4 rounded  flex flex-col md:flex-row items-center  mt-2 space-y-4",children:[e.jsx("div",{className:"relative flex items-center mx-auto",children:e.jsxs("div",{className:"relative w-30 h-30 mx-auto",children:[i!=null&&i.logo?e.jsx("img",{src:Ve(i.logo,{format:"webp",width:200,height:200})||employepic,alt:"Company Logo",className:"w-full h-full object-fill rounded-full border-2 border-dashed border-blue-300"}):e.jsx(Je,{className:"w-full h-full text-blue-400 rounded-full border-2 border-dashed border-blue-300"}),e.jsx("input",{type:"file",id:"logo-upload",accept:"image/*",onChange:async s=>{const y=s.target.files[0];if(!y)return;const f=await P(300,y),N=new FormData;N.append("_id",i._id),N.append("logo",f);try{j(!0);const E=localStorage.getItem("emstoken"),R=(await F.post("/api/updateCompany",N,{headers:{Authorization:`Bearer ${E}`,"Content-Type":"multipart/form-data"}})).data.logoUrl;p(B=>({...B,logo:R})),M.success("Logo uploaded successfully!")}catch(E){console.error(E),M.error("Failed to upload logo.")}finally{j(!1)}},className:"hidden"}),e.jsx("label",{htmlFor:"logo-upload",className:"absolute w-8 h-8 text-center bottom-0 right-0 bg-white border border-gray-300 rounded-full p-1 cursor-pointer shadow-md",children:"✎"})]})}),e.jsxs("div",{className:"w-full md:w-[70%] flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("div",{className:"w-full md:flex-1",children:e.jsx(C,{label:"Company Name",size:"small",variant:"standard",fullWidth:!0,value:(i==null?void 0:i.name)||"",onChange:s=>p({...i,name:s.target.value})})}),e.jsx("div",{className:"w-full md:flex-1",children:e.jsx(C,{label:"Contact",type:"tel",variant:"standard",size:"small",fullWidth:!0,value:(i==null?void 0:i.contact)||"",inputProps:{maxLength:10,inputMode:"numeric",pattern:"[0-9]*"},onChange:s=>p({...i,contact:s.target.value.replace(/\D/g,"")})})})]}),e.jsx("div",{children:e.jsx(C,{label:"Company Full Name",variant:"standard",fullWidth:!0,size:"small",value:(i==null?void 0:i.fullname)||"",onChange:s=>p({...i,fullname:s.target.value})})}),e.jsx("div",{children:e.jsx(C,{label:"Address",fullWidth:!0,multiline:!0,size:"small",minRows:2,value:(i==null?void 0:i.address)||"",onChange:s=>p({...i,address:s.target.value})})}),T?e.jsx(D,{variant:"contained",loading:m,onClick:g,children:"Save Changes"}):e.jsx(D,{loading:m,variant:"contained",onClick:()=>ys({companyinp:i,setisload:j}),children:"+ Create Company"})]})]})})]}),((v==null?void 0:v.role)=="superadmin"||(v==null?void 0:v.role)=="admin")&&e.jsxs("div",{className:"border shadow-lg bg-green-50 border-dashed border-green-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer bg-green-200 px-4 py-2 rounded-md",onClick:()=>a("branches"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:"Branches"}),t==="branches"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsxs("div",{className:`
                          rounded space-y-1 overflow-hidden transition-all duration-300
                          ${t==="branches"?"max-h-fit p-1 md:p-2 my-2":"max-h-0 p-0 my-0"}
                        `,children:[e.jsx("div",{className:"flex justify-end items-center",children:e.jsx(D,{variant:"contained",onClick:()=>c(!0),children:"+ Add Branch"})}),e.jsx(Ie,{customStyles:W,columns:[{name:"Name",selector:s=>s.name,sortable:!0},{name:"Location",selector:s=>s.location,sortable:!0},{name:"Manager(s)",cell:s=>{var y;return e.jsx("div",{className:"flex flex-col gap-2",children:(y=s==null?void 0:s.managerIds)==null?void 0:y.map((f,N)=>e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>$(f.userid),children:[e.jsx(oe,{src:f==null?void 0:f.profileImage,alt:f.name,children:!(f!=null&&f.profileImage)&&e.jsx(Ae,{})}),e.jsx("span",{children:f.name})]},N))})}},{name:"Actions",width:"120px",cell:s=>e.jsxs("div",{className:"action flex gap-2.5",children:[e.jsx("span",{className:"edit text-[18px] text-blue-500 cursor-pointer",title:"Edit",onClick:()=>O(s),children:e.jsx(ye,{})}),e.jsx("span",{className:"delete text-[18px] text-red-500 cursor-pointer",onClick:()=>O(s),children:e.jsx(xe,{})})]})}],data:I||[],pagination:!0,highlightOnHover:!0,noDataComponent:"No branches found"})]})]}),e.jsxs("div",{className:"border shadow-lg bg-teal-50 border-dashed border-teal-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer bg-teal-200 px-4 py-2 rounded-md",onClick:()=>a("department"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:"Department"}),t==="department"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsx("div",{className:`
                          rounded overflow-hidden transition-all duration-300
                          ${t==="department"?"max-h-fit p-2 my-2":"max-h-0 p-0 my-0"}
                        `,children:e.jsx(Ns,{})})]}),(v==null?void 0:v.role)=="superadmin"&&e.jsxs("div",{className:"border shadow-lg bg-slate-50 border-dashed border-slate-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer bg-slate-200 px-4 py-2 rounded-md",onClick:()=>a("admin"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:"Admin/Manager"}),t==="admin"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsx("div",{className:`
                          rounded overflow-hidden transition-all duration-300 
                          ${t==="admin"?"max-h-fit md:p-2 p-1 my-2":"max-h-0 p-0 my-0"}
                        `,children:e.jsx(ks,{})})]}),e.jsxs("div",{className:"border shadow-lg bg-yellow-50 border-dashed border-yellow-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer bg-yellow-200 px-4 py-2 rounded-md",onClick:()=>a("attendance"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:" Attendance Rules"}),t==="attendance"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsxs("div",{className:`
                          rounded overflow-hidden transition-all duration-300 
                          ${t==="attendance"?"max-h-fit p-2 my-2":"max-h-0 p-0 my-0"}
                        `,children:[e.jsxs(re,{className:"mt-1 p-2 grid grid-cols-1 md:grid-cols-3 gap-5",children:[e.jsx(C,{label:"Office Time In",fullWidth:!0,type:"time",value:i.officeTime.in,onChange:s=>x("officeTime","in",s.target.value),helperText:"Time when office hours begin"}),e.jsx(C,{label:"Office Time Out",fullWidth:!0,type:"time",value:i.officeTime.out,onChange:s=>x("officeTime","out",s.target.value),helperText:"Time when office hours end"}),e.jsx(C,{label:"Break Minutes",fullWidth:!0,type:"number",value:i.officeTime.breakMinutes,onChange:s=>x("officeTime","breakMinutes",Number(s.target.value)),helperText:"Total break time allowed during the day"}),e.jsx(C,{label:"Full Day Minutes",fullWidth:!0,type:"number",value:i.workingMinutes.fullDay,onChange:s=>x("workingMinutes","fullDay",Number(s.target.value)),helperText:"Total working minutes required for a full day"}),e.jsx(C,{label:"Half Day Minutes",fullWidth:!0,type:"number",value:i.workingMinutes.halfDay,onChange:s=>x("workingMinutes","halfDay",Number(s.target.value)),helperText:"Minimum minutes required for marking a half-day"}),e.jsx(C,{label:"Short Day Threshold (min)",fullWidth:!0,type:"number",value:i.workingMinutes.shortDayThreshold,onChange:s=>x("workingMinutes","shortDayThreshold",Number(s.target.value)),helperText:"Below this time is considered a short day"}),e.jsx(C,{label:"Overtime After Minutes",fullWidth:!0,type:"number",value:i.workingMinutes.overtimeAfterMinutes,onChange:s=>x("workingMinutes","overtimeAfterMinutes",Number(s.target.value)),helperText:"Time after which overtime calculation begins"}),e.jsxs(ee,{fullWidth:!0,children:[e.jsx(se,{children:"Weekly Offs"}),e.jsx(Q,{multiple:!0,value:i.weeklyOffs,onChange:s=>p({...i,weeklyOffs:s.target.value}),input:e.jsx(ie,{label:"Weekly Offs"}),renderValue:s=>s.map(y=>{var f;return(f=Ce.find(N=>N.value===y))==null?void 0:f.label}).join(", "),children:Ce.map(s=>e.jsxs(q,{value:s.value,children:[e.jsx(ne,{checked:i.weeklyOffs.includes(s.value)}),e.jsx(le,{primary:s.label})]},s.value))})]}),Object.entries(i.attendanceRules).map(([s,y])=>{const f=s.replace(/([A-Z])/g," $1").replace(/^./,E=>E.toUpperCase()),N={considerEarlyEntryBefore:"Considered early if punched before this time",considerLateEntryAfter:"Considered late if punched after this time",considerEarlyExitBefore:"Considered early exit if leaving before this time",considerLateExitAfter:"Considered late exit if leaving after this time"};return e.jsx(C,{fullWidth:!0,label:f,type:"time",value:y,onChange:E=>x("attendanceRules",s,E.target.value),helperText:N[s]},s)})]}),e.jsx(re,{sx:{mt:4,textAlign:"right"},children:e.jsx(D,{variant:"contained",onClick:g,children:"Update Settings"})})]})]}),e.jsxs("div",{className:"border shadow-lg bg-purple-50 border-dashed border-purple-400 rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer bg-purple-200 px-4 py-2 rounded-md",onClick:()=>a("policies"),children:[e.jsx("span",{className:"font-semibold text-[16px] md:text-lg text-left",children:"Default Payroll Policies"}),t==="policies"?e.jsx(V,{className:"text-xl"}):e.jsx(Z,{className:"text-xl"})]}),e.jsxs("div",{className:`rounded overflow-hidden transition-all duration-300 
                     ${t==="policies"?"max-h-fit p-2 my-2":"max-h-0 p-0 my-0"}`,children:[e.jsx("div",{className:"flex flex-col gap-3",children:["allowances","bonuses","deductions"].map(s=>{var f;const y=((f=i==null?void 0:i.payrollPolicies)==null?void 0:f[s])||[];return e.jsxs(ps,{item:!0,xs:12,md:4,children:[e.jsx(Y,{variant:"h6",className:"capitalize",children:s}),y.map((N,E)=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{label:"Name",size:"small",value:N.name,onChange:L=>{const R=y.map((B,G)=>G===E?{...B,name:L.target.value}:B);p({...i,payrollPolicies:{...i.payrollPolicies,[s]:R}})}}),e.jsxs(Q,{size:"small",className:"w-[120px]",value:N.type,onChange:L=>{const R=y.map((B,G)=>G===E?{...B,type:L.target.value}:B);p({...i,payrollPolicies:{...i.payrollPolicies,[s]:R}})},children:[e.jsx(q,{value:"amount",children:"Amount"}),e.jsx(q,{value:"percentage",children:"%"})]}),e.jsx(C,{label:N.type==="amount"?"₹":"%",type:"number",size:"small",value:N.value,onChange:L=>{const R=y.map((B,G)=>G===E?{...B,value:Number(L.target.value)}:B);p({...i,payrollPolicies:{...i.payrollPolicies,[s]:R}})}}),e.jsx(xe,{className:"text-red-500 cursor-pointer text-lg",onClick:()=>{const L=y.filter((R,B)=>B!==E);p({...i,payrollPolicies:{...i.payrollPolicies,[s]:L}})}})]},E)),e.jsxs(D,{size:"small",variant:"outlined",onClick:()=>p({...i,payrollPolicies:{...i.payrollPolicies,[s]:[...y,{name:"",type:"amount",value:0}]}}),children:["+ Add ",s.slice(0,-1)]})]},s)})}),e.jsx(re,{sx:{mt:2,textAlign:"right"},children:e.jsx(D,{variant:"contained",onClick:g,children:"Save Policies"})})]})]}),e.jsx(de,{open:n,onClose:()=>{c(!1),h(null),o(!1)},children:e.jsx("div",{className:"membermodal w-[680px]",children:e.jsx(gs,{setopenviewmodal:c,editbranchdata:w,editbranch:d,company:T,employee:k})})})]})}export{zs as default};
